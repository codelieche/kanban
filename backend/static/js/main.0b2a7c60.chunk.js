(this.webpackJsonpkanban=this.webpackJsonpkanban||[]).push([[0],{313:function(e,t,a){e.exports=a(849)},847:function(e,t,a){},848:function(e,t,a){},849:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(11),l=a.n(r),i=a(5),o=a(89),s=c.a.createContext({}),u=c.a.createContext({}),m=(c.a.createRef({}),u),d=(a(121),a(44)),f=a(2),p=a(80),b=a(29),E=a(32),h=a(35),g=a(33),v=a(36),O=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={type:a.props.type,spin:a.props.spin,danger:a.props.danger,noMarginRight:a.props.noMarginRight},a}return Object(v.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e="fa fa-".concat(this.state.type);return this.state.spin&&(e+=" fa-spin"),this.state.danger&&(e+=" danger"),c.a.createElement("span",{style:{marginRight:this.state.noMarginRight?0:5,display:"inline-block"}},c.a.createElement("i",{className:e},this.props.children))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.type!==t.type||e.spin!==t.spin||e.danger!==t.danger||e.noMarginRight!==t.noMarginRight?{type:e.type,spin:e.spin,danger:e.danger,noMarginRight:e.noMarginRight}:null}}]),t}(c.a.Component),j=(a(224),a(281)),y=a(61),k=a(279),N=a.n(k),C=a(280),S=a.n(C),x="http://127.0.0.1:9000",w=2e4,I=N.a.create({baseURL:x,timeout:w});I.defaults.headers.common["Content-Type"]="application/json",I.defaults.withCredentials=!0,I.interceptors.request.use((function(e){return"post"!==e.method&&"put"!==e.method&&"patch"!==e.method||!e.data instanceof String&&(e.data=S.a.stringify(e.data)),e}),(function(e){return Promise.reject(e)})),I.interceptors.response.use((function(e){if("delete"===e.config.method)return Promise.resolve(e);var t=e.data;return Promise.resolve(t)}),(function(e){if(/timeout/.test(e.message)&&console.log("\u7f51\u7edc\u8d85\u65f6\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"),e.response)switch(e.response.status){case 401:var t="/user/login?next="+window.location.href,a=window.location.origin+t;window.location.href=a;break;case 403:case 404:break;case 500:console.log("\u670d\u52a1\u5668\u9519\u8bef\uff01");break;case 503:console.log("\u670d\u52a1\u5668\u54cd\u5e94\u4e0d\u8fc7\u6765\uff01");break;default:console.log("\u9ed8\u8ba4\u9519\u8bef\u63d0\u793a")}return Promise.reject(e.response)}));var P=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I.post(e,t,a)};var M={Get:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I.get(e,Object(y.a)({},a,{params:t}))},Post:P,Put:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I.put(e,t,a)},Patch:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I.patch(e,t,a)},Delete:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I.delete(e,Object(y.a)({},a,{params:t}))},testFetch:function(){P("/api/v1/account/login",{},{data:{username:"admin",password:"abc123456"},headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},D=function e(t){var a,r,l,o=t.item,s=t.index,u=t.collapsed,m=t.defaultOpenKey,d=Object(n.useState)(!1),p=Object(f.a)(d,2),b=p[0],E=p[1],h=o.children.map((function(t,a){return c.a.createElement(e,{item:t,index:a,key:a,collapsed:u})})),g=Object(n.useCallback)((function(e){E((function(e){return!e}))}),[]);return Object(n.useEffect)((function(){u||(m===o.key?E(!0):E(!1))}),[u,m,o.key]),o.icon&&(a=c.a.createElement(O,{type:o.icon})),h.length>0&&(r=c.a.createElement("div",{className:"right"},c.a.createElement(O,{type:b?"caret-down":"caret-left"}))),u?h.length>0?c.a.createElement(j.a,{title:o.title,content:c.a.createElement("div",{className:"collapsed-nav-children"},h),placement:"rightTop"},c.a.createElement("div",{className:"item"},c.a.createElement("div",{className:"title"},c.a.createElement(O,{type:o.icon?o.icon:"angle-right"}),o.level<=1?null:o.title))):o.is_link&&o.link?c.a.createElement("div",{className:"item"},c.a.createElement("a",{href:o.link,target:"_blank"===o.target?"_blank":"",rel:"noopener noreferrer"},c.a.createElement("div",{className:"title"},c.a.createElement(O,{type:o.icon?o.icon:"angle-right"}),o.title?o.title:"\u65e0\u6807\u9898"))):c.a.createElement("div",{className:"item"},c.a.createElement(i.c,{to:o.slug,activeClassName:"active",target:"_blank"===o.target?"_blank":""},c.a.createElement("div",{className:"title"},c.a.createElement(O,{type:o.icon?o.icon:"angle-right"}),o.title?o.title:"\u65e0\u6807\u9898"))):(l=h.length>0?c.a.createElement("div",null,c.a.createElement("div",{className:"title",style:{paddingLeft:12*o.level},onClick:g},a,o.title?o.title:"\u65e0\u6807\u9898",r)):o.is_link&&o.link?c.a.createElement("a",{href:o.link,target:o.target,rel:"noopener noreferrer"},c.a.createElement("div",{className:"title",style:{paddingLeft:12*o.level}},a,o.title?o.title:"\u65e0\u6807\u9898",r)):c.a.createElement(i.c,{to:o.slug,activeClassName:"active",target:"_blank"===o.target?"_blank":""},c.a.createElement("div",{className:"title",style:{paddingLeft:12*o.level},onClick:g},a,o.title?o.title:"\u65e0\u6807\u9898",r)),c.a.createElement("div",{className:"item",key:s},l,u?"\u6298\u53e0":"",h.length>0&&c.a.createElement("div",{className:b?"children active":"children"},h)))},_=function(e){var t=Object(n.useState)([]),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(!1),o=Object(f.a)(i,2),s=o[0],u=o[1];Object(n.useEffect)((function(){0===r.length&&M.Get("/api/v1/account/user/nav/list").then((function(e){e instanceof Array?l(e):console.log("\u83b7\u53d6\u5bfc\u822a\u6570\u636e\u51fa\u9519")})).catch((function(e){console.log(e)})),e.collapsed!==s&&u(e.collapsed)}),[s,r.length,e.collapsed]);var m=r.map((function(t,a){return c.a.createElement(D,{item:t,index:a,key:a,collapsed:s,defaultOpenKey:e.defaultOpenKey})}));return c.a.createElement("div",{className:"nav-list"},m)};var U=function(e){var t=e.showLeftSider,a=e.setShowLeftSider,r=e.defaultOpenKey,l=Object(n.useState)(null),o=Object(f.a)(l,2),s=o[0],u=o[1],m=Object(n.useMemo)((function(){var e=localStorage.getItem("leftSiderWidth"),t=parseInt(e);return t&&t>=156&&t<=460?t:200}),[]),b=Object(n.useState)(m),E=Object(f.a)(b,2),h=E[0],g=E[1];Object(n.useEffect)((function(){return function(){localStorage.setItem("leftSiderWidth",h)}}),[h]);var v=Object(n.useCallback)((function(e,t){t.element;var a=t.size;a.width<156?g(156):a.width<=460?g(a.width):g(460)}),[g]),j=Object(n.useCallback)((function(e){e.preventDefault(),a((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[a]),y=Object(n.useMemo)((function(){return t?c.a.createElement(_,{collapsed:s,defaultOpenKey:r}):null}),[t,s,r]),k=Object(n.useCallback)((function(){u((function(e){return!e}))}),[u]);return Object(n.useEffect)((function(){if(null===s){var e=localStorage.getItem("leftSiderNavCollapsed");u(null!==e&&"true"===e)}return localStorage.setItem("leftSiderNavCollapsed",s),function(){localStorage.setItem("leftSiderNavCollapsed",s)}}),[s]),c.a.createElement(p.Resizable,{className:"box",axis:"x",height:0,width:h,onResize:v},c.a.createElement(d.a.Sider,{style:{height:"100vh"},width:s?64:h},c.a.createElement("div",{className:s?"left-sider collapsed":"left-sider"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"logo"},c.a.createElement(i.b,{to:"/"},c.a.createElement("img",{alt:"logo",src:"http://127.0.0.1:9000/static/image/logo-kanban.svg"})),c.a.createElement("div",{className:"toogle",onClick:j,style:{display:s?"none":""}},c.a.createElement(O,{type:"angle-double-left",noMarginRight:!0})),c.a.createElement("div",{className:"clear"})),c.a.createElement("div",{className:"clear"})),c.a.createElement("div",{className:"content"},y),c.a.createElement("div",{className:"footer",onClick:k},c.a.createElement("div",{className:"collapsed-toogle"},c.a.createElement(O,{type:s?"indent":"outdent"}))))))},A=(a(399),a(178));var F=function(e){var t=e.data;if(t&&t instanceof Array){var a=t.map((function(e,t){var a;return e.icon&&(a=c.a.createElement(O,{type:e.icon,noMarginRight:!0})),e.link?c.a.createElement(A.a.Item,{key:t},c.a.createElement(i.b,{to:e.link},a,e.title)):c.a.createElement(A.a.Item,{key:t},a,e.title)}));return c.a.createElement(A.a,{className:"nav"},a)}return null},R=(a(141),a(85)),z=(a(195),a(30)),L=function(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)({}),s=Object(f.a)(o,2),u=s[0],m=s[1],d=Object(n.useState)(!1),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useCallback)((function(){M.Get("/api/v1/account/login").then((function(e){E(!0),e.logined?(l(!0),m({username:e.username})):(l(!1),m({username:"\u672a\u767b\u5f55"}))})).catch((function(e){console.log(e),E(!0)}))}),[l,m]);if(Object(n.useEffect)((function(){h()}),[h]),b){if(r){var g=c.a.createElement(z.a,null,c.a.createElement(z.a.Item,null,c.a.createElement(i.b,{to:"/user/center"},c.a.createElement(O,{type:"user-circle"}," \u7528\u6237\u4e2d\u5fc3"))),c.a.createElement(z.a.Item,null,c.a.createElement(i.b,{to:"/docs/group"},c.a.createElement(O,{type:"file-text-o"}," \u6587\u6863\u5206\u7ec4"))),c.a.createElement(z.a.Item,null,c.a.createElement(i.b,{to:"/user/message"},c.a.createElement(O,{type:"envelope-o"}," \u6d88\u606f\u4e2d\u5fc3"))),c.a.createElement(z.a.Item,null,c.a.createElement(i.b,{to:"/user/logout"},c.a.createElement(O,{type:"sign-out"}," \u9000\u51fa\u767b\u5f55"))));return c.a.createElement(R.a,{overlay:g},c.a.createElement("div",null,c.a.createElement(O,{type:"user-o"}),"Hi ~ ",u.username))}return c.a.createElement(i.b,{to:"/user/login"},c.a.createElement(O,{type:"sign-in"}),"\u767b\u5f55")}return null};var T=function(e){return c.a.createElement("div",{className:"footer"},c.a.createElement("div",{className:"copyright"},"Copyright @ 2011-2020 www.codelieche.com all Rights Reserved",c.a.createElement("br",null),c.a.createElement("div",null,"\u7ca4ICP\u5907xxxxxxxx\u53f7")))},G=(a(196),a(98)),H=(a(24),a(6)),K=(a(25),a(4)),B=a(160),q=a.n(B),J=a(119),V=function(e){var t=Object(n.useState)(""),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(!1),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(c.a.createRef()),d=Object(f.a)(m,2),p=d[0],b=d[1],E=Object(n.useCallback)((function(){return e.innerRef&&"function"!==typeof e.innerRef?e.innerRef.current:p.current}),[p,e.innerRef]),h=Object(n.useCallback)((function(){try{if(s){var t=E();if(!t)return;var a=t.innerHTML,n=t.innerText;e.handleContentUpdated&&"function"===typeof e.handleContentUpdated&&(e.handleContentUpdated({html:a,text:n}),u(!1))}}catch(c){console.log(c)}}),[s,E,e]);Object(n.useEffect)((function(){e.innerRef&&"function"===typeof e.innerRef&&e.innerRef!==p&&b(e.innerRef)}),[p,e.innerRef]),Object(n.useEffect)((function(){return h}),[]);var g=Object(n.useCallback)((function(t){var a=E();if(a){var n=a.innerHTML;if(n===r||s||u(!0),e.onChange&&n!==r){var c=Object.assign({},t,{target:{value:n,text:a.innerText}});e.onChange(c)}l(n)}}),[s,E,r,e]);return Object(n.useMemo)((function(){var t=e.tagName,a=e.content,n=e.contentType,r=(e.handleContentUpdated,e.innerRef,Object(J.a)(e,["tagName","content","contentType","handleContentUpdated","innerRef"]));return n&&"text"!==n?c.a.createElement(t||"div",Object(y.a)({},r,{ref:p,onInput:g,onBlur:e.onBlur||h,onMouseLeave:e.onMouseLeave||h,onKeyUp:e.onKeyUp||g,onKeyDown:e.onKeyDown||g,contentEditable:!e.disabled,suppressContentEditableWarning:!0,dangerouslySetInnerHTML:{__html:a}})):c.a.createElement(t||"div",Object(y.a)({},r,{ref:p,onInput:g,onBlur:e.onBlur||g,onMouseLeave:e.onMouseLeave||h,onKeyUp:e.onKeyUp||g,onKeyDown:e.onKeyDown||g,contentEditable:!e.disabled,suppressContentEditableWarning:!0,style:e.style?e.style:{whiteSpace:"pre-wrap"}}),a)}),[p,g,h,e])},W=a(161),Y=a.n(W),Q=function(e,t,a){var n="/api/v1/docs/article/".concat(e);M.Patch(n,{},{data:t}).then((function(e){e.id>0?"function"===typeof a&&a(e):console.log(e)})).catch((function(a){if(console.log(a),t&&t.content){var n="article_".concat(e,"_content"),c={content:t.content,time:Y()().format("YYYY-MM-DD hh:mm:ss"),key:n};localStorage.setItem(n,JSON.stringify(c))}a&&a.status&&(403===a.status?K.a.error("\u60a8\u65e0\u6743\u9650",5):404===a.status?K.a.error("404\u9519\u8bef",5):K.a.error("\u51fa\u73b0\u9519\u8bef\uff1a".concat(a.status),5))}))},$=(a(145),a(83)),X=(a(507),a(309)),Z=a(288),ee=a(852),te={'code[class*="language-"]':{color:"#c5c8c6",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:"Inconsolata, Monaco, Consolas, 'Courier New', Courier, monospace",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{color:"#c5c8c6",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:"Inconsolata, Monaco, Consolas, 'Courier New', Courier, monospace",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:".5em 0",overflow:"auto",borderRadius:"0.3em",background:"#3f3f3f"},':not(pre) > code[class*="language-"]':{background:"#3f3f3f",padding:".1em",borderRadius:".3em"},comment:{color:"#7C7C7C"},prolog:{color:"#7C7C7C"},doctype:{color:"#7C7C7C"},cdata:{color:"#7C7C7C"},punctuation:{color:"#c5c8c6"},".namespace":{Opacity:".7"},property:{color:"#96CBFE"},keyword:{color:"#96CBFE"},tag:{color:"#96CBFE"},"class-name":{color:"#FFFFB6",textDecoration:"underline"},boolean:{color:"#99CC99"},constant:{color:"#99CC99"},symbol:{color:"#f92672"},deleted:{color:"#f92672"},number:{color:"#FF73FD"},selector:{color:"#A8FF60"},"attr-name":{color:"#A8FF60"},string:{color:"#A8FF60"},char:{color:"#A8FF60"},builtin:{color:"#A8FF60"},inserted:{color:"#A8FF60"},variable:{color:"#C6C5FE"},operator:{color:"#EDEDED"},entity:{color:"#FFFFB6",cursor:"help"},url:{color:"#96CBFE"},".language-css .token.string":{color:"#87C38A"},".style .token.string":{color:"#87C38A"},atrule:{color:"#F9EE98"},"attr-value":{color:"#F9EE98"},function:{color:"#DAD085"},regex:{color:"#E9C062"},important:{color:"#fd971f",fontWeight:"bold"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"}},ae=function(e){var t=e.value,a=e.language;return c.a.createElement(ee.a,{language:a,style:te},t)},ne=(a(28),a(12)),ce=(a(39),a(8)),re=(a(56),a(17)),le=(a(266),a(100)),ie=(a(850),a(307));var oe=function(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(null),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useCallback)((function(t){if(t.stopPropagation(),t.clipboardData||t.originalEvent){var a=t.clipboardData||t.originalEvent.clipboardData;if(a.items)for(var n=a.items,c=0;c<n.length;c++)if(n[c].type.indexOf("image")>=0){var r=n[c].getAsFile();r.uid="parse-upload-".concat(Math.round(1e9*Math.random()));var l=URL.createObjectURL(r);e.setFileListData([r]),u(l)}}}),[e]);Object(n.useEffect)((function(){return e.url===s||r||s||u(e.url),document.addEventListener("paste",m),function(){document.removeEventListener("paste",m)}}),[e.url,s,r,m,e.fileListData.length]);var d,p={name:"file",multiple:!1,onRemove:function(t){console.log(t),e.setFileListData((function(e){var a=e,n=a.indexOf(t);n>=0&&s&&!r&&u(null);var c=a.slice();return c.splice(n,1),c}))},beforeUpload:function(t){if(t.type.indexOf("image")<0)return K.a.warn("\u8bf7\u9009\u62e9\u56fe\u7247\u6587\u4ef6"),!1;e.setFileListData([t]);var a=URL.createObjectURL(t);return l(!0),u(a),!1},fileList:e.fileListData};return s&&(d=c.a.createElement("img",{style:{maxWidth:"100%",height:"auto"},src:s,alt:"\u56fe\u7247"})),c.a.createElement(ie.a.Dragger,p,c.a.createElement("div",{className:"ant-upload-hint"},d,e.tooltip?e.tooltip:c.a.createElement("div",null,"\u8bf7\u9009\u62e9\u4e00\u5f20\u8981\u4e0a\u4f20\u7684\u56fe\u7247")))},se=function(e){var t=Object(n.useState)("uploadImage"),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)([]),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(null),d=Object(f.a)(m,2),p=d[0],b=d[1],E=Object(n.useCallback)((function(e){l(e)}),[]);Object(n.useEffect)((function(){}),[]);var h=Object(n.useCallback)((function(e){e.stopPropagation(),b(e.target.value)}),[]),g=Object(n.useMemo)((function(){return/\.(png)|(jpg)|(gif)|(jpeg)$/}),[]),v=Object(n.useCallback)((function(){if(!(s.length<1)){for(var t=new FormData,a=0;a<s.length;a++)t.append("file",s[a]);M.Post("/api/v1/docs/image/upload",t,{}).then((function(t){console.log(t),t.qiniu?e.afterUploadHandle?e.afterUploadHandle(t.qiniu):console.log("\u672a\u4f20\u9012\uff1aafterUploadHandle"):t.file?e.afterUploadHandle?e.afterUploadHandle(t.file):console.log("\u672a\u4f20\u9012\uff1aafterUploadHandle"):K.a.warn("\u4e0a\u4f20\u56fe\u7247\u7684\u8fd4\u56de\u7ed3\u679cfile\u548cqiniu\u5b57\u6bb5\u4e3a\u7a7a")})).catch((function(e){console.log(e)}))}}),[s,e]),O=Object(n.useCallback)((function(t){if(t.stopPropagation(),"uploadImage"===r){if(s.length>0)return void v();K.a.warn("\u8bf7\u9009\u62e9\u9700\u8981\u4e0a\u4f20\u7684\u56fe\u7247")}else"useLink"===r&&(p?g.test(p)?e.afterUploadHandle?e.afterUploadHandle(p):console.log("\u672a\u4f20\u9012\uff1aafterUploadHandle"):K.a.warn("\u56fe\u7247\u7684\u5730\u5740\u9700\u8981\u4ee5jpg/jpeg/png/gif\u7ed3\u5c3e"):K.a.warn("\u8bf7\u8f93\u5165\u56fe\u7247\u7684\u7f51\u5740"))}),[r,g,s.length,v,p,e]),j=!0;return"uploadImage"===r?s.length>0&&(j=!1):"useLink"===r&&p&&g.test(p)&&(j=!1),c.a.createElement("div",{className:"upload-image-tabs"},c.a.createElement(le.a,{defaultActiveKey:r,onChange:E},c.a.createElement(le.a.TabPane,{tab:"\u4e0a\u4f20\u56fe\u7247",key:"uploadImage"},c.a.createElement("div",{className:"upload"},c.a.createElement(oe,{url:"",fileListData:s,setFileListData:u}))),c.a.createElement(le.a.TabPane,{tab:"\u4f7f\u7528\u94fe\u63a5",key:"useLink"},c.a.createElement("div",{className:"input-url"},c.a.createElement(re.a,{placeholder:"\u8f93\u5165\u56fe\u7247\u5730\u5740",allowClear:!0,onChange:h})),"useLink"===r&&p&&g.test(p)&&c.a.createElement("div",{className:"show-image"},c.a.createElement("img",{src:p,alt:"\u56fe\u7247"})))),c.a.createElement("div",{className:"button"},c.a.createElement(H.a,{type:"primary",onClick:O,disabled:j},"\u63d0\u4ea4")))},ue=function(e){e.visible;var t=Object(J.a)(e,["visible"]),a=Object(n.useCallback)((function(t){console.log(t),e.handleAfterClose&&e.handleAfterClose()}),[e]);return c.a.createElement($.a,{wrapClassName:"upload-image-modal",visible:e.visible,onOk:a,onCancel:a,destroyOnClose:!0,footer:null},c.a.createElement(se,t))};function me(e){var t=e.type,a=e.icon,r=e.text,l=(e.title,e.editor),i=(e.historySize,e.setHistorySize),o=e.setModalVisible,s=Object(n.useCallback)((function(e){if(e.preventDefault(),"image"!==t){var a=l.historySize();if(i(a),["undo","redo"].indexOf(t)>=0)switch(t){case"undo":return void l.undo();case"redo":return void l.redo();default:return!1}var n=l.getSelections().map((function(e,a){switch(t){case"link":return"[".concat(e,"]()");case"image":return"![".concat(e,"]()");case"italic":return"*".concat(e,"*");case"bold":return"**".concat(e,"**");case"strikethrough":return"~~".concat(e,"~~");case"list-ul":return"\n- "+e.replace("\n","\n- ");case"list-ol":return"\n1. "+e.replace("\n","\n1. ");case"code":return"`"+e+"`";case"quote":return"\n> "+e;case"blockquote":return"\n```\n"+e+"\n```\n";case"table":return"\n\n | Title1   | Title2 | Title3 | Title4 |\n| ---- | --- | --- | --- |\n| 1    | - | - | - |\n| 2    | - | - | - |\n";default:return e}}));l.replaceSelections(n)}else o(!0)}),[l,i,o,t]);return c.a.createElement("div",{className:"no-active",onClick:s},a?c.a.createElement(O,{type:a,noMarginRight:!0}):c.a.createElement(O,null,r))}var de=function(e){var t=Object(n.useState)({undo:0,redo:0}),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(!1),o=Object(f.a)(i,2),s=o[0],u=o[1];Object(n.useEffect)((function(){if(e.editor){var t=e.editor.historySize();l(t)}}),[e.editor]);var m=[{type:"undo",text:"\u64a4\u9500",icon:"undo"},{type:"redo",text:"\u91cd\u505a",icon:"repeat"},{type:"bold",text:"\u7c97\u4f53",icon:"bold"},{type:"italic",text:"\u659c\u4f53",icon:"italic"},{type:"strikethrough",text:"\u5220\u9664\u7ebf",icon:"strikethrough"},{type:"list-ul",text:"\u65e0\u5e8f\u5217\u8868",icon:"list-ul"},{type:"list-ol",text:"\u6709\u5e8f\u5217\u8868",icon:"list-ol"},{type:"link",text:"\u94fe\u63a5",icon:"link"},{type:"quote",text:"\u5f15\u7528",icon:"quote-left"},{type:"blockquote",title:"\u4ee3\u7801\u5757",icon:"code"},{type:"table",title:"\u8868\u683c",icon:"table"},{type:"image",text:"\u56fe\u7247",icon:"image"}].map((function(t,a){return c.a.createElement(me,{type:t.type,key:a,icon:t.icon,text:t.text,historySize:r,setHistorySize:l,setModalVisible:u,editor:e.editor})})),d=Object(n.useCallback)((function(e){if(e.stopPropagation(),!s&&(e.clipboardData||e.originalEvent)){var t=e.clipboardData||e.originalEvent.clipboardData;if(t.items)for(var a=t.items,n=0;n<a.length;n++)a[n].type.indexOf("image")>=0&&u(!0)}}),[s]);Object(n.useEffect)((function(){return document.addEventListener("paste",d),function(){document.removeEventListener("paste",d)}}),[d]);var p=Object(n.useCallback)((function(t){console.log("\u4e0a\u4f20\u4e86\u56fe\u7247\uff1a",t);var a=e.editor.getSelections().map((function(e,a){return"![".concat(e,"](").concat(t,")")}));e.editor.replaceSelections(a),u(!1)}),[e.editor]);return c.a.createElement("div",{className:"tools"},c.a.createElement(ne.a,{style:{width:"100%"}},c.a.createElement(ce.a,{xs:{span:24},sm:{span:16},className:"left"},m),c.a.createElement(ce.a,{xs:{span:24},sm:{span:8},className:"right"},c.a.createElement("div",{className:"no-active",onClick:function(){return e.setDisplay((function(e){return{markdown:!0,html:!e.html}}))}},c.a.createElement(O,{type:e.display&&e.display.html?"eye-slash":"eye"})),c.a.createElement("div",{className:!e.display.markdown&&e.display.html?"active":"no-active",onClick:function(){return e.setDisplay((function(e){return{markdown:!e.markdown,html:!0}}))}},c.a.createElement(O,{type:"desktop"})),c.a.createElement("div",{className:"no-active",onClick:function(t){console.log(t),t.preventDefault(),window.editor=e.editor}},c.a.createElement(O,{type:"cog"})))),c.a.createElement(ue,{visible:s,handleAfterClose:function(){return u(!1)},afterUploadHandle:p}))};a(741);var fe=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(null),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)({markdown:!0,html:!0}),d=Object(f.a)(m,2),p=d[0],b=d[1],E=Object(n.useCallback)((function(t,a,n){e.onChange&&"function"===typeof e.onChange&&e.onChange(n)}),[e]),h=Object(n.useCallback)((function(e,t,a){l(a)}),[]);return Object(n.useEffect)((function(){e.content!==r&&l(e.content)}),[e.content]),c.a.createElement("div",{className:"editor"},c.a.createElement("div",null,c.a.createElement(de,{editor:s,display:p,setDisplay:b})),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"markdown",style:{display:p.markdown?"block":"none"}},c.a.createElement("div",{style:{position:"relative",height:"100%",display:p.markdown?"block":"none"}},c.a.createElement(Z.Controlled,{editorDidMount:function(e){u(e)},autoCursor:!0,options:{mode:"markdown",theme:"eclipse",lineNumbers:!0},value:r,onBeforeChange:h,onChange:E}))),c.a.createElement("div",{className:"html",style:{display:p.html?"block":"none"}},c.a.createElement(q.a,{source:r||"\u8bf7\u8f93\u5165\u6587\u7ae0\u5185\u5bb9",renderers:{code:ae}}))))},pe=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(!1),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(null),d=Object(f.a)(m,2),p=d[0],b=d[1];Object(n.useEffect)((function(){if(e.visable){var t="article_".concat(e.articleID,"_content"),a=localStorage.getItem(t);if(a)try{b(JSON.parse(a))}catch(n){console.log(n),b(null)}else b(null)}l(e.markdownContent)}),[e.articleID,e.markdownContent,e.visable]);var E=Object(n.useCallback)((function(){s&&s&&e.content!==r&&e.handleContentUpdated&&e.handleContentUpdated(r)}),[s,r,e]),h=Object(n.useCallback)((function(t){E(),e.afterModalCloseHandle&&"function"===typeof e.afterModalCloseHandle&&e.afterModalCloseHandle()}),[E,e]),g=Object(n.useCallback)((function(){E(),e.afterModalCloseHandle&&"function"===typeof e.afterModalCloseHandle&&e.afterModalCloseHandle()}),[E,e]);Object(n.useEffect)((function(){e.markdownContent===r||r||l(e.markdownContent),s||r===e.content||u(!0)}),[e.markdownContent,s]),Object(n.useEffect)((function(){return function(){s&&console.log("\u6211\u66f4\u65b0\u4e86\uff0c\u6211\u9700\u8981\u505a\u70b9\u64cd\u4f5c")}}),[s]);var v=Object(n.useMemo)((function(){if(p&&p.content&&e.visable){var t=c.a.createElement("div",{onDoubleClick:function(e){e.stopPropagation(),l(p.content),p.key&&localStorage.removeItem(p.key),b(null)}},"".concat(p.time,":\u66f4\u65b0\u672a\u63d0\u4ea4\u6210\u529f\uff0c\u53cc\u51fb\u5207\u6362\u6210\u672a\u63d0\u4ea4\u7684\u5185\u5bb9"));return c.a.createElement(X.a,{className:"alert",message:t,type:"warning",closable:!0,closeText:"\u5ffd\u7565",onClose:function(e){e.stopPropagation(),p.key&&localStorage.removeItem(p.key)}})}return null}),[p,e.visable]);return c.a.createElement($.a,{visible:e.visable,width:"90%",wrapClassName:"editor-modal",onCancel:g,onOk:h,footer:null,destroyOnClose:!!e.content},c.a.createElement("div",null,v,c.a.createElement(fe,{content:r,onChange:function(e){return l(e)}})))},be=(a(210),a(116)),Ee=function(e){return c.a.createElement("div",{className:"loading"},c.a.createElement("div",null,c.a.createElement(be.a,{size:e.size?e.size:"default"}),c.a.createElement("div",{className:"message"},e.message?e.message:"\u6570\u636e\u52a0\u8f7d\u4e2d...")))},he=(a(149),a(21)),ge=a(54),ve=(a(746),a(298)),Oe=(a(748),a(299)),je=function(e){var t=e.data,a=e.children,r=e.afterFetchPostHandle,l=Object(n.useState)(null),i=Object(f.a)(l,2),o=i[0],s=i[1],u=Object(n.useCallback)((function(e){e.stopPropagation(),s(e.target.value)}),[]),m=Object(n.useCallback)((function(e,t,a){if(t){M.Post("/api/v1/docs/discussion/create",{},{data:{category:"comment",content:t,parent:a}}).then((function(e){e.id>0?(K.a.success("\u6dfb\u52a0\u8bc4\u8bba\u6210\u529f",3),s(null),r&&r()):K.a.warn("\u8bc4\u8bba\u5931\u8d25\uff1a"+JSON.stringify(e),5)})).catch((function(e){console.log(e),K.a.error("\u8bc4\u8bba\u5931\u8d25",5)}))}}),[r]);return c.a.createElement(ve.a,{author:t.user,avatar:c.a.createElement(Oe.a,{style:{backgroundColor:"#87d068"},icon:c.a.createElement(O,{type:"user",noMarginRight:!0}),alt:t.user}),content:t.content,datetime:Y()(t.time_added,"YYYY-MM-DD HH:mm:ss").fromNow()},c.a.createElement("div",{className:"comment"},c.a.createElement(re.a.Search,{value:o,onChange:u,onSearch:function(e){return m("comment",o,t.id)},placeholder:"\u8bc4\u8bba",enterButton:c.a.createElement(H.a,{type:"primary"},"\u8bc4\u8bba")})),a)},ye=function(e){var t=e.id,a=Object(n.useState)(0),r=Object(f.a)(a,2),l=r[0],i=r[1],o=Object(n.useState)([]),s=Object(f.a)(o,2),u=s[0],m=s[1],d=Object(n.useState)("comment"),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useState)(null),g=Object(f.a)(h,2),v=g[0],O=g[1],j=Object(n.useCallback)((function(e,t){if(!(t<1)&&e){var a="/api/v1/docs/article/".concat(e,"/discussions?page=").concat(t);M.Get(a,{},{}).then((function(e){var a=e.results;m(1===t?a:function(e){return[].concat(Object(ge.a)(e),Object(ge.a)(a))}),e.next?i((function(e){return e+1})):i(0)}))}}),[]);Object(n.useEffect)((function(){t&&(m([]),j(t,1))}),[t,j]);var y=Object(n.useCallback)((function(){j(t,1)}),[j,t]),k=Object(n.useMemo)((function(){return u.map((function(e,t){for(var a,n=e.parent,r=[e];n;)r.push(n),n=n.parent;for(var l=0;l<r.length;l++){var i=r[l];a=c.a.createElement(je,{key:"".concat(e.id,"-").concat(i.id),data:i,afterFetchPostHandle:y},a)}return a}))}),[y,u]),N=Object(n.useCallback)((function(e){E(e.target.value),e.stopPropagation()}),[]),C=Object(n.useCallback)((function(e){e.stopPropagation(),O(e.target.value)}),[]),S=Object(n.useCallback)((function(e,a,n){if(a){M.Post("/api/v1/docs/discussion/create",{},{data:{article:t,category:e,content:a,parent:n}}).then((function(e){e.id>0?(K.a.success("\u6dfb\u52a0\u8bc4\u8bba\u6210\u529f",3),O(null),j(t,1)):K.a.warn("\u8bc4\u8bba\u5931\u8d25\uff1a"+JSON.stringify(e),5)})).catch((function(e){console.log(e),K.a.error("\u8bc4\u8bba\u5931\u8d25",5)}))}}),[j,t]);return c.a.createElement("div",{className:"discussions"},c.a.createElement("div",{className:"add"},c.a.createElement(re.a.TextArea,{value:v,autoSize:{minRows:2,maxRows:6},onChange:C}),c.a.createElement("div",{className:"buttons"},c.a.createElement(he.a.Group,{defaultValue:b,buttonStyle:"solid",onChange:N},c.a.createElement(he.a.Button,{value:"discussion"},"\u8ba8\u8bba"),c.a.createElement(he.a.Button,{value:"comment"},"\u8bc4\u8bba"),c.a.createElement(he.a.Button,{value:"ask"},"\u63d0\u95ee"),c.a.createElement(he.a.Button,{value:"issue"},"\u95ee\u9898"),c.a.createElement(he.a.Button,{value:"feedback"},"\u53cd\u9988")),c.a.createElement(H.a,{type:"primary",onClick:function(){return S(b,v)},disabled:!v,className:"float-right"},"\u63d0\u4ea4"))),c.a.createElement("div",{className:"list"},k),l>0?c.a.createElement("div",{className:"more",onClick:function(){return j(t,l)}},"\u8fd8\u6709\u4e0b\u4e00\u9875"):null)},ke=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)({}),s=Object(f.a)(o,2),m=s[0],d=s[1],p=Object(n.useContext)(u),b=p.setNavData,E=p.setRefreshNavTimes,h=p.currentArticleGroupID,g=p.setCurrentArticleGroupID,v=p.groupPermissions,j=p.setGroupPermissions,y=Object(n.useState)(!1),k=Object(f.a)(y,2),N=k[0],C=k[1],S=Object(n.useState)(!1),x=Object(f.a)(S,2),w=x[0],I=x[1],P=Object(n.useState)(!1),D=Object(f.a)(P,2),_=D[0],U=D[1],A=Object(n.useState)(!1),F=Object(f.a)(A,2),R=F[0],z=F[1],L=Object(n.useState)(!1),T=Object(f.a)(L,2),B=T[0],J=T[1],W=Object(n.useState)(0),Y=Object(f.a)(W,2),$=Y[0],X=Y[1],Z=Object(n.useState)(!1),ee=Object(f.a)(Z,2),te=ee[0],ne=ee[1],ce=Object(n.useCallback)((function(e){if(e){var t="/api/v1/docs/article/".concat(e);M.Get(t,{},{}).then((function(t){if(J(!0),t.id>0){d(t),l(e),Number.isInteger(t.group)&&h!==t.group&&g(t.group);for(var a=[{title:t.title,icon:t.icon}],n=t.parent;n;){var c={title:n.title?n.title:"\u65e0\u6807\u9898",link:"/docs/article/".concat(n.id),icon:n.icon,id:n.id};a.unshift(c),n=n.parent}a.unshift({title:"\u9996\u9875",icon:"home",link:"/"}),"function"===typeof b?b(a):console.log("\u4e0d\u80fd\u8bbe\u7f6enavData"),document.title="\u770b\u677f--".concat(t.title)}else K.a.warn("\u83b7\u53d6\u6587\u7ae0\u6570\u636e\u51fa\u9519")})).catch((function(e){J(!0),console.log(e),e&&e.status&&(403===e.status||404===e.status)&&(d({}),X(e.status))}))}}),[h,g,b]);Object(n.useEffect)((function(){(e.match.params.id!==r||m.id&&e.match.params.id!==m.id.toString())&&(J(!1),ce(e.match.params.id))}),[e.match.params.id,ce]);var re=Object(n.useMemo)((function(){return Array.isArray(m.children)?m.children.map((function(e,t){return c.a.createElement("li",{key:t},c.a.createElement(i.b,{to:"/docs/article/".concat(e.id)},c.a.createElement(O,{type:"file-text-o"}),e.title?e.title:c.a.createElement("span",{className:"no-title"},"\u65e0\u6807\u9898")))})):[]}),[m]),le=Object(n.useCallback)((function(){E((function(e){return e+1}))}),[E]),ie=Object(n.useCallback)((function(){z(!0)}),[]),oe=Object(n.useCallback)((function(){z(!1),setTimeout((function(){ce(r)}),300)}),[r,ce]),se=Object(n.useCallback)((function(e){var t="/api/v1/docs/group/".concat(e,"/permissions");M.Get(t,{},{}).then((function(e){Array.isArray(e)&&j(e)})).catch((function(e){console.log(e)}))}),[j]);Object(n.useEffect)((function(){h>0&&se(h)}),[h,se]),Object(n.useEffect)((function(){m&&m.group>0&&m.group!==h&&se(m.group)}),[h,m,se]),Object(n.useEffect)((function(){v.indexOf("write")>=0?ne(!0):ne(!1)}),[v]);var me=Object(n.useCallback)((function(e){Q(r,{cover:e},(function(){I(!1),ce(r)}))}),[r,ce]);if(!B)return c.a.createElement(Ee,{size:"large"});if(!m.id&&$>0){if(403===$)return c.a.createElement(G.a,{status:"403",title:"403",subTitle:"Sorry\uff0c\u60a8\u6682\u65f6\u65e0\u6743\u9650\u8bbf\u95ee\u672c\u9875\u9762:".concat(e.history.location.pathname),extra:c.a.createElement(H.a,{type:"primary"},c.a.createElement(i.b,{to:"/"},"\u8fd4\u56de\u9996\u9875"))});if(404===$)return c.a.createElement(G.a,{status:"404",title:"404",subTitle:"Sorry\uff0c\u60a8\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728:".concat(e.history.location.pathname),extra:c.a.createElement(H.a,{type:"primary"},c.a.createElement(i.b,{to:"/"},"\u8fd4\u56de\u9996\u9875"))})}return c.a.createElement("article",null,c.a.createElement("header",{className:"middle"},c.a.createElement("div",{className:"title"},c.a.createElement("div",{className:"toogle"},c.a.createElement("span",{className:"button",onClick:function(){C((function(e){return!e}))}},c.a.createElement(O,{type:"info-circle"}),N?"\u9690\u85cf\u63cf\u8ff0":"\u663e\u793a\u63cf\u8ff0"),c.a.createElement("span",{className:"button",onClick:function(){I((function(e){return!e}))}},c.a.createElement(O,{type:"image"}),te&&(m.cover?"\u4fee\u6539\u5c01\u9762":"\u6dfb\u52a0\u5c01\u9762")),c.a.createElement("span",{className:"button",onClick:function(){U((function(e){return!e}))}},c.a.createElement(O,{type:"commenting"}),_?"\u9690\u85cf\u8ba8\u8bba":"\u663e\u793a\u8ba8\u8bba")),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"icon"},c.a.createElement(O,{type:"file-text-o"})),te?c.a.createElement(V,{key:"{data.id}-title",content:m.title?m.title:"\u65e0\u6807\u9898",contentType:"text",tagName:"h1",handleContentUpdated:function(e){return Q(r,{title:e.text},le)}}):c.a.createElement("h1",null,m.title?m.title:"\u65e0\u6807\u9898"))),m.cover&&c.a.createElement("div",{className:"cover"},c.a.createElement("img",{src:m.cover,alt:"\u5c01\u9762"})),N&&c.a.createElement("div",{className:"description"},te?c.a.createElement(V,{key:"{data.id}-description",content:m.description?m.description:"\u8bf7\u586b\u5199\u6587\u7ae0\u63cf\u8ff0",contentType:"text",tagName:"div",handleContentUpdated:function(e){return Q(r,{description:e.text})}}):c.a.createElement("div",null,m.description?m.description:"\u8bf7\u586b\u5199\u6587\u7ae0\u63cf\u8ff0"))),c.a.createElement("div",{className:"content"},c.a.createElement("section",null,c.a.createElement(q.a,{renderers:{code:ae},source:m.content?m.content:"> \u8bf7\u7f16\u8f91\u6587\u7ae0\u5185\u5bb9"}),te?c.a.createElement("div",{className:"editor-button"},c.a.createElement(H.a,{type:"primary",size:"small",disabled:R,icon:c.a.createElement(O,{type:"edit"}),onClick:ie},"\u7f16\u8f91")):null),_&&c.a.createElement("section",null,c.a.createElement("div",{className:"title"},c.a.createElement("h2",null,"\u8bc4\u8bba")),c.a.createElement(ye,{id:r}))),re.length>0&&c.a.createElement("section",{className:"children"},c.a.createElement("h2",null,"\u6587\u7ae0\u5217\u8868"),c.a.createElement("ul",null,re)),c.a.createElement("footer",null),te&&c.a.createElement(pe,{articleID:r,visable:R,markdownContent:m.content,afterModalCloseHandle:oe,handleContentUpdated:function(e){return Q(r,{content:e})}}),te&&w&&c.a.createElement(ue,{visible:w,afterUploadHandle:me,handleAfterClose:function(){return I(!1)}}))},Ne=(a(211),a(87)),Ce=(a(150),a(82)),Se=(a(213),a(97)),xe=(a(214),a(120));function we(e,t){var a=new URLSearchParams(t),n={};return e.forEach((function(e){n[e]=a.get(e)})),n}var Ie=function e(t){var a=this;Object(b.a)(this,e),this.get=function(e){return a.params[e]},this.set=function(e,t){a.params[e]=t},this.parse=function(e){return"string"!==typeof e?{}:("?"===e[0]&&(e=e.slice(1)),decodeURI(e).split("&").map((function(e){var t=e.split("="),a=t[0],n=t[1]||!0;return"string"===typeof n&&!1===isNaN(Number(n))&&(n=Number(n)),{key:a,value:n}})).reduce((function(e,t){var a=t.key,n=t.value;return"undefined"===typeof e[a]?e[a]=n:(e[a]=Array.isArray(e[a])?e[a]:[e[a]],e[a].push(n)),e}),{}))},this.url=t,this.params=this.parse(t)};window.URLSearchParams;var Pe=Ie;function Me(e,t,a,n){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(void 0===c||null===c)M.Get(e).then((function(r){var l=!1;if(r instanceof Array)c=r,l=!0;else{var i=r.results;i instanceof Array&&(c=i,l=!0)}l&&Me(e,t,a,n,c)})).catch((function(e){return console.log(e)}));else{var r=c.map((function(e){return{text:e[t],value:e[a]}}));n(r)}}var De=function(e){K.a.error("\u53d6\u6d88\u5220\u9664",3)},_e=["#108ee9","blue","geekblue","green","gold"];var Ue=function(e){var t=this,a=Object(n.useMemo)((function(){return["page","search","ordering","parent","level","is_deleted"]}),[]),r=Object(n.useContext)(u).setNavData,l=Object(n.useState)({}),o=Object(f.a)(l,2),s=o[0],m=o[1],d=Object(n.useState)([]),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useState)({current:1,total:0}),g=Object(f.a)(h,2),v=g[0],j=g[1],y=Object(n.useState)(!1),k=Object(f.a)(y,2),N=k[0],C=k[1],S=Object(n.useState)([]),x=Object(f.a)(S,2),w=x[0],I=x[1],P=Object(n.useState)({}),D=Object(f.a)(P,2),_=D[0],U=D[1],A=Object(n.useCallback)((function(t){if(N){if(b.length>0)return}else C(!0);t=isNaN(t)||!t?1:parseInt(t,10);var n="/api/v1/docs/group/list?page=".concat(t),c=e.location.search,r=we(a,c);a.forEach((function(e){var t=r[e];void 0!==t&&null!==t&&"page"!==e&&(n="".concat(n,"&").concat(e,"=").concat(t))})),M.Get(n).then((function(e){var a=e.results;a instanceof Array?(E(a),C(!1),j({current:t,total:e.count})):(C(!1),K.a.error(JSON.stringify(e),5))})).catch((function(e){console.log(e),C(!1)}))}),[b.length,N,a,e.location.search]);Object(n.useEffect)((function(){var t=e.location.search;if(t!==_.locationSearch){var n=we(a,t);m(n),U((function(e){return e.locationSearch=t,e})),A(n.page)}}),[a,e.location,s,_,A]),Object(n.useEffect)((function(){var e,t;void 0===_.userCanAddGroup&&(e="userCanAddGroup",t=U,M.Post("/api/v1/account/permission/check",{},{data:{permission:"docs.add_group"}}).then((function(a){t((function(t){return t[e]=a.result,t}))})).catch((function(e){return console.log(e)})))}),[_.userCanAddGroup]),Object(n.useEffect)((function(){_.parentFilterOptionsLock||(Me("/api/v1/docs/group/all?level=1","name","id",I,null),U((function(e){return e.parentFilterOptionsLock=!0,e})))}),[_.parentFilterOptionsLock]),Object(n.useEffect)((function(){r([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863",link:"/docs/group"},{title:"\u5217\u8868"}])}),[r]);var F=Object(n.useCallback)((function(e){var t="/api/v1/docs/group/".concat(e.id);M.Delete(t).then((function(t){if(204!==t.status)return 200===t.status||K.a.success("\u5220\u9664\u5206\u7ec4(ID:".concat(e.id,"-").concat(e.name,"-").concat(e.code,")\u5931\u8d25\uff01"),3),t.json();K.a.success("\u5220\u9664\u5206\u7ec4(ID:".concat(e.id,"-").concat(e.name,"-").concat(e.code,")\u6210\u529f"),3),A(v.current)})).then((function(e){e&&(e.message?K.a.warn(e.message,8):K.a.error(JSON.stringify(e),3))})).catch((function(e){console.log(e)}))}),[A,v]),R=Object(n.useCallback)((function(t){var n;n=t?"/docs/group/list?page=1&search=".concat(t):"/docs/group/list?page=1",a.forEach((function(e){if("search"!==e&&"page"!==e){var t=s[e];void 0!==t&&null!==t&&(n="".concat(n,"&").concat(e,"=").concat(t))}})),e.history.push(n)}),[a,e.history,s]),z=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",width:60,sorter:function(e,t){return e.id-t.id},render:function(e,t){return c.a.createElement(i.b,{to:"/docs/group/".concat(t.id)},e)}},{title:"\u5206\u7ec4\u540d",dataIndex:"name",key:"name",width:120,ellipsis:!0},{title:"\u4ee3\u7801",dataIndex:"code",key:"code",width:120,ellipsis:!0},{title:"\u7236\u7ea7\u5206\u7ec4",dataIndex:"parent",key:"parent",filters:w||[],filterMultiple:!1,width:115,ellipsis:!0,render:function(e,t){return c.a.createElement(xe.a,{color:t.level<=_e.length?_e[t.level-1]:""},t.level>1?e:"\u4e00\u7ea7\u5206\u7ec4")}},{title:"\u6240\u6709\u8005",dataIndex:"owner",key:"owner",width:100,ellipsis:!0,sorter:function(){}},{title:"\u63cf\u8ff0",dataIndex:"description",key:"description",width:200,ellipsis:!0},{title:"\u72b6\u6001",dataIndex:"is_deleted",key:"is_deleted",width:80,render:function(e){return e?c.a.createElement("span",{className:"status"},c.a.createElement(O,{type:"close"})):c.a.createElement("div",{className:"status"},c.a.createElement(O,{type:"check"}))},filters:[{text:"\u6709\u6548",value:"false"},{text:"\u7981\u7528",value:"true"}],filterMultiple:!1,onFilter:function(e,t){return t.is_deleted.toString()===e}},{title:"\u64cd\u4f5c",key:"action",width:300,render:function(e,t){return _.userCanAddGroup?c.a.createElement("span",null,c.a.createElement(i.b,{to:"/docs/group/".concat(e.id)},c.a.createElement(H.a,{type:"link",size:"small"},c.a.createElement(O,{type:"link"}," \u8be6\u60c5"))),c.a.createElement(Se.a,{type:"vertical"}),c.a.createElement(i.b,{to:"/docs/group/".concat(e.id,"/editor")},c.a.createElement(H.a,{type:"link",size:"small"},c.a.createElement(O,{type:"edit"}," \u7f16\u8f91"))),c.a.createElement(Se.a,{type:"vertical"}),c.a.createElement(Ce.a,{title:"\u662f\u5426\u5220\u9664\u5206\u7ec4(ID:".concat(e.id,"-").concat(e.name,"-").concat(e.code,")"),onCancel:De,onConfirm:function(){return F(e)}},c.a.createElement("span",{type:"link"},c.a.createElement(H.a,{type:"link",size:"small",danger:!0,disabled:e.is_deleted},c.a.createElement(O,{type:"trash-o"}," \u5220\u9664"))))):c.a.createElement("span",null,c.a.createElement(i.b,{to:"/docs/group/".concat(e.id)},c.a.createElement(H.a,{type:"link",size:"small"},c.a.createElement(O,{type:"link"}," \u8be6\u60c5"))))}}]}),[F,_.userCanAddGroup,w]),L=Object(n.useMemo)((function(){return{expandedRowRender:function(e,t,a,n){return e.children.length>0?c.a.createElement(Ne.a,{bordered:!1,dataSource:e.children,rowKey:"id",size:"small",columns:z,pagination:!1,expandable:L}):null},rowExpandable:function(e){return e.children.length>0},childrenColumnName:"__children"}}),[z]),T=Object(n.useCallback)((function(a,n,c){var r=a.current,l=["is_deleted","parent"],i={};l.forEach((function(e){var t=n[e];i[e]=t?t instanceof Array?t[0]:t:null}));var o="/docs/group/list?page=".concat(r);s.search&&(o="".concat(o,"&search=").concat(t.state.search)),l.forEach((function(e){var t=i[e];t&&(o="".concat(o,"&").concat(e,"=").concat(t))})),c&&c.columnKey&&(o="ascend"===c.order?"".concat(o,"&ordering=").concat(c.columnKey):"".concat(o,"&ordering=-").concat(c.columnKey)),e.history.push(o)}),[e.history,s.search]),G=Object(n.useMemo)((function(){return _.userCanAddGroup?c.a.createElement(i.b,{to:"/docs/group/add"},c.a.createElement(H.a,{style:{width:100},type:"primary",icon:c.a.createElement(O,{type:"plus"})},"Add")):null}),[_.userCanAddGroup]),B=Object(n.useMemo)((function(){return c.a.createElement(H.a,{style:{width:100},onClick:function(){var t;t=1!==s.level&&"1"!==s.level?"/docs/group/list?level=1":"/docs/group/list",e.history.push(t)},type:"primary",icon:c.a.createElement(O,{type:"filter"})},1!==s.level&&"1"!==s.level?"\u4e00\u7ea7\u5206\u7ec4":"\u5168\u90e8\u5206\u7ec4")}),[e.history,s.level]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6587\u6863\u5206\u7ec4")),c.a.createElement(ne.a,{className:"tools"},c.a.createElement(ce.a,{span:12},c.a.createElement(re.a.Search,{placeholder:"search group",style:{width:200},onSearch:R})),c.a.createElement(ce.a,{span:12,style:{textAlign:"right"}},c.a.createElement(H.a,{type:"default",style:{width:100},icon:c.a.createElement(O,{type:"refresh"}),onClick:function(){return A(v.current)}},"\u5237\u65b0"),B,G)),c.a.createElement("div",{className:"main-list"},c.a.createElement(Ne.a,{columns:z,dataSource:b,rowKey:"id",pagination:v,onChange:T,expandable:L}))))},Ae=(a(834),a(308)),Fe=(a(128),a(15)),Re={labelCol:{xs:{span:24},sm:{span:5},md:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15},md:{span:14}}},ze={wrapperCol:{offset:8,span:8}};var Le=function(e){var t=e.checkValues,a=e.checkValuesState,r=e.dataSourceUrl,l=e.columns,i=e.rowKey,o=void 0===i?"id":i,s=e.isMultiple,u=void 0===s||s,m=e.disabledKeys,d=void 0===m?[]:m,p=e.showSubs,b=void 0!==p&&p,E=e.subsKey,h=void 0===E?"subs":E,g=Object(n.useState)(null),v=Object(f.a)(g,2),O=v[0],j=v[1];Object(n.useEffect)((function(){r!==O&&(j(r),r&&P(r,1))}),[O,r]);var y=Object(n.useState)([]),k=Object(f.a)(y,2),N=k[0],C=k[1],S=Object(n.useState)({current:1,total:0}),x=Object(f.a)(S,2),w=x[0],I=x[1],P=function(e,t){var a=e;a=a.indexOf("?")>0?"".concat(a,"&page=").concat(t):"".concat(a,"?page=").concat(t),M.Get(a).then((function(e){if(e instanceof Array)C(e);else{var a=e.results;a instanceof Array&&(C(a),I({current:t,total:e.count}))}})).catch((function(e){console.log(e)}))},D={hideDefaultSelections:!0,selectedRowKeys:t||[],onChange:function(e){a(e)},type:u?"checkbox":"radio",getCheckboxProps:function(e){return{disabled:function(){if(d&&d instanceof Array)for(var t=0;t<d.length;t++)if(e[o]===d[t])return!0;return!1}(),name:e[o]?e[o].toString():"---"}}},_={expandedRowRender:function(e){return e[h].length>0?c.a.createElement(Ne.a,{showHeader:!1,bordered:!1,dataSource:e[h],rowKey:o,size:"small",rowSelection:D,columns:l,pagination:!1,expandable:b?_:void 0}):null},rowExpandable:function(e){return e[h].length>0},childrenColumnName:"__children"};return c.a.createElement("div",null,c.a.createElement(Ne.a,{title:function(){return t.length>0?"\u5f53\u524d\u9009\u4e2d\u7684\u503c\u6709\uff1a".concat(JSON.stringify(t)):null},columns:l,dataSource:N,pagination:w,onChange:function(e,t,a,n){var c=e.current;P(r,c)},rowKey:o,rowSelection:D,bordered:!0,expandable:b?_:void 0}))},Te=(a(270),a(88));var Ge=function(e){var t=Object(n.useState)(0),a=Object(f.a)(t,2),r=a[0],l=a[1];return Object(n.useEffect)((function(){e.checkValues!==r&&l(e.checkValues)}),[e.checkValues,r]),c.a.createElement("div",{style:{display:"flex"}},c.a.createElement(Te.a,{style:{flex:1},allowClear:!0,showSearch:!0,model:e.isMultiple?"multiple":"",value:r||[],onChange:function(t){var a;t||(t=[]),l(t),e.checkValuesState&&e.checkValuesState(t),a={data:t,value:t},e.onChange&&e.onChange(Object(y.a)({value:r},e.value,{},a))}},e.checkValues instanceof Array&&e.checkValues.map((function(e,t){return c.a.createElement(Te.a.Option,{key:t,value:e},e)}))),c.a.createElement(H.a,{type:"primary",style:{width:80},onClick:e.onButtonClick},"\u9009\u62e9"))};var He=function(e){var t=c.a.createRef(),a=Object(n.useState)({order:1,is_deleted:!1}),r=Object(f.a)(a,2),l=r[0],i=r[1],o=Object(n.useState)([]),s=Object(f.a)(o,2),u=s[0],m=s[1],d=Object(n.useState)(!1),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useState)([]),g=Object(f.a)(h,2),v=g[0],O=g[1];Object(n.useEffect)((function(){if(l!==e.data&&e.data&&(i(e.data),e.data.id>0&&"editor"===e.type)){var a=e.data;e.data.parent?a.parent=e.data.parent:a.parent="",t.current.setFieldsValue(a),O([e.data.parent])}}),[e.data,e.type,l,t,e]),Object(n.useEffect)((function(){v instanceof Array&&t.current.setFieldsValue({parent:v})}),[v,t]);var j=Object(n.useCallback)((function(){E(!1),t.current.setFieldsValue({parent:v})}),[v,t]),y=Object(n.useCallback)((function(t){t.image=u,t.parent?t.parent instanceof Array&&(t.parent.length>0?t.parent=t.parent[0]:t.parent=""):t.parent="",e.handleSubmit?e.handleSubmit(t):K.a.error("\u6ca1\u4f20\u9012\u8868\u5355\u63d0\u4ea4\u5904\u7406\u51fd\u6570",5)}),[u,e]),k=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){return e.id-t.id}},{title:"\u5206\u7ec4\u540d",dataIndex:"name",key:"name"},{title:"\u4ee3\u7801",dataIndex:"code",key:"code"},{title:"\u7236\u7ea7\u5206\u7ec4",dataIndex:"parent",key:"parent"},{title:"\u63cf\u8ff0",dataIndex:"description",key:"description"}]}),[]);return c.a.createElement(Fe.a,{ref:t,onFinish:y,initialValues:l},c.a.createElement(ne.a,null,c.a.createElement(ce.a,{xs:24,sm:24,md:24},c.a.createElement(Fe.a.Item,Object.assign({},Re,{label:"\u5206\u7ec4\u540d",name:"name",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5206\u7ec4\u540d"}]}),c.a.createElement(re.a,{placeholder:"name"})),c.a.createElement(Fe.a.Item,Object.assign({},Re,{label:"Code",name:"code",rules:[{required:"editor"!==e.type,message:"\u8bf7\u586b\u5199\u5206\u7ec4\u7684code"}]}),c.a.createElement(re.a,{placeholder:"code",disabled:"editor"===e.type})),c.a.createElement(Fe.a.Item,Object.assign({},Re,{label:"\u7236\u7ea7\u5206\u7ec4",name:"parent",rules:[{required:!1,message:"\u8bf7\u586b\u5199\u7236\u7ea7\u5206\u7ec4"}]}),c.a.createElement(Ge,{checkValues:v,checkValuesState:O,onButtonClick:function(){return E(!0)},isMultiple:!1})),c.a.createElement(Fe.a.Item,Object.assign({},Re,{label:"\u6392\u5e8f",name:"order",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5206\u7ec4\u7684\u6392\u5e8f"}]}),c.a.createElement(Ae.a,{min:1,max:100})),c.a.createElement(Fe.a.Item,Object.assign({},Re,{label:"\u63cf\u8ff0",name:"description",rules:[{required:!0,message:"\u8bf7\u63cf\u8ff0\u4e00\u4e0b\u5f53\u524d\u5206\u7ec4"}]}),c.a.createElement(re.a.TextArea,{rows:4,autoSize:{minRows:4,maxRows:20},placeholder:"description"})),c.a.createElement(Fe.a.Item,Object.assign({style:{display:"editor"===e.type?"show":"none"}},Re,{label:"\u6dfb\u52a0\u65f6\u95f4",rules:[{required:!0,message:"\u8bf7\u63cf\u8ff0\u4e00\u4e0b\u5f53\u524d\u5206\u7ec4"}]}),c.a.createElement(re.a,{value:l.time_added?l.time_added:null,disabled:!0})),c.a.createElement(Fe.a.Item,Object.assign({},Re,{label:"\u56fe\u7247",name:"image",rules:[{required:!1,message:"\u8bf7\u586b\u5199\u56fe\u7247"}]}),c.a.createElement(oe,{url:l.image,fileListData:u,setFileListData:m})),c.a.createElement(Fe.a.Item,Object.assign({},Re,{label:"\u72b6\u6001",name:"is_deleted",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u72b6\u6001"}]}),c.a.createElement(he.a.Group,{buttonStyle:"solid"},c.a.createElement(he.a.Button,{value:!1},"\u6709\u6548"),c.a.createElement(he.a.Button,{value:!0},"\u7981\u7528"))),c.a.createElement(Fe.a.Item,Object.assign({style:{textAlign:"center"}},ze),c.a.createElement(H.a,{type:"primary",htmlType:"submit"},"editor"===e.type?"\u7f16\u8f91":"\u6dfb\u52a0")))),c.a.createElement($.a,{title:"\u8bf7\u9009\u62e9\u7236\u7ea7\u5206\u7ec4",visible:b,width:"60%",onOk:j,onCancel:function(){E(!1)}},c.a.createElement(Le,{checkValues:v,checkValuesState:O,dataSourceUrl:"/api/v1/docs/group/list?level=1",columns:k,rowKey:"code",isMultiple:!1,disabledKeys:[l.code],showSubs:!0,subsKey:"children"})))};var Ke=function(e){var t=Object(n.useContext)(u).setNavData;return Object(n.useEffect)((function(){t([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863\u5206\u7ec4",link:"/docs/group"},{title:"\u6dfb\u52a0"}])}),[t]),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6dfb\u52a0\u5206\u7ec4")),c.a.createElement(He,{data:{},type:"add",handleSubmit:function(t){var a=new FormData;for(var n in t){var c=t[n];if("image"===n){if(c instanceof Array)for(var r=0;r<c.length;r++)a.append("image",c[r])}else a.append(n,c)}M.Post("/api/v1/docs/group/create",a,{}).then((function(t){t.id>0?(K.a.success("\u6dfb\u52a0\u5206\u7ec4(id:".concat(t.id,")\u6210\u529f"),5),e.history.push("/docs/group/".concat(t.id))):(K.a.warn("\u6dfb\u52a0\u5206\u7ec4\u5931\u8d25",5),K.a.error(JSON.stringify(t),8))})).catch((function(e){K.a.error("\u6dfb\u52a0\u5206\u7ec4\u51fa\u9519",5),console.log(e)}))}})))},Be=(a(838),a(222)),qe=Be.a.Item,Je=function(e){function t(){return Object(b.a)(this,t),Object(h.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e,t,a=this.props.data;if(1===a.action_flag)e="\u6dfb\u52a0",t="\u6dfb\u52a0\u5bf9\u8c61";else if(2===a.action_flag){e="\u4fee\u6539";var n=a.message;t=n instanceof Array?n.map((function(e,t){var a=e.value_old instanceof Array?e.value_old.join(","):e.value_old,n=e.value_new instanceof Array?e.value_new.join(","):e.value_new?e.value_new.toString():"null";return c.a.createElement("div",{className:"changed-message",key:t},c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"field"},"\u5b57\u6bb5\uff1a",e.field),c.a.createElement("div",{className:"value-old"},a),c.a.createElement("div",{className:"value-new"},n)))})):"\u4fee\u6539\u5bf9\u8c61"}else{if(3!==a.action_flag)return null;e="\u5220\u9664",t="\u5220\u9664\u5bf9\u8c61"}return c.a.createElement("div",{className:"modlelog-item"},c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u7528\u6237:"),c.a.createElement("span",{className:"value"},a.user)),c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u64cd\u4f5c:"),c.a.createElement("span",{className:"value"},e)),c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u4fe1\u606f:"),c.a.createElement("span",{className:"value"},t)),c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u65f6\u95f4:"),c.a.createElement("span",{className:"value time"},a.time_added)))}}]),t}(c.a.Component),Ve=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).fetchData=function(){if(a.state.nextPage){if(a.state.loading)return;a.setState({loading:!0});var e="/api/v1/modellog/".concat(a.state.app,"/").concat(a.state.model,"/").concat(a.state.id,"/list?page=").concat(a.state.nextPage);M.Get(e).then((function(e){var t,n,c=e.results,r=a.state.nextPage;(t=e.next?a.state.nextPage+1:null,c instanceof Array)?(n=1===r?c:a.state.datasource.concat(c),a.setState({nextPage:t,datasource:n,loading:!1})):a.setState({nextPage:t,loading:!1})})).catch((function(e){console.log(e),a.setState({loading:!1})}))}else console.log("\u5df2\u7ecf\u6ca1\u6709\u66f4\u591a\u65e5\u5fd7\u4fe1\u606f")},a.state={title:a.props.title?a.props.title:"\u64cd\u4f5c\u8bb0\u5f55",showNoContent:!!a.props.showNoContent,id:a.props.id,datasource:[],app:a.props.app,model:a.props.model,nextPage:1,loading:!1},a}return Object(v.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e,t,a){e.id===this.state.id&&t.app===this.state.app&&e.model===this.state.model||this.fetchData()}},{key:"render",value:function(){var e,t,a=this;return this.state.datasource&&(e=this.state.datasource.map((function(e,t){return 3===e.action_flag?c.a.createElement(qe,{key:t,color:"red"},c.a.createElement(Je,{data:e})):c.a.createElement(qe,{key:t},c.a.createElement(Je,{data:e}))}))),this.state.nextPage&&(t=c.a.createElement("div",{className:"more",onClick:function(){return a.fetchData()}},"\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a")),this.state.datasource.length>0?c.a.createElement("div",null,c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,this.state.title)),c.a.createElement("div",{className:"modellogs"},c.a.createElement(Be.a,null,e),t)):this.state.showNoContent?c.a.createElement("div",null,c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,this.state.title)),c.a.createElement("div",{className:"no-content border"},"\u65e0",this.state.title)):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.id!==t.id?{id:e.id,datasource:[],app:e.app,model:e.model,nextPage:1,loading:!1}:null}}]),t}(c.a.Component),We=function(e){var t=e.onResize,a=e.width,r=Object(J.a)(e,["onResize","width"]),l=Object(n.useCallback)((function(e){e.stopPropagation()}),[]);return a?c.a.createElement(p.Resizable,{width:a,height:0,handle:c.a.createElement("span",{className:"react-resizable-handle react-resizable-handle-se",onClick:l}),onResize:t,draggableOpts:{enableUserSelectHack:!1}},c.a.createElement("th",r)):c.a.createElement("th",r)},Ye=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(null),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(1),d=Object(f.a)(m,2),p=d[0],b=d[1],E=Object(n.useState)({}),h=Object(f.a)(E,2),g=h[0],v=h[1],j=Object(n.useState)(0),k=Object(f.a)(j,2),N=k[0],C=k[1],S=Object(n.useState)([]),x=Object(f.a)(S,2),w=x[0],I=x[1],P=Object(n.useState)({}),D=Object(f.a)(P,2),_=D[0],U=D[1],A=Object(n.useState)([]),F=Object(f.a)(A,2),R=F[0],z=F[1];Object(n.useEffect)((function(){0===R.length&&e.columns,z(e.columns)}),[R.length,e.columns]);var L=Object(n.useMemo)((function(){return e.paramsFields?e.paramsFields:[]}),[e.paramsFields]),T=Object(n.useCallback)((function(t){if(e.apiUrlPrefix&&e.apiUrlPrefix===r&&s===e.pageUrlPrefix){var a;t=isNaN(t)||!t?1:parseInt(t,10),a=e.apiUrlPrefix.indexOf("?")>0?"".concat(e.apiUrlPrefix,"&page=").concat(t):"".concat(e.apiUrlPrefix,"?page=").concat(t);var n=e.location.search,c=we(L,n);L.forEach((function(e){var t=c[e];void 0!==t&&null!==t&&"page"!==e&&(a="".concat(a,"&").concat(e,"=").concat(t))})),M.Get(a,{},{}).then((function(e){var a=e.results;Array.isArray(a)?(I(a),C(e.count),b(t)):(K.a.warn("\u83b7\u53d6\u5206\u7c7b\u6587\u7ae0\u5217\u8868\u51fa\u9519"),K.a.warn(JSON.stringify(e)))})).catch((function(e){console.log(e)}))}}),[r,s,L,e.apiUrlPrefix,e.location.search,e.pageUrlPrefix]);Object(n.useEffect)((function(){e.apiUrlPrefix!==r&&e.apiUrlPrefix&&l(e.apiUrlPrefix)}),[r,e.apiUrlPrefix]),Object(n.useEffect)((function(){e.pageUrlPrefix&&e.pageUrlPrefix!==s&&u(e.pageUrlPrefix)}),[s,e.pageUrlPrefix]),Object(n.useEffect)((function(){var t=e.location.search;if(t!==_.locationSearch){var a=we(L,t);v(a),U((function(e){return e.locationSearch=t,e})),r&&e.apiUrlPrefix}else r===e.apiUrlPrefix&&e.pageUrlPrefix===s&&T(g.page)}),[L,e.location,g,_,T,r,e.apiUrlPrefix,e.pageUrlPrefix,s]);var G=Object(n.useCallback)((function(t){var a;a=e.pageUrlPrefix.indexOf("?")>0?"".concat(e.pageUrlPrefix,"&page=1"):"".concat(e.pageUrlPrefix,"?page=1"),t&&(a="".concat(a,"&search=").concat(t)),L.forEach((function(e){if("search"!==e&&"page"!==e){var t=g[e];void 0!==t&&null!==t&&(a="".concat(a,"&").concat(e,"=").concat(t))}})),e.history.push(a)}),[e.pageUrlPrefix,L,e.history,g]),B=Object(n.useCallback)((function(t,a,n){if(s){var c,r=t.current,l=e.filterColumns?e.filterColumns:[],i={};l.forEach((function(e){var t=a[e];i[e]=t?t instanceof Array?t[0]:t:null})),c=s.indexOf("?")>0?"".concat(s,"&page=").concat(r):"".concat(s,"?page=").concat(r),g.search&&(c="".concat(c,"&search=").concat(g.search)),l.forEach((function(e){var t=i[e];t&&(c="".concat(c,"&").concat(e,"=").concat(t))})),n&&n.columnKey&&(c="ascend"===n.order?"".concat(c,"&ordering=").concat(n.columnKey):"".concat(c,"&ordering=-").concat(n.columnKey)),e.history.push(c)}}),[s,e.filterColumns,e.history,g.search]),q=Object(n.useCallback)((function(e){return function(t,a){var n=a.size;z((function(t){var a=Object(ge.a)(t);return a[e]=Object(y.a)({},a[e],{width:n.width}),a}))}}),[]),J=Object(n.useMemo)((function(){return R.map((function(e,t){return Object(y.a)({},e,{onHeaderCell:function(e){return{width:e.width,onResize:q(t)}}})}))}),[R,q]),V=Object(n.useMemo)((function(){return{header:{cell:We}}}),[]),W=Object(n.useMemo)((function(){return e.rightButtons?e.rightButtons:c.a.createElement(H.a,{type:"default",style:{width:100},icon:c.a.createElement(O,{type:"refresh"}),onClick:function(){return T(p)}},"\u5237\u65b0")}),[T,p,e.rightButtons]),Y=Object(n.useCallback)((function(){T(p)}),[T,p]);return Object(n.useEffect)((function(){e.reFreshTimes&&e.reFreshTimes>0&&Y()}),[e.reFreshTimes]),c.a.createElement("div",{className:"base-table"},c.a.createElement(ne.a,{className:"tools"},c.a.createElement(ce.a,{sm:{span:12},xs:{span:24}},c.a.createElement(re.a.Search,{placeholder:g.search?g.search:"search",style:{width:200},onSearch:G,enterButton:!0})),c.a.createElement(ce.a,{sm:{span:12},xs:{span:24},style:{textAlign:"right"}},W)),c.a.createElement(Ne.a,{rowKey:"id",components:V,bordered:!0,columns:J,dataSource:w,pagination:{total:N,current:p},onChange:B}))};var Qe=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)({}),s=Object(f.a)(o,2),m=s[0],d=s[1],p=Object(n.useState)(!1),b=Object(f.a)(p,2),E=b[0],h=b[1],g=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){var t=e.match.params.id;t!==r&&(l(t),function(e){var t="/api/v1/docs/group/".concat(e);M.Get(t).then((function(e){d(e),h(!0),document.title="".concat(e.name,"-\u5206\u7ec4-\u770b\u677f")})).catch((function(e){h(!0),console.log(e)}))}(e.match.params.id))}),[e,r]),Object(n.useEffect)((function(){g([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863\u5206\u7ec4",link:"/docs/group"},{title:"\u8be6\u60c5"}])}),[g]);var v=Object(n.useMemo)((function(){if(m.users_permisson&&m.users_permisson.length>0){var e=m.users_permisson.map((function(e,t){return c.a.createElement(xe.a,{key:e.id,color:e.is_active?"blue":""},e.user,c.a.createElement(Se.a,{type:"vertical"}),e.permission)}));return c.a.createElement("div",{style:{margin:"3px 0"}},e)}return c.a.createElement("span",null,"\u65e0\u7528\u6237")}),[m.users_permisson]),j=Object(n.useMemo)((function(){return["page","search","ordering","parent","level","is_deleted"]}),[e.match.params.id]),y=Object(n.useMemo)((function(){return["is_deleted","parent"]}),[]),k=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){},render:function(e,t){return c.a.createElement(i.b,{to:"/docs/article/".concat(e)},e)},ellipsis:!0,width:50},{title:"\u6807\u9898",dataIndex:"title",key:"title",width:250,ellipsis:!0},{title:"\u7236\u7ea7\u9875\u9762",dataIndex:"parent",key:"parent",width:180,ellipsis:!0,render:function(e,t){return e?c.a.createElement(i.b,{to:"/docs/article/".concat(e.id)},c.a.createElement(O,{type:"link"}),e.title):c.a.createElement("div",null,"---")}},{title:"\u6dfb\u52a0\u8005",dataIndex:"user",key:"user",width:100,ellipsis:!0,sorter:function(){}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"time_added",key:"time_added",width:180,ellipsis:!0,sorter:function(e,t){}},{title:"\u64cd\u4f5c",key:"action",ellipsis:!0,render:function(e,t){return c.a.createElement("div",null,c.a.createElement(i.b,{to:"/docs/article/".concat(t.id)},c.a.createElement(O,{type:"link"}),"\u67e5\u770b\u8be6\u60c5"))}}]}),[]);return E?c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ne.a,{gutter:16},c.a.createElement(ce.a,{xs:{span:24},sm:{span:16},lg:{span:18}},c.a.createElement(ne.a,{className:"title"},c.a.createElement("h4",null,"\u6587\u6863\u5206\u7ec4\u8be6\u60c5")),c.a.createElement("div",{className:"info-property"},c.a.createElement("dl",null,c.a.createElement("dt",null,"\u540d\u79f0"),c.a.createElement("dd",null,m.name)),c.a.createElement("dl",null,c.a.createElement("dt",null,"Code"),c.a.createElement("dd",null,m.code)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u7236\u7ea7\u5206\u7ec4"),c.a.createElement("dd",null,m.parent?m.parent:"---")),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u72b6\u6001"),c.a.createElement("dd",{className:"status"},c.a.createElement(O,{type:m.is_deleted?"close":"check"}))),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u6240\u6709\u8005"),c.a.createElement("dd",null,m.owner)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u7528\u6237"),c.a.createElement("dd",null,v)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u63cf\u8ff0"),c.a.createElement("dd",null,m.description)),m.image&&c.a.createElement("dl",null,c.a.createElement("dt",null),c.a.createElement("dd",null,c.a.createElement("img",{alt:"\u56fe\u7247",src:m.image}))),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u6dfb\u52a0\u65f6\u95f4"),c.a.createElement("dd",null,m.time_added))),c.a.createElement("div",null,c.a.createElement(ne.a,{className:"title"},c.a.createElement("h4",null,"\u6587\u7ae0\u5217\u8868")),c.a.createElement(Ye,{columns:k,filterColumns:y,paramsFields:j,location:e.location,history:e.history,apiUrlPrefix:r?"/api/v1/docs/group/".concat(r,"/articles"):null,pageUrlPrefix:"/docs/group/".concat(r)}))),c.a.createElement(ce.a,{xs:{span:24},sm:{span:8},lg:{span:6}},m.id>0&&c.a.createElement(Ve,{app:"docs",model:"group",id:m.id}))))):c.a.createElement(Ee,{size:"large"})};var $e=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)({}),o=Object(f.a)(i,2),s=o[0],m=o[1],d=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){e.match.params.id!==r&&(l(e.match.params.id),p(e.match.params.id))}),[e.match.params.id,r]);var p=function(e){var t="/api/v1/docs/group/".concat(e);M.Get(t).then((function(e){e.id>0&&m(e)})).catch((function(e){console.log(e),K.a.warn("\u83b7\u53d6\u8be6\u60c5\u6570\u636e\u5931\u8d25",5)}))};return Object(n.useEffect)((function(){d([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863\u5206\u7ec4",link:"/docs/group"},{title:"\u7f16\u8f91"}])}),[d]),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u7f16\u8f91\u5206\u7ec4")),c.a.createElement(He,{data:s,type:"editor",handleSubmit:function(t){var a="/api/v1/docs/group/".concat(r),n=new FormData;for(var c in t){var l=t[c];if("image"===c){if(l instanceof Array)for(var i=0;i<l.length;i++)n.append("image",l[i])}else n.append(c,l)}M.Patch(a,n,{}).then((function(t){t.id>0?(K.a.success("\u4fee\u6539\u5206\u7ec4(id:".concat(t.id,")\u6210\u529f"),5),e.history.push("/docs/group/".concat(t.id))):(K.a.warn("\u4fee\u6539\u5206\u7ec4(id:".concat(t.id,")\u5931\u8d25"),5),K.a.error(JSON.stringify(t),8))})).catch((function(e){console.log(e),K.a.error("\u4fee\u6539\u5206\u7ec4(id:".concat(s.id,")\u51fa\u9519"),5)}))}})))},Xe=function(e){var t=Object(n.useState)(""),a=Object(f.a)(t,2),r=a[0],l=a[1];Object(n.useEffect)((function(){e.match.params.id!==r&&l(e.match.params.id)}),[r,e.match.params.id,l]);var o=Object(n.useMemo)((function(){return["page","search","ordering","parent","level","is_deleted"]}),[e.match.params.id]),s=Object(n.useMemo)((function(){return["is_deleted","parent"]}),[]),u=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){},render:function(e,t){return c.a.createElement(i.b,{to:"/docs/article/".concat(e)},e)},ellipsis:!0,width:50},{title:"\u6807\u9898",dataIndex:"title",key:"title",width:250,ellipsis:!0},{title:"\u7236\u7ea7\u9875\u9762",dataIndex:"parent",key:"parent",width:180,ellipsis:!0,render:function(e,t){return e?c.a.createElement(i.b,{to:"/docs/article/".concat(e.id)},c.a.createElement(O,{type:"link"}),e.title):c.a.createElement("div",null,"---")}},{title:"\u6dfb\u52a0\u8005",dataIndex:"user",key:"user",width:100,ellipsis:!0,sorter:function(){}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"time_added",key:"time_added",width:180,ellipsis:!0,sorter:function(e,t){}},{title:"\u64cd\u4f5c",key:"action",ellipsis:!0,render:function(e,t){return c.a.createElement("div",null,c.a.createElement(i.b,{to:"/docs/article/".concat(t.id)},c.a.createElement(O,{type:"link"}),"\u67e5\u770b\u8be6\u60c5"))}}]}),[]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ne.a,{className:"title"},c.a.createElement("h4",null,"\u6587\u7ae0\u5217\u8868")),c.a.createElement(Ye,{columns:u,filterColumns:s,paramsFields:o,groupID:r,location:e.location,history:e.history,apiUrlPrefix:r?"/api/v1/docs/group/".concat(r,"/articles"):null,pageUrlPrefix:"/docs/group/".concat(r,"/articles")})))},Ze=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={},a}return Object(v.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return c.a.createElement("div",null,"Article\u5217\u8868\u9875")}}]),t}(c.a.Component),et=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={},a}return Object(v.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return c.a.createElement("div",null,"\u6587\u7ae0Comment\u5217\u8868\u9875")}}]),t}(c.a.Component),tt=function(e){var t=Object(n.useMemo)((function(){return["page","search","ordering","parent","is_deleted"]}),[]),a=Object(n.useMemo)((function(){return["is_deleted"]}),[]),r=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){},width:50},{title:"\u7c7b\u578b",dataIndex:"category",key:"category",width:100,ellipsis:!0},{title:"\u5185\u5bb9",dataIndex:"content",key:"content",width:260,ellipsis:!0},{title:"\u7528\u6237",dataIndex:"user",key:"user",width:100},{title:"\u65f6\u95f4",dataIndex:"time_added",key:"time_added",width:180,ellipsis:!0},{title:"\u72b6\u6001",dataIndex:"is_deleted",key:"is_deleted",width:100,render:function(e,t){return e?c.a.createElement("span",{className:"status"},c.a.createElement(O,{type:"close"})):c.a.createElement("span",{className:"status"},c.a.createElement(O,{type:"check"}))},filterMultiple:!1,filters:[{text:"\u6709\u6548",value:"false"},{text:"\u5df2\u5220\u9664",value:"true"}]},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return c.a.createElement("div",null,c.a.createElement("span",null,"-"))}}]}),[]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ne.a,{className:"title"},c.a.createElement("h4",null,"\u8ba8\u8bba\u5217\u8868")),c.a.createElement(Ye,{columns:r,filterColumns:a,paramsFields:t,location:e.location,history:e.history,apiUrlPrefix:"/api/v1/docs/discussion/list",pageUrlPrefix:"/docs/discussion/list"})))},at=(a(269),a(174)),nt=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(null),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(1),d=Object(f.a)(m,2),p=d[0],b=d[1],E=Object(n.useState)({}),h=Object(f.a)(E,2),g=h[0],v=h[1],j=Object(n.useState)(0),y=Object(f.a)(j,2),k=y[0],N=y[1],C=Object(n.useState)(10),S=Object(f.a)(C,2),x=S[0],w=S[1],I=Object(n.useState)({}),P=Object(f.a)(I,2),D=P[0],_=P[1],U=Object(n.useMemo)((function(){return e.paramsFields?e.paramsFields:[]}),[e.paramsFields]);Object(n.useEffect)((function(){e.pageSize&&e.pageSize>0&&w(e.pageSize)}),[e.pageSize]);var A=Object(n.useCallback)((function(t){if(e.apiUrlPrefix&&e.apiUrlPrefix===r&&s===e.pageUrlPrefix){var a;t=isNaN(t)||!t?1:parseInt(t,10),a=e.apiUrlPrefix.indexOf("?")>0?"".concat(e.apiUrlPrefix,"&page=").concat(t):"".concat(e.apiUrlPrefix,"?page=").concat(t),a="".concat(a,"&page_size=").concat(x);var n=e.location.search,c=we(U,n);U.forEach((function(e){var t=c[e];void 0!==t&&null!==t&&"page"!==e&&(a="".concat(a,"&").concat(e,"=").concat(t))})),M.Get(a,{},{}).then((function(a){var n=a.results;Array.isArray(n)?(N(a.count),e.setDataSource(n),b(t)):(K.a.warn("\u83b7\u53d6\u5206\u7c7b\u6587\u7ae0\u5217\u8868\u51fa\u9519"),K.a.warn(JSON.stringify(a)),e.setDataSource([]))})).catch((function(t){console.log(t),e.setDataSource([])}))}}),[r,s,U,e.setDataSource,x,e.location.search]);Object(n.useEffect)((function(){e.apiUrlPrefix!==r&&e.apiUrlPrefix&&l(e.apiUrlPrefix)}),[r,e.apiUrlPrefix]),Object(n.useEffect)((function(){e.pageUrlPrefix&&e.pageUrlPrefix!==s&&u(e.pageUrlPrefix)}),[s,e.pageUrlPrefix]),Object(n.useEffect)((function(){var t=e.location.search;if(t!==D.locationSearch){var a=we(U,t);v(a),_((function(e){return e.locationSearch=t,e})),r&&e.apiUrlPrefix}else r===e.apiUrlPrefix&&e.pageUrlPrefix===s&&A(g.page)}),[U,e.location,g,D,A,r,e.apiUrlPrefix,e.pageUrlPrefix,s]);var F=Object(n.useCallback)((function(t){var a;a=e.pageUrlPrefix.indexOf("?")>0?"".concat(e.pageUrlPrefix,"&page=1"):"".concat(e.pageUrlPrefix,"?page=1"),t&&(a="".concat(a,"&search=").concat(t)),U.forEach((function(e){if("search"!==e&&"page"!==e){var t=g[e];void 0!==t&&null!==t&&(a="".concat(a,"&").concat(e,"=").concat(t))}})),e.history.push(a)}),[e.pageUrlPrefix,U,e.history,g]),R=Object(n.useCallback)((function(t,a){if(s){var n,c=t;n=s.indexOf("?")>0?"".concat(s,"&page=").concat(c):"".concat(s,"?page=").concat(c),g.search&&(n="".concat(n,"&search=").concat(g.search)),e.history.push(n)}}),[s,e.history,g.search]),z=Object(n.useCallback)((function(e,t){w(t)}),[]),L=Object(n.useMemo)((function(){return e.rightButtons?e.rightButtons:c.a.createElement(H.a,{type:"default",style:{width:100},icon:c.a.createElement(O,{type:"refresh"}),onClick:function(){return A(p)}},"\u5237\u65b0")}),[A,p,e.rightButtons]),T=Object(n.useCallback)((function(){A(p)}),[A,p]);Object(n.useEffect)((function(){e.reFreshTimes&&e.reFreshTimes>0&&T()}),[e.reFreshTimes]);var G=Object(n.useMemo)((function(){return e.showTools?c.a.createElement(ne.a,{className:"tools"},c.a.createElement(ce.a,{sm:{span:12},xs:{span:24}},c.a.createElement(re.a.Search,{placeholder:g.search?g.search:"search",style:{width:200},onSearch:F,allowClear:!0,enterButton:!0})),c.a.createElement(ce.a,{sm:{span:12},xs:{span:24},style:{textAlign:"right"}},L)):null}),[F,e.showTools,L,g.search]);return c.a.createElement("div",{className:"pagination"},G,e.children,c.a.createElement(at.a,{current:p,total:k,onChange:R,showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e){return"\u603b\u5171\u6709 ".concat(e," \u6761\u6570\u636e!")},pageSize:x,onShowSizeChange:z}))},ct=function(e){var t=Object(n.useState)([]),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useMemo)((function(){return c.a.createRef()}),[]),o=Object(n.useState)(3),s=Object(f.a)(o,2),u=s[0],m=s[1],d=Object(n.useMemo)((function(){return["page","page_size","search","ordering","parent","is_deleted"]}),[]),p=Object(n.useCallback)((function(e){return c.a.createElement("div",{className:"image-item",key:e.id,style:{display:"inline-block",padding:"15px 10px"}},c.a.createElement("img",{src:e.file,alt:"\u56fe\u7247",style:{maxWidth:200}}))}),[]);Object(n.useEffect)((function(){}),[]);var b=Object(n.useMemo)((function(){return i&&i.current&&m(Math.ceil((i.current.offsetWidth-60)/260)),r.map((function(e,t){return c.a.createElement("div",{className:"image-item",key:e.id},c.a.createElement("img",{src:e.file,alt:"\u56fe\u7247"}))}))}),[r,i]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ne.a,{className:"title"},c.a.createElement("h4",null,"\u56fe\u7247\u5217\u8868")),c.a.createElement(nt,{showTools:!0,paramsFields:d,location:e.location,history:e.history,apiUrlPrefix:"/api/v1/docs/image/list",pageUrlPrefix:"/docs/image/list",setDataSource:l,renderItem:p,pageSize:20},c.a.createElement("div",{className:"images-list",ref:i,style:{columnCount:u}},b))))};var rt=function(e){return c.a.createElement(o.d,null,c.a.createElement(o.b,{exat:!0,path:"/docs/group/list",component:Ue}),c.a.createElement(o.b,{exat:!0,path:"/docs/group/add",component:Ke}),c.a.createElement(o.b,{exat:!0,path:"/docs/group/:id/editor",component:$e}),c.a.createElement(o.b,{exat:!0,path:"/docs/group/:id/articles",component:Xe}),c.a.createElement(o.b,{exat:!0,path:"/docs/group/:id",component:Qe}),c.a.createElement(o.b,{exat:!0,path:"/docs/group",render:function(){return c.a.createElement(o.a,{to:"/docs/group/list",push:!1})}}),c.a.createElement(o.b,{exat:!0,path:"/docs/article/list",component:Ze}),c.a.createElement(o.b,{exat:!0,path:"/docs/article",render:function(){return c.a.createElement(o.a,{to:"/docs/article/list",push:!1})}}),c.a.createElement(o.b,{exat:!0,path:"/docs/comment/list",component:et}),c.a.createElement(o.b,{exat:!0,path:"/docs/comment",render:function(){return c.a.createElement(o.a,{to:"/docs/comment/list",push:!1})}}),c.a.createElement(o.b,{exat:!0,path:"/docs/discussion/list",component:tt}),c.a.createElement(o.b,{exat:!0,path:"/docs/discussion",render:function(){return c.a.createElement(o.a,{to:"/docs/discussion/list",push:!1})}}),c.a.createElement(o.b,{exat:!0,path:"/docs/image/list",component:ct}),c.a.createElement(o.b,{exat:!0,path:"/docs/image",render:function(){return c.a.createElement(o.a,{to:"/docs/image/list",push:!1})}}))},lt=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(a=Object(h.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(c)))).logout=function(){M.Get("http://127.0.0.1:9000/api/v1/account/logout").then((function(e){"success"===e.status&&K.a.success("\u9000\u51fa\u767b\u5f55\u6210\u529f")})).catch((function(e){console.log(e)}))},a}return Object(v.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.logout()}},{key:"render",value:function(){return c.a.createElement(o.a,{to:"/user/login",push:!1})}}]),t}(c.a.Component),it=function(e){var t=Object(n.useState)({}),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useMemo)((function(){return c.a.createRef()}),[]),o=Object(n.useCallback)((function(e){i.current.setFieldsValue(e)}),[i]);Object(n.useEffect)((function(){e.data!==r&&(l(e.data),o(e.data))}),[r,e.data,o]);var s=Object(n.useCallback)((function(t){e.handleSubmit(t)}),[e]),u=Object(n.useMemo)((function(){return{labelCol:{xs:{span:8},sm:{span:8},md:{span:8}},wrapperCol:{xs:{span:12},sm:{span:12},md:{span:12}}}}),[]),m=Object(n.useMemo)((function(){return{wrapperCol:{xs:{span:8,offset:8},sm:{span:8,offset:10}}}}),[]);return c.a.createElement(Fe.a,{name:"userEditForm",onFinish:s,initialValues:r,ref:i},c.a.createElement(ne.a,null,c.a.createElement(ce.a,{xs:24,sm:24},c.a.createElement(Fe.a.Item,Object.assign({},u,{label:"\u7528\u6237\u540d",name:"username"}),c.a.createElement(re.a,{placeholder:"\u7528\u6237\u540d",disabled:!0})),c.a.createElement(Fe.a.Item,Object.assign({},u,{name:"is_active",label:"\u72b6\u6001",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u5f00\u542f\u7528\u6237!"}]}),c.a.createElement(he.a.Group,{size:"small",buttonStyle:"solid"},c.a.createElement(he.a.Button,{value:!0},"\u5f00\u542f"),c.a.createElement(he.a.Button,{value:!1},"\u7981\u7528"))),c.a.createElement(Fe.a.Item,Object.assign({},u,{name:"can_view",label:"\u8bbf\u95ee\u6743\u9650",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u7ed9\u7528\u6237\u8bbf\u95ee\u6743\u9650!"}]}),c.a.createElement(he.a.Group,{size:"small",buttonStyle:"solid"},c.a.createElement(he.a.Button,{value:!0},"\u80fd"),c.a.createElement(he.a.Button,{value:!1},"\u5426"))),c.a.createElement(Fe.a.Item,Object.assign({},u,{label:"\u8d85\u7ea7\u7528\u6237",name:"is_superuser",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u662f\u8d85\u7ea7\u7528\u6237!"}]}),c.a.createElement(he.a.Group,{size:"small",buttonStyle:"solid"},c.a.createElement(he.a.Button,{value:!0},"\u662f"),c.a.createElement(he.a.Button,{value:!1},"\u5426"))),c.a.createElement(Fe.a.Item,Object.assign({},u,{label:"\u624b\u673a\u53f7",name:"mobile",rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7!",max:20}]}),c.a.createElement(re.a,{placeholder:"mobile"})),c.a.createElement(Fe.a.Item,Object.assign({},u,{label:"\u9489\u9489ID",name:"dingding",rules:[]}),c.a.createElement(re.a,{placeholder:"dingding"})),c.a.createElement(Fe.a.Item,Object.assign({},u,{label:"\u5fae\u4fe1ID",name:"wechart"}),c.a.createElement(re.a,{placeholder:"wechart"}))),c.a.createElement(ce.a,{xs:24,sm:24,md:12})),c.a.createElement(Fe.a.Item,m,c.a.createElement(H.a,{type:"primary",htmlType:"submit"},"\u4fee\u6539")))},ot=function(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)({}),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(!1),d=Object(f.a)(m,2),p=d[0],b=d[1];Object(n.useEffect)((function(){e.data!==s&&(u(e.data),b(!1)),e.visible!==r&&(l(e.visible),b(!1))}),[e.visible,e.data,s,r]);var E=Object(n.useCallback)((function(t){K.a.info("\u53d6\u6d88\u7f16\u8f91",3),l(!1),b(!1),e.afterHandler&&e.afterHandler(!1)}),[e]),h=Object(n.useCallback)((function(t){var a="/api/v1/account/user/".concat(s.id);M.Put(a,{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:t}).then((function(t){t.id===s.id?(K.a.success("\u4fee\u6539\u7528\u6237\u4fe1\u606f\u6210\u529f",5),l(!1),b(!1),e.afterHandler&&e.afterHandler()):(K.a.error(JSON.stringify(t),5),b(!1))})).catch((function(e){b(!1),400===e.status?K.a.error(JSON.stringify(e.data),5):K.a.error("\u7f16\u8f91\u51fa\u73b0\u9519\u8bef\uff01",5)}))}),[s.id,e]);return c.a.createElement($.a,{title:"\u7f16\u8f91\u7528\u6237",visible:r,onCancel:E,footer:null},c.a.createElement(it,{data:s,showLoading:p,handleSubmit:h}))},st=function(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(!1),o=Object(f.a)(i,2),s=o[0],m=o[1],d=Object(n.useState)({}),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useState)(0),g=Object(f.a)(h,2),v=g[0],j=g[1],y=Object(n.useContext)(u).setNavData,k=Object(n.useMemo)((function(){return["page","search","ordering","is_active","can_view","is_superuser"]}),[]),N=Object(n.useMemo)((function(){return["is_active","can_view","is_superuser"]}),[]),C=Object(n.useCallback)((function(e){l(!0),E(e)}),[]),S=Object(n.useCallback)((function(e){K.a.error("\u53d6\u6d88\u5220\u9664",3)}),[]),x=Object(n.useCallback)((function(e){var t="/api/v1/account/user/".concat(e.id);M.Delete(t).then((function(t){if(204!==t.status)return 200===t.status||K.a.error("\u5220\u9664".concat(e.username,"\u5931\u8d25"),3),t.json();K.a.success("\u5220\u9664"+e.username+"\u6210\u529f\uff01",3),j((function(e){return e+1}))})).then((function(e){e&&(e.message?K.a.warn(e.message,8):K.a.error(JSON.stringify(e),3))})).catch((function(e){console.log(e)}))}),[]),w=Object(n.useCallback)((function(e){l(!1),E({}),!1!==e&&j((function(e){return e+1}))}),[]),I=Object(n.useCallback)((function(){m((function(e){return!e}))}),[]),P=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){return e.id-t.id}},{title:"\u7528\u6237\u540d",dataIndex:"username",key:"username"},{title:"\u72b6\u6001",dataIndex:"is_active",key:"is_active",render:function(e){return e?c.a.createElement("div",{className:"status"},c.a.createElement(O,{type:"check"})):c.a.createElement("span",{className:"status"},c.a.createElement(O,{type:"close"}))},filters:[{text:"\u542f\u7528",value:"true"},{text:"\u7981\u7528",value:"false"}],filterMultiple:!1,onFilter:function(e,t){return t.is_active.toString()===e}},{title:"\u8bbf\u95ee\u672c\u7ad9",dataIndex:"can_view",key:"can_view",render:function(e){return e?c.a.createElement("div",{className:"status"},c.a.createElement(O,{type:"check"})):c.a.createElement("span",{className:"status"},c.a.createElement(O,{type:"close"}))},filters:[{text:"\u80fd",value:"true"},{text:"\u5426",value:"false"}],filterMultiple:!1,onFilter:function(e,t){return t.is_active.toString()===e}},{title:"\u8d85\u7ea7\u7528\u6237",dataIndex:"is_superuser",key:"is_superuser",render:function(e){return e?c.a.createElement("div",{className:"status"},c.a.createElement(O,{type:"check"})):c.a.createElement("span",{className:"status"},c.a.createElement(O,{type:"close"}))},filters:[{text:"\u8d85\u7ea7\u7528\u6237",value:"true"},{text:"\u666e\u901a\u7528\u6237",value:"false"}],filterMultiple:!1,onFilter:function(e,t){return t.is_superuser.toString()===e}},{title:"\u624b\u673a\u53f7",dataIndex:"mobile",key:"mobile",render:function(e){return e?c.a.createElement("div",{className:"center"},e):c.a.createElement("div",{className:"center"},"---")}},{title:"\u52a0\u5165\u65f6\u95f4",dataIndex:"date_joined",key:"date_joined",sorter:function(e,t){return e.id-t.id}},{title:"Action",key:"action",render:function(e,t){if(s){var a,n=c.a.createElement("span",null,c.a.createElement("p",null,"\u5220\u9664\u7528\u6237\u4e14\u7981\u6b62\u767b\u9646\uff01"),c.a.createElement("p",null,"\u60a8\u786e\u8ba4\u5220\u9664:".concat(e.username,"?")));return a=e.is_active?c.a.createElement(Ce.a,{title:n,onCancel:S,onConfirm:function(){return x(e)}},c.a.createElement("span",{type:"link"},c.a.createElement(H.a,{type:"link",size:"small",danger:!0},c.a.createElement(O,{type:"trash-o"}," \u5220\u9664")))):"\u5df2\u7981\u7528",c.a.createElement("span",null,c.a.createElement("span",{type:"link",onClick:function(){return C(e)}},c.a.createElement(H.a,{type:"link",size:"small"},c.a.createElement(O,{type:"edit"}," \u7f16\u8f91"))),c.a.createElement("span",{className:"ant-divider"}),a)}return e.is_active?c.a.createElement("span",null,c.a.createElement("span",{type:"link",onClick:function(){return C(e)}},c.a.createElement(H.a,{type:"link",size:"small"},c.a.createElement(O,{type:"edit"}," \u7f16\u8f91")))):c.a.createElement("span",null,c.a.createElement("span",{type:"link",onClick:function(){return C(e)}},c.a.createElement(H.a,{type:"link",size:"small"},c.a.createElement(O,{type:"edit"}," \u7f16\u8f91"))),c.a.createElement(Se.a,{type:"vertical"}),"\u5df2\u7981\u7528")}}]}),[S,x,C,s]),D=Object(n.useMemo)((function(){return c.a.createElement("span",null,c.a.createElement(H.a,{type:"dashed",style:{width:100},icon:c.a.createElement(O,{type:"trash-o"}),danger:!0,onClick:I},s?"\u9690\u85cf\u5220\u9664":"\u663e\u793a\u5220\u9664"),c.a.createElement(H.a,{style:{width:100},type:"default",icon:c.a.createElement(O,{type:"refresh"}),onClick:function(){j((function(e){return e+1}))}},"\u5237\u65b0"))}),[I,s]);return Object(n.useEffect)((function(){y([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"},{title:"\u5217\u8868"}])}),[y]),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ne.a,{className:"title"},c.a.createElement("h4",null,"\u7528\u6237\u5217\u8868")),c.a.createElement(Ye,{columns:P,filterColumns:N,paramsFields:k,location:e.location,history:e.history,apiUrlPrefix:"/api/v1/account/user/list",pageUrlPrefix:"/user/list",reFreshTimes:v,rightButtons:D})),c.a.createElement(ot,{visible:r,afterHandler:w,data:b}))},ut=void 0,mt=function(e){var t=Object(n.useState)(0),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useContext)(m).setNavData;Object(n.useEffect)((function(){o([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"},{title:"\u5206\u7ec4",link:"/user/group/list"},{title:"\u5217\u8868"}])}),[o]);var s=Object(n.useCallback)((function(e){var t="/api/v1/account/group/"+e.id;M.Delete(t).then((function(t){if(204===t.status)K.a.success("\u5220\u9664:"+e.name+"\u6210\u529f",3),ut.fetchData(ut.state.currentPage);else try{return t.json()}catch(a){K.a.error("\u5220\u9664:"+e.name+"\u5931\u8d25",3)}})).catch((function(e){console.log(e)}))}),[]),u=Object(n.useCallback)((function(e){K.a.error("\u53d6\u6d88\u5220\u9664",3)}),[]),d=Object(n.useMemo)((function(){return["page","search","ordering","is_active"]}),[]),p=Object(n.useMemo)((function(){return["is_active"]}),[]),b=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",render:function(e,t){return c.a.createElement(i.b,{to:{pathname:"/user/group/"+t.id,state:{data:t}}},e)},sorter:function(e,t){return e.id-t.id}},{title:"\u5206\u7ec4\u540d",dataIndex:"name",key:"name"},{title:"\u7528\u6237",dataIndex:"user_set",key:"user_set",render:function(e){return e.join(", ")}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return c.a.createElement("span",null,c.a.createElement(i.b,{to:{pathname:"/user/group/"+e.id,state:{data:e}}},c.a.createElement(O,{type:"link"}," \u8be6\u60c5")),c.a.createElement("span",{className:"ant-divider"}),c.a.createElement(i.b,{to:{pathname:"/user/group/"+e.id+"/editor",state:{data:e}}},c.a.createElement(O,{type:"edit"}," \u7f16\u8f91")),c.a.createElement("span",{className:"ant-divider"}),c.a.createElement(Ce.a,{title:"\u60a8\u786e\u8ba4\u5220\u9664:"+e.name+"?",onCancel:u,onConfirm:function(){return s(e)}},c.a.createElement("span",null,c.a.createElement(O,{type:"trash-o",danger:!0}," \u5220\u9664"))))}}]}),[u,s]),E=Object(n.useMemo)((function(){return c.a.createElement("span",null,c.a.createElement(H.a,{type:"default",icon:c.a.createElement(O,{type:"refresh"}),onClick:function(){return l((function(e){return e+1}))}},"\u5237\u65b0"),c.a.createElement(i.b,{to:"/user/group/add"},c.a.createElement(H.a,{type:"primary",icon:c.a.createElement(O,{type:"plus"})},"Add")))}),[]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u5206\u7ec4\u5217\u8868")),c.a.createElement(Ye,{columns:b,filterColumns:p,paramsFields:d,location:e.location,history:e.history,apiUrlPrefix:"/api/v1/account/group/list",pageUrlPrefix:"/user/group/list",reFreshTimes:r,rightButtons:E})))},dt=(a(840),a(221)),ft=function(e){var t=Object(n.useState)({}),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)([]),o=Object(f.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)([]),d=Object(f.a)(m,2),p=d[0],b=d[1],E=Object(n.useState)([]),h=Object(f.a)(E,2),g=h[0],v=h[1],O=Object(n.useState)([]),j=Object(f.a)(O,2),y=j[0],k=j[1],N=Object(n.useState)([]),C=Object(f.a)(N,2),S=C[0],x=C[1],w=Object(n.useState)([]),I=Object(f.a)(w,2),P=I[0],D=I[1],_=Object(n.useMemo)((function(){return c.a.createRef()}),[]);Object(n.useEffect)((function(){e.data!==r?(l(e.data),e.data.user_set&&v(e.data.user_set),e.data.permissions&&D(e.data.permissions)):_.current.setFieldsValue(r)}),[e.data,r,_]);var U=Object(n.useCallback)((function(t){t.user_set=g,t.permissions=P,e.handleSubmit(t)}),[e,g,P]),A=Object(n.useCallback)((function(){M.Get("/api/v1/account/user/all").then((function(e){if(e instanceof Array){var t=e.map((function(e){return{key:e.id,title:e.username}}));u(t)}})).catch((function(e){console.log(e)}))}),[]),F=Object(n.useCallback)((function(){M.Get("/api/v1/account/permission/all").then((function(e){if(e instanceof Array){var t=e.map((function(e){return{key:e.id,title:"".concat(e.codename,"\u3010").concat(e.app_model,"\u3011")}}));k(t)}})).catch((function(e){console.log(e)}))}),[]);Object(n.useEffect)((function(){A(),F()}),[F,A]);var R=Object(n.useCallback)((function(e,t){b([].concat(Object(ge.a)(e),Object(ge.a)(t)))}),[]),z=Object(n.useCallback)((function(e,t){x([].concat(Object(ge.a)(e),Object(ge.a)(t)))}),[]),L=Object(n.useCallback)((function(e,t,a){v(e)}),[]),T=Object(n.useCallback)((function(e,t,a){D(e)}),[]),G=Object(n.useMemo)((function(){return"editor"===e.type?"\u4fee\u6539":"\u6dfb\u52a0"}),[e.type]),K=Object(n.useMemo)((function(){return{labelCol:{xs:{span:24},sm:{span:5},md:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15},md:{span:14}}}}),[]),B=Object(n.useMemo)((function(){return{wrapperCol:{offset:8,span:16}}}),[]),q=Object(n.useMemo)((function(){return{labelCol:{xs:{span:24},sm:{span:0},md:{span:0}},wrapperCol:{xs:{span:24,offset:0},sm:{span:18,offset:3},md:{span:16,offset:4}}}}),[]);return c.a.createElement(Fe.a,{ref:_,onFinish:U,initialValues:r},c.a.createElement(ne.a,null,c.a.createElement(ce.a,{xs:24,sm:24,md:24},c.a.createElement(Fe.a.Item,Object.assign({},K,{label:"\u5206\u7ec4\u540d",name:"name",rules:[{required:!0,message:"Please input group name!"}]}),c.a.createElement(re.a,{placeholder:"name"})),c.a.createElement(Fe.a.Item,Object.assign({},q,{name:"user_set",label:""}),c.a.createElement("div",null,c.a.createElement(dt.a,{listStyle:{maxWidth:300,width:"43%",minHeight:250,overflow:"auto"},dataSource:s,targetKeys:g,selectedKeys:p,onChange:L,onSelectChange:R,titles:["\u6240\u6709\u7528\u6237","\u7ec4\u6210\u5458"],showSearch:!0,render:function(e){return e.title}}))),c.a.createElement(Fe.a.Item,Object.assign({},q,{name:"permissions"}),c.a.createElement("div",null,c.a.createElement(dt.a,{listStyle:{maxWidth:300,width:"43%",minHeight:250,overflow:"auto"},dataSource:y,targetKeys:P,selectedKeys:S,onChange:T,onSelectChange:z,titles:["\u6240\u6709\u6743\u9650","\u7ec4\u6743\u9650"],showSearch:!0,render:function(e){return e.title}}))),c.a.createElement(Fe.a.Item,B,c.a.createElement(H.a,{type:"primary",htmlType:"submit"},G)))),c.a.createElement(ne.a,{className:"center"}))},pt=function(e){var t=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){t([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"},{title:"\u5206\u7ec4",link:"/user/group/list"},{title:"\u6dfb\u52a0"}])}),[t]);var a=Object(n.useCallback)((function(t){M.Post("/api/v1/account/group/create",{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:t}).then((function(t){t.id>0?e.history.push("/user/group/"+t.id):K.a.error(JSON.stringify(t),8)})).catch((function(e){console.log(e)}))}),[e.history]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6dfb\u52a0\u7528\u6237\u7ec4")),c.a.createElement("div",{className:"wrap"},c.a.createElement(ft,{handleSubmit:a}))))},bt=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)({}),o=Object(f.a)(i,2),s=o[0],m=o[1],d=Object(n.useState)(!1),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){h([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"},{title:"\u5206\u7ec4",link:"/user/group/list"},{title:"\u7f16\u8f91"}])}),[h]);var g=Object(n.useCallback)((function(e){M.Get("/api/v1/account/group/"+e+"/editor").then((function(e){m(e),E(!0)})).catch((function(e){console.log(e),E(!0)}))}),[]);Object(n.useEffect)((function(){e.match.params.id&&e.match.params.id!==r&&(l(e.match.params.id),g(e.match.params.id))}),[g,r,e.match.params.id]);var v=Object(n.useCallback)((function(t){M.Put("/api/v1/account/group/"+r,{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:t}).then((function(t){t.id>0?e.history.push("/user/group/"+r):K.a.error(JSON.stringify(t),8)})).catch((function(e){console.log(e)}))}),[r,e.history]);return b?c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u7f16\u8f91\u7528\u6237\u7ec4")),c.a.createElement("div",{className:"wrap"},c.a.createElement(ft,{handleSubmit:v,data:s,type:"editor"})))):c.a.createElement(Ee,null)},Et=function(e){var t=Object(n.useContext)(u).setNavData,a=Object(n.useState)(null),r=Object(f.a)(a,2),l=r[0],i=r[1],o=Object(n.useState)({}),s=Object(f.a)(o,2),m=s[0],d=s[1],p=Object(n.useState)(!1),b=Object(f.a)(p,2),E=b[0],h=b[1];Object(n.useEffect)((function(){t([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"},{title:"\u5206\u7ec4",link:"/user/group/list"},{title:"\u8be6\u60c5"}])}),[t]);var g=Object(n.useCallback)((function(e){M.Get("/api/v1/account/group/"+e).then((function(e){d(e),h(!0)})).catch((function(e){console.log(e),h(!0)}))}),[]);return Object(n.useEffect)((function(){e.match.params.id&&e.match.params.id!==l&&(i(e.match.params.id),g(e.match.params.id))}),[g,l,e.match.params.id]),E?c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ne.a,{gutter:16},c.a.createElement(ce.a,{xs:{span:24},sm:{span:16}},c.a.createElement(ne.a,{className:"title"},c.a.createElement("h4",null,"\u7528\u6237\u7ec4\u8be6\u60c5")),c.a.createElement("div",{className:"info-property"},c.a.createElement("dl",null,c.a.createElement("dt",null,"\u540d\u79f0"),c.a.createElement("dd",null,m.name)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u6240\u6709\u7528\u6237"),c.a.createElement("dd",null,m.user_set?m.user_set.join(", "):null)))),c.a.createElement(ce.a,{xs:24,sm:8},c.a.createElement(Ve,{app:"auth",model:"group",id:l}))))):c.a.createElement(Ee,null)},ht=(a(217),a(90)),gt=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(0),s=Object(f.a)(o,2),u=s[0],m=s[1];Object(n.useEffect)((function(){e.match.params.type!==r&&(l(e.match.params.type),r&&m((function(e){return e+1})))}),[e.match.params.type,r]);var d=Object(n.useCallback)((function(e){var t="/api/v1/account/message/"+e.id;M.Delete(t).then((function(t){204===t.status?(K.a.success("\u5220\u9664\u6d88\u606f(ID:"+e.id+")\u6210\u529f",3),m((function(e){return e+1}))):K.a.error("\u5220\u9664\u6d88\u606f(ID:"+e.id+")\u5931\u8d25",3)})).catch((function(e){console.log(e)}))}),[]),p=Object(n.useCallback)((function(e){K.a.error("\u53d6\u6d88\u5220\u9664",3)}),[]),b=Object(n.useMemo)((function(){return["page","search","ordering","scope"]}),[]),E=Object(n.useMemo)((function(){return["unread","scope","user"]}),[]),h=Object(n.useMemo)((function(){return[{titel:"ID",dataIndex:"id",key:"id",sorter:function(){}},{title:"\u6807\u9898",dataIndex:"title",key:"title",render:function(e,t){return c.a.createElement(i.b,{to:{pathname:"/user/message/"+t.id,state:{data:t}},style:{textAlign:"left"}},t.unread?c.a.createElement(ht.a,{status:"default",color:"cyan"}):c.a.createElement(ht.a,{status:"default",style:{visibility:"hidden"}}),e)}},{title:"\u65f6\u95f4",dataIndex:"time_added",key:"time_added",sorter:function(){}},{title:"\u6d88\u606f\u5206\u7c7b",dataIndex:"scope",key:"scope"},{title:"\u5df2\u8bfb",dataIndex:"unread",key:"unread",render:function(e){return e?c.a.createElement("span",{className:"status"},c.a.createElement(O,{type:"close"})):c.a.createElement("div",{className:"status"},c.a.createElement(O,{type:"check"}))}},{title:"Action",key:"action",render:function(e,t){return c.a.createElement("span",null,c.a.createElement(i.b,{to:{pathname:"/user/message/"+e.id,state:{data:e}}},c.a.createElement(O,{type:"link"}," \u8be6\u60c5")),c.a.createElement("span",{className:"ant-divider"}),c.a.createElement(Ce.a,{title:"\u60a8\u786e\u8ba4\u5220\u9664:"+e.id+"?",onCancel:p,onConfirm:function(){return d(e)}},c.a.createElement("span",null,c.a.createElement(O,{type:"trash-o",danger:!0}," \u5220\u9664"))))}}]}),[p,d]),g=Object(n.useMemo)((function(){return"all"===e.match.params.type?"/api/v1/account/message/list":"unread"===e.match.params.type?"/api/v1/account/message/list?unread=true":"/api/v1/account/message/list?unread=0"}),[e.match.params.type]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6d88\u606f\u5217\u8868")),c.a.createElement(Ye,{columns:h,filterColumns:E,paramsFields:b,location:e.location,history:e.history,apiUrlPrefix:g,pageUrlPrefix:"/user/message/".concat(r),reFreshTimes:u})))},vt=function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)({}),s=Object(f.a)(o,2),m=s[0],d=s[1],p=Object(n.useState)(!1),b=Object(f.a)(p,2),E=b[0],h=b[1],g=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){g([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"},{title:"\u6d88\u606f",link:"/user/message/list"},{title:"\u8be6\u60c5"}])}),[g]);var v=Object(n.useCallback)((function(e){M.Get("/api/v1/account/message/"+e).then((function(e){d(e),h(!0)})).catch((function(e){console.log(e),h(!0)}))}),[]);Object(n.useEffect)((function(){e.match.params.id!==r&&(l(e.match.params.id),v(e.match.params.id))}),[e.match,v,r]);var O=Object(n.useMemo)((function(){return m.link?c.a.createElement(i.b,{to:m.link},m.link):null}),[m]);return E?c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"message"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"title"},c.a.createElement("h2",null,m.title)),c.a.createElement("div",{className:"meta"},c.a.createElement("span",null,"\u6d88\u606f\u7c7b\u578b: ",m.scope),c.a.createElement("span",null,"\u53d1\u9001\u8005: ",m.sender),c.a.createElement("span",null,"\u65f6\u95f4: ",m.time_added))),c.a.createElement("div",{className:"body"},m.content,c.a.createElement("br",null),O)))):c.a.createElement(Ee,null)},Ot=function(e){var t=Object(n.useState)(0),a=Object(f.a)(t,2),r=a[0],l=a[1],s=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){s([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"},{title:"\u6d88\u606f\u4e2d\u5fc3",link:"/user/message/list"}])}),[s]);var m=Object(n.useCallback)((function(e){l("-1"===e?function(e){return e-1}:e)}),[]);return c.a.createElement(ne.a,{style:{display:"flex",minHeight:"100%",overflow:"auto"}},c.a.createElement(ce.a,{span:4,className:"right-nav"},c.a.createElement("div",{className:"nav-title"},c.a.createElement("h3",null,"\u6d88\u606f\u4e2d\u5fc3")),c.a.createElement("ul",{className:"right-nav-ul"},c.a.createElement("li",null,c.a.createElement(i.c,{activeClassName:"active",to:"/user/message/all"},"\u5168\u90e8\u6d88\u606f")),c.a.createElement("li",null,c.a.createElement(i.c,{activeClassName:"active",to:"/user/message/unread"},c.a.createElement(ht.a,{count:r,offset:[15,-5]},c.a.createElement("span",null,"\u672a\u8bfb\u6d88\u606f")))),c.a.createElement("li",null,c.a.createElement(i.c,{activeClassName:"active",to:"/user/message/read"},"\u5df2\u8bfb\u6d88\u606f")))),c.a.createElement(ce.a,{style:{listStyle:"inline-block",flex:1}},c.a.createElement(o.d,null,c.a.createElement(o.b,{exat:!0,path:"/user/message/:type(all|unread|read)",render:function(e){return c.a.createElement(gt,Object.assign({},e,{updateUnReadCount:m}))}}),c.a.createElement(o.b,{exat:!0,path:"/user/message/:id(\\d+)",component:vt}),c.a.createElement(o.b,{exat:!0,path:"/user/message",render:function(){return c.a.createElement(o.a,{to:"/user/message/all",push:!1})}}))))},jt=(a(140),a(52)),yt=(a(843),a(310)),kt=function(e){var t=Object(n.useState)([]),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(!1),s=Object(f.a)(o,2),u=s[0],m=s[1],d=Object(n.useState)(!1),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useCallback)((function(){if(!u){m(!0);M.Get("/api/v1/docs/group/list").then((function(e){var t=e.results;t instanceof Array&&(l(t),E(!0))})).catch((function(e){console.log(e),m(!1)}))}}),[]);Object(n.useEffect)((function(){0!==r.length||b||h()}),[r.length,h,b]);var g=Object(n.useMemo)((function(){return r.map((function(e,t){return c.a.createElement(ce.a,{xs:{span:24},sm:{span:12},md:{span:12},lg:{span:8},className:"info-item",key:t},c.a.createElement(yt.a,{title:e.name,bordered:!0},c.a.createElement("div",{className:"info"},c.a.createElement("div",{className:"row"},c.a.createElement("span",{className:"config"},"\u540d\u79f0:"),c.a.createElement("span",{className:"value"},c.a.createElement(i.b,{to:"/docs/group/".concat(e.id)},e.name))),c.a.createElement("div",{className:"row"},c.a.createElement("span",{className:"config"},"\u4ee3\u7801:"),c.a.createElement("span",{className:"value"},e.code))),c.a.createElement("div",{className:"buttons"},c.a.createElement("div",{className:"button"},c.a.createElement(i.b,{to:"/docs/group/".concat(e.id)},"\u67e5\u770b\u8be6\u60c5")),c.a.createElement("div",{className:"button"},c.a.createElement(i.b,{to:"/docs/group/".concat(e.id,"/articles")},"\u67e5\u770b\u6587\u7ae0")))))}))}),[r]);return b?0===r.length?c.a.createElement("div",{className:"no-content border"},"\u60a8\u8fd8\u6ca1\u6709\u4efb\u4f55\u5de5\u4f5c\u533a\u4fe1\u606f"):c.a.createElement("div",{className:"usercenter position-relative"},c.a.createElement(ne.a,{gutter:8},g),c.a.createElement("div",{className:"add bottom-right"},c.a.createElement(i.b,{to:"/docs/group/add"},c.a.createElement(jt.a,{title:"\u6dfb\u52a0\u5de5\u4f5c\u7ec4",placement:"bottom"},c.a.createElement("div",null,c.a.createElement(O,{type:"plus",noMarginRight:!0})))))):c.a.createElement("div",{className:"usercenter"},c.a.createElement(Ee,null))},Nt=function(e){var t=Object(n.useState)(0),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)([{name:"\u5168\u90e8",id:0}]),s=Object(f.a)(o,2),u=s[0],m=s[1],d=Object(n.useState)([]),p=Object(f.a)(d,2),b=p[0],E=p[1],h=Object(n.useState)(!0),g=Object(f.a)(h,2),v=g[0],O=g[1],j=Object(n.useCallback)((function(){M.Get("/api/v1/docs/group/all",{},{}).then((function(e){Array.isArray(e)?m([{name:"\u5168\u90e8",id:0}].concat(Object(ge.a)(e))):K.a.warn(JSON.stringify(e),5)})).catch((function(e){console.log(e),K.a.error("\u83b7\u53d6\u5206\u7ec4\u5217\u8868\u51fa\u9519\uff01",5)}))}),[]),y=Object(n.useCallback)((function(e){var t="/api/v1/docs/article/list?ordering=-time_added";O(!0),e>0&&(t="".concat(t,"&group=").concat(e)),M.Get(t,{},{}).then((function(e){O(!1);var t=e.results;Array.isArray(t)?E(t):K.a.warn(JSON.stringify(e),5)})).catch((function(e){console.log(e),O(!1)}))}),[]);Object(n.useEffect)((function(){j()}),[j,y]),Object(n.useEffect)((function(){y(r)}),[r,y]);var k=Object(n.useMemo)((function(){return u.map((function(e,t){return c.a.createElement(xe.a.CheckableTag,{checked:r===e.id,onChange:function(){return l(e.id)},key:e.id},e.name)}))}),[r,u]),N=Object(n.useMemo)((function(){return b.map((function(e,t){return c.a.createElement("div",{className:"article-item",key:e.id},e.cover&&c.a.createElement(i.b,{to:"/docs/article/".concat(e.id)},c.a.createElement("div",{className:"cover"},c.a.createElement("img",{src:e.cover,alt:"\u5c01\u9762"}))),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"title"},c.a.createElement(i.b,{to:"/docs/article/".concat(e.id)},c.a.createElement("h2",null,e.title))),c.a.createElement("div",{className:"metadata"},c.a.createElement("span",{className:"item"},"\u65f6\u95f4: ",e.time_added),c.a.createElement("span",{className:"item"},"\u4f5c\u8005: ",e.user)),!!e.description&&c.a.createElement("div",{className:"description"},e.description)))}))}),[b]);return c.a.createElement("div",{className:"articles"},c.a.createElement("div",{className:"tags-list"},c.a.createElement("div",{className:"list"},k)),c.a.createElement(be.a,{spinning:v},c.a.createElement("div",{className:"articles-list"},N)))},Ct=(a(845),a(311)),St=function(e){var t=Object(n.useState)({}),a=Object(f.a)(t,2),r=a[0],l=a[1];Object(n.useEffect)((function(){e.data===r||r.id||l(e.data)}),[r,e.data]);var i,o=Object(n.useCallback)((function(e){e&&M.Get("/api/v1/account/message/"+e).then((function(e){})).catch((function(e){console.log(e)}))}),[]),s=Object(n.useCallback)((function(){var e,t=r;return t.link&&(e=c.a.createElement("a",{href:t.link},"\u67e5\u770b\u8be6\u60c5")),c.a.createElement("div",{className:"message"},c.a.createElement("div",{className:"meta"},c.a.createElement("span",{className:"meta-item"},"\u6d88\u606f\u7c7b\u578b:",t.scope),c.a.createElement("span",{className:"meta-item"},"\u53d1\u9001\u65f6\u95f4:",t.time_added)),c.a.createElement("div",{className:"content"},t.content,e))}),[r]),u=Object(n.useCallback)((function(){r.unread&&(o(r.id),l((function(e){return e.unread=!1,e})));var e={message:r.title,description:s(),duration:4,top:45};Ct.a.open(e)}),[r.id,r.title,r.unread,o,s]);return i=r.unread?c.a.createElement(ht.a,{status:"default",color:"cyan"}):c.a.createElement(ht.a,{status:"default",color:"#dfdfdf"}),c.a.createElement("div",{className:"item",onClick:u},i,r.title)},xt=function(e){var t,a,r=Object(n.useState)(!1),l=Object(f.a)(r,2),o=l[0],s=l[1],m=Object(n.useState)([]),d=Object(f.a)(m,2),p=d[0],b=d[1],E=Object(n.useContext)(u).history,h=Object(n.useCallback)((function(){M.Get("/api/v1/account/message/list").then((function(e){var t=e.results;if(t instanceof Array){var a=!!e.next;s(a),b(t)}}))}),[]);Object(n.useEffect)((function(){0===p.length&&h()}),[h,p.length]),t=p.map((function(e,t){return c.a.createElement(St,{data:e,key:t,history:E})}));var g=Object(n.useMemo)((function(){return o?c.a.createElement("div",{className:"more"},c.a.createElement(i.b,{className:"",to:"/user/message/all"},"\u67e5\u770b\u66f4\u591a")):null}),[o]);return a=t.length>0?c.a.createElement("div",{className:"inner"},c.a.createElement("ul",{className:"list"},t),g):c.a.createElement("div",{className:"no-content"},"\u6682\u65e0\u6d88\u606f"),c.a.createElement("div",{className:"panel"},c.a.createElement("div",{className:"header"},"\u6d88\u606f\u5217\u8868"),a)},wt=function(e){var t=Object(n.useContext)(u).setNavData;return Object(n.useEffect)((function(){t([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237\u4e2d\u5fc3"}])}),[t]),c.a.createElement(ne.a,{className:"content"},c.a.createElement(ce.a,{xs:{span:24},sm:{span:24},md:{span:16},lg:{span:18},className:"main"},c.a.createElement("div",{className:"title position-relative"},c.a.createElement("h4",null,"\u5de5\u4f5c\u533a"),c.a.createElement("div",{className:"right"},c.a.createElement(i.b,{to:"/docs/group/list"},"more ",c.a.createElement(O,{type:"angle-double-right"})))),c.a.createElement("div",null,c.a.createElement(kt,e)),c.a.createElement("div",{className:"latest-articles"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6700\u65b0\u6587\u7ae0")),c.a.createElement(Nt,null))),c.a.createElement(ce.a,{xs:{span:24},sm:{span:24},md:{span:16},lg:{span:6},className:"sidebar"},c.a.createElement(xt,null)))};var It=function(e){return c.a.createElement(o.d,null,c.a.createElement(o.b,{exat:!0,path:"/user/list",component:st}),c.a.createElement(o.b,{exat:!0,path:"/user/logout",component:lt}),c.a.createElement(o.b,{exat:!0,path:"/user/group/list",component:mt}),c.a.createElement(o.b,{exat:!0,path:"/user/group/add",component:pt}),c.a.createElement(o.b,{exat:!0,path:"/user/group/:id/editor",component:bt}),c.a.createElement(o.b,{exat:!0,path:"/user/group/:id",component:Et}),c.a.createElement(o.b,{exat:!0,path:"/user/group",render:function(){return c.a.createElement(o.a,{to:"/user/group/list",push:!1})}}),c.a.createElement(o.b,{exat:!0,path:"/user/message",component:Ot}),c.a.createElement(o.b,{exat:!0,path:"/user",component:wt}),c.a.createElement(o.b,{exat:!0,path:"/user",render:function(){return c.a.createElement(o.a,{to:"/user/list",push:!1})}}))},Pt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).onIconSpinClick=function(){a.state.spin?a.setState({spin:!1}):a.setState({spin:!0})},a.state={iconType:"refresh fa-5x",spin:!1},a}return Object(v.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{style:{margin:"100px",marginTop:"15%",border:"1px solid #999",padding:10,textAlign:"center",borderRadius:5}},c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"logo",style:{width:250,backgroundColor:"#4A90E2",padding:10}},c.a.createElement("img",{src:"https://www.codelieche.com/static/images/logo.svg",className:"App-logo",alt:"logo"})),c.a.createElement("span",{style:{padding:20,backgroundColor:"#f9f9f9",display:"block"}},"Hello React.js",c.a.createElement("br",null),c.a.createElement(H.a,{onClick:M.testFetch},"\u6309\u94ae"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("i",{className:"fa fa-camera-retro fa-5x"}),c.a.createElement("br",null),c.a.createElement(H.a,{onClick:this.onIconSpinClick},"Loding"),c.a.createElement(O,{type:this.state.iconType,spin:this.state.spin}))))}}]),t}(c.a.Component);var Mt=function(e){var t=c.a.useState(140),a=Object(f.a)(t,2),n=a[0],r=a[1];return c.a.createElement(p.Resizable,{className:"box",axis:"x",height:0,width:n,onResize:function(e,t){t.element;var a=t.size;console.log(a),r(a.width)}},c.a.createElement("div",{style:{width:n+"px",borderRight:"1px solid #eee"}},c.a.createElement("span",{className:"text"},"Raw use of <Resizable> element. 200x200, no constraints.")))};c.a.Component;var Dt=function(){var e=Object(n.useState)(!1),t=Object(f.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)([]),i=Object(f.a)(l,2),o=i[0],s=i[1];return c.a.createElement("div",null,"This Is Test Page Function",c.a.createElement("br",null),c.a.createElement("p",null,"Resize"),c.a.createElement(Mt,null),c.a.createElement("p",null,"\u4e0a\u4f20\u56fe\u7247"),c.a.createElement("div",{style:{padding:10,margin:10,minHeight:150,border:"1px solid #f5f5f5"}},c.a.createElement(oe,{url:"",fileListData:o,setFileListData:s,tooltip:c.a.createElement("div",{style:{color:"#999",fontSize:12}},"\u8bf7\u9009\u62e9\u8981\u4e0a\u4f20\u7684\u56fe\u7247")})),c.a.createElement(se,null),c.a.createElement("hr",null),c.a.createElement(H.a,{onClick:function(){r((function(e){return!e}))}},"\u4e0a\u4f20\u56fe\u7247"),c.a.createElement(ue,{visible:a,handleAfterClose:function(){return r(!1)},afterUploadHandle:function(e){console.log("\u4e0a\u4f20\u4e86\u56fe\u7247\uff1a",e),r(!1)}}))},_t=function(e){return c.a.createElement(fe,{content:"> good"})},Ut=function(e){function t(){return Object(b.a)(this,t),Object(h.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return c.a.createElement(o.d,null,c.a.createElement(o.b,{exat:!0,path:"/test/test",component:Dt}),c.a.createElement(o.b,{exat:!0,path:"/test/page",component:Pt}),c.a.createElement(o.b,{exat:!0,path:"/test/editor",component:_t}))}}]),t}(c.a.Component);var At=function(e){var t=Object(n.useState)("align-justify"),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useContext)(u).navData,s=Object(n.useCallback)((function(t){t.preventDefault(),e.setShowLeftSider((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[e]);return c.a.createElement("div",{className:"right-content"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"toogle",onClick:s,onMouseEnter:function(e){l("angle-double-right")},onMouseLeave:function(e){l("align-justify")},style:{display:e.showLeftSider?"none":"inline-block"}},c.a.createElement(O,{type:r})),c.a.createElement(F,{data:i}),c.a.createElement("div",{className:"user"},c.a.createElement(L,null))),c.a.createElement("div",{className:"container"},c.a.createElement(o.d,null,c.a.createElement(o.b,Object.assign({path:"/docs/article/:id",component:ke},e)),c.a.createElement(o.b,{path:"/docs/",component:rt,location:e.location}),c.a.createElement(o.b,{path:"/user",component:It,location:e.location}),c.a.createElement(o.b,{path:"/test",component:Ut,location:e.location}))),c.a.createElement(T,null))};var Ft=function(e){var t,a=Object(n.useState)(!1),r=Object(f.a)(a,2),l=r[0],i=r[1],o=Object(n.useState)(0),s=Object(f.a)(o,2),m=s[0],p=s[1],b=Object(n.useState)([{title:"\u9996\u9875",icon:"home",link:"/"}]),E=Object(f.a)(b,2),h=E[0],g=E[1];return Object(n.useEffect)((function(){var t=localStorage.getItem("showLeftSider");null!==t?(t!==l.toString()&&i("true"===t),"/"===e.location.pathname&&(document.title="\u770b\u677f-\u9996\u9875",h.length>1&&g([{title:"\u9996\u9875",icon:"home",link:"/"}]))):i(!0)}),[h.length,e.location.pathname,l]),l&&(t=c.a.createElement(U,{showLeftSider:l,setShowLeftSider:i,refreshNavTimes:m,defaultOpenKey:e.defaultOpenKey})),c.a.createElement(u.Provider,{value:{navData:h,setNavData:g,history:e.history,refreshNavTimes:m,setRefreshNavTimes:p}},c.a.createElement(d.a,{className:"left-right-layout"},t,c.a.createElement(d.a,null,c.a.createElement(d.a.Content,null,c.a.createElement(At,Object.assign({},e,{showLeftSider:l,setShowLeftSider:i}))))))},Rt=function e(t){var a=t.item,r=t.index,l=t.activeNavIDs,o=t.canWrite,s=Object(n.useState)(!1),m=Object(f.a)(s,2),d=m[0],p=m[1],b=Object(n.useState)(!1),E=Object(f.a)(b,2),h=E[0],g=E[1],v=Object(n.useContext)(u),j=v.history,y=v.setRefreshNavTimes,k=a.children.map((function(t,a){return c.a.createElement(e,{item:t,index:a,key:a,activeNavIDs:l,canWrite:o})})),N=Object(n.useCallback)((function(e){p((function(e){return!e}))}),[]);Object(n.useEffect)((function(){var e=l.indexOf(a.id)>=0;e!==h&&g(e)}),[l,h,a.id]);var C=Object(n.useCallback)((function(e){e.stopPropagation(),e.preventDefault();var t={parent:a.id,group:a.group};M.Post("/api/v1/docs/article/create",{},{data:t}).then((function(e){if(e.id>0){y((function(e){return e+1}));var t="/docs/article/".concat(e.id);j.push(t)}else console.log("\u521b\u5efa\u6587\u7ae0\u5931\u8d25")})).catch((function(e){console.log(e)}))}),[j,a,y]);return c.a.createElement("div",{key:r,className:"nav"},c.a.createElement("div",{className:"item"},c.a.createElement(i.c,{to:"/docs/article/".concat(a.id),activeClassName:"active"},c.a.createElement("div",{className:"title",style:{paddingLeft:12*a.level},onClick:N},k.length>0&&c.a.createElement(O,{type:d||h?"caret-down":"caret-right"}),a.title?a.title:c.a.createElement("span",{className:"no-title"},"\u65e0\u6807\u9898"),o&&c.a.createElement("div",{className:"add",onClick:C},c.a.createElement(O,{type:"plus-square-o"})))),k.length>0&&c.a.createElement("div",{className:d||h?"children active":"children"},k)))},zt=function(e){var t=e.group,a=Object(n.useState)(null),r=Object(f.a)(a,2),l=r[0],i=r[1],o=Object(n.useContext)(u),s=o.navData,m=o.refreshNavTimes,d=o.currentArticleGroupID,p=o.groupPermissions,b=o.setGroupPermissions,E=Object(n.useState)([]),h=Object(f.a)(E,2),g=h[0],v=h[1],O=Object(n.useState)(0),j=Object(f.a)(O,2),y=j[0],k=j[1],N=Object(n.useState)(!1),C=Object(f.a)(N,2),S=C[0],x=C[1],w=Object(n.useCallback)((function(e,t){if(i(e),t&&k((function(e){return e++})),e){var a="/api/v1/docs/article/all?group=".concat(e);M.Get(a,{},{}).then((function(e){Array.isArray(e)?v(e):K.a.warn("\u83b7\u53d6\u6587\u7ae0\u5217\u8868\u6570\u636e\u51fa\u9519:"+JSON.stringify(e))})).catch((function(e){console.log(e)}))}}),[]),I=Object(n.useMemo)((function(){var e=[];return s.forEach((function(t){t.id&&t.id>0&&e.push(t.id)})),e}),[s]);Object(n.useEffect)((function(){t!==l?w(t):y<=m&&w(t,!0)}),[l,t,w,y,m]);var P=Object(n.useCallback)((function(e){var t="/api/v1/docs/group/".concat(e,"/permissions");M.Get(t,{},{}).then((function(e){Array.isArray(e)&&b(e)})).catch((function(e){console.log(e)}))}),[b]);Object(n.useEffect)((function(){d>0&&P(d)}),[d,P]),Object(n.useEffect)((function(){p.indexOf("write")>=0?x(!0):x(!1)}),[p]);var D;return D=g.map((function(e,t){return c.a.createElement(Rt,{item:e,index:t,key:t,activeNavIDs:I,canWrite:S})})),c.a.createElement("div",{className:"articles"},D)};var Lt=function(e){var t=e.showLeftSider,a=e.setShowLeftSider,r=Object(n.useState)([]),l=Object(f.a)(r,2),o=l[0],s=l[1],m=Object(n.useState)({}),b=Object(f.a)(m,2),E=b[0],h=b[1],g=Object(n.useContext)(u),v=g.setRefreshNavTimes,j=g.history,y=g.currentArticleGroupID,k=g.setCurrentArticleGroupID,N=Object(n.useMemo)((function(){var e=localStorage.getItem("leftSiderWidth"),t=parseInt(e);return t&&t>=156&&t<=460?t:200}),[]),C=Object(n.useState)(N),S=Object(f.a)(C,2),x=S[0],w=S[1],I=Object(n.useCallback)((function(){M.Get("/api/v1/docs/group/all").then((function(e){Array.isArray(e)?s(e):K.a.warn("\u83b7\u53d6\u5206\u7ec4\u5217\u8868\u6570\u636e\u51fa\u9519",3)})).catch((function(e){console.log(e)}))}),[s]);Object(n.useEffect)((function(){return 0===o.length&&I(),function(){localStorage.setItem("leftSiderWidth",x)}}),[o.length,I,x]),Object(n.useEffect)((function(){if(y&&y>0){if(!E.id||E.id!==y)for(var e=0;e<o.length;e++)if(o[e].id===y){k(o[e].id),h(o[e]);break}}else o.length>0&&h(o[0])}),[o,y,E.id,k]);var P=Object(n.useCallback)((function(e,t){t.element;var a=t.size;a.width<156?w(156):a.width<=460?w(a.width):w(460)}),[w]),D=Object(n.useMemo)((function(){var e=o.map((function(e,t){return c.a.createElement(z.a.Item,{key:t,onClick:function(t){document.title="\u770b\u677f-\u5206\u7c7b-".concat(e.name),k(e.id)}},e.name)}));return c.a.createElement(z.a,{className:"categories-list"},e)}),[o,k]),_=Object(n.useCallback)((function(e){e.preventDefault(),a((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[a]),U=Object(n.useMemo)((function(){return t?c.a.createElement(zt,{group:E.id}):null}),[E.id,t]),A=Object(n.useCallback)((function(e){if(e.stopPropagation(),E.id<0)K.a.warn("\u8fd8\u672a\u9009\u62e9\u5206\u7c7b\uff0c\u4e0d\u53ef\u521b\u5efa\u6587\u7ae0",3);else{M.Post("/api/v1/docs/article/create",{},{data:{group:E.id}}).then((function(e){e.id>0?(K.a.success("\u6dfb\u52a0\u6587\u7ae0\u6210\u529f"),v((function(e){return e+1})),j.push("/docs/article/".concat(e.id))):K.a.warn(JSON.stringify(e))})).catch((function(e){console.log(e)}))}}),[E.id,j,v]);return c.a.createElement(p.Resizable,{className:"box",axis:"x",height:0,width:x,onResize:P},c.a.createElement(d.a.Sider,{style:{height:"100vh"},width:x},c.a.createElement("div",{className:"left-sider"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"logo"},c.a.createElement(i.b,{to:"/"},c.a.createElement("img",{alt:"logo",src:"http://127.0.0.1:9000/static/image/logo-kanban.svg"})),c.a.createElement("div",{className:"toogle",onClick:_},c.a.createElement(O,{type:"angle-double-left",noMarginRight:!0})),c.a.createElement("div",{className:"clear"})),c.a.createElement("div",{className:"clear"}),c.a.createElement("div",{className:"namespace"},c.a.createElement(R.a,{overlay:D,trigger:["click"]},c.a.createElement("div",null,c.a.createElement("span",{style:{color:"red"}},c.a.createElement(O,{type:"flag"})),c.a.createElement("div",{className:"current"},E.name),c.a.createElement(O,{type:"arrows-v"}))))),c.a.createElement("div",{className:"content"},t&&U),c.a.createElement("div",{className:"footer",onClick:A},c.a.createElement("div",{className:"add"},c.a.createElement(O,{type:"plus"}),"\u65b0\u7684\u6587\u7ae0")))))};var Tt=function(e){var t=Object(n.useState)("align-justify"),a=Object(f.a)(t,2),r=a[0],l=a[1],i=Object(n.useContext)(u).navData,s=Object(n.useCallback)((function(t){t.preventDefault(),e.setShowLeftSider((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[e]);return c.a.createElement("div",{className:"right-content"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"toogle",onClick:s,onMouseEnter:function(e){l("angle-double-right")},onMouseLeave:function(e){l("align-justify")},style:{display:e.showLeftSider?"none":"inline-block"}},c.a.createElement(O,{type:r})),c.a.createElement(F,{data:i}),c.a.createElement("div",{className:"user"},c.a.createElement(L,null))),c.a.createElement("div",{className:"container"},c.a.createElement(o.d,null,c.a.createElement(o.b,Object.assign({path:"/",exact:!0,component:wt},e)),c.a.createElement(o.b,Object.assign({path:"/docs/article/:id",component:ke},e)))),c.a.createElement(T,null))};var Gt=function(e){var t,a=Object(n.useState)(!1),r=Object(f.a)(a,2),l=r[0],i=r[1],o=Object(n.useState)(null),s=Object(f.a)(o,2),m=s[0],p=s[1],b=Object(n.useState)([]),E=Object(f.a)(b,2),h=E[0],g=E[1],v=Object(n.useState)(0),O=Object(f.a)(v,2),j=O[0],y=O[1],k=Object(n.useState)([{title:"\u9996\u9875",icon:"home",link:"/"}]),N=Object(f.a)(k,2),C=N[0],S=N[1];return Object(n.useEffect)((function(){var t=localStorage.getItem("showLeftSider");null!==t?(t!==l.toString()&&i("true"===t),"/"===e.location.pathname&&(document.title="\u770b\u677f-\u9996\u9875",C.length>1&&S([{title:"\u9996\u9875",icon:"home",link:"/"}]))):i(!0)}),[C.length,e.location.pathname,l]),l&&(t=c.a.createElement(Lt,{showLeftSider:l,setShowLeftSider:i,refreshNavTimes:j})),c.a.createElement(u.Provider,{value:{navData:C,setNavData:S,history:e.history,refreshNavTimes:j,setRefreshNavTimes:y,currentArticleGroupID:m,setCurrentArticleGroupID:p,groupPermissions:h,setGroupPermissions:g}},c.a.createElement(d.a,{className:"left-right-layout"},t,c.a.createElement(d.a,null,c.a.createElement(d.a.Content,null,c.a.createElement(Tt,Object.assign({},e,{showLeftSider:l,setShowLeftSider:i}))))))},Ht=Fe.a.Item,Kt=function(e){var t=Object(n.useMemo)((function(){return c.a.createRef()}),[]),a=Object(n.useCallback)((function(t){M.Post("/api/v1/account/login",{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:t}).then((function(t){if("success"===t.status||!0===t.status){var a=new Pe(e.location.search).get("next","/");if((!a||"string"===typeof a&&a.indexOf("/user/login")>=0)&&(a="/"),"string"===typeof a&&a.startsWith("http"))window.location.href=a;else{var n=window.location.origin;"string"===typeof a&&(n=window.location.origin+a),window.location.href=n}}else K.a.error("\u767b\u9646\u5931\u8d25:"+t.message,5)})).catch((function(e){console.log(e),400!==e.status&&403!==e.status||(e.data&&e.data.message?K.a.warn(e.data.message,5):K.a.err(JSON.stringify(e.data),5))}))}),[e.location.search]);return Object(n.useEffect)((function(){localStorage.reFreshPathname=null}),[]),c.a.createElement(d.a,{className:"container"},c.a.createElement(ne.a,{className:"login"},c.a.createElement(ce.a,{xs:{span:20,offset:2},lg:{span:6,offset:9}},c.a.createElement("div",{className:"logo"},c.a.createElement("img",{src:"http://127.0.0.1:9000/static/image/logo-kanban.svg",alt:"Logo"})),c.a.createElement(Fe.a,{ref:t,onFinish:a,name:"baseForm",className:"login-form"},c.a.createElement(Ht,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},c.a.createElement(re.a,{prefix:c.a.createElement(O,{type:"user"}),placeholder:"username"})),c.a.createElement(Ht,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]},c.a.createElement(re.a,{prefix:c.a.createElement(O,{type:"lock"}),size:"large",type:"password",placeholder:"password"})),c.a.createElement(Ht,null,c.a.createElement(H.a,{type:"primary",htmlType:"submit",className:"login-form-button",style:{width:"100%"}},"\u767b\u5f55")),c.a.createElement(Ht,null,c.a.createElement(ne.a,null,c.a.createElement(ce.a,{span:12,className:"login-form-change"},c.a.createElement(i.b,{to:""},"\u4fee\u6539\u5bc6\u7801")),c.a.createElement(ce.a,{span:12,className:"login-form-forget"},c.a.createElement(i.b,{to:"/user/signup"},"\u6ce8\u518c"))))))))},Bt=function(e){var t=Object(n.useState)({}),a=Object(f.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(!1),s=Object(f.a)(o,2),u=s[0],m=s[1],d=Object(n.useMemo)((function(){return c.a.createRef()}),[]),p=Object(n.useCallback)((function(e){console.log(e);M.Post("/api/v1/account/user/create",{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:e}).then((function(e){e.id>0?(l(e),m(!0)):K.a.warn(JSON.stringify(e),5)})).catch((function(e){console.log(e),400===e.status&&K.a.error(JSON.stringify(e.data),5)}))}),[]);return Object(n.useEffect)((function(){d.current.setFieldsValue({})}),[d]),u?c.a.createElement("div",{classname:"container"},c.a.createElement(G.a,{status:"success",title:"\u8d26\u53f7\u6ce8\u518c\u6210\u529f!",subTitle:"\u60a8\u597d\uff01".concat(r.username,", \u8bf7\u70b9\u51fb\u767b\u5f55\uff01"),extra:[c.a.createElement(i.b,{to:"/"},c.a.createElement(H.a,{key:"index"},"\u9996\u9875")),c.a.createElement(i.b,{to:"/user/login"},c.a.createElement(H.a,{type:"primary",key:"login"},"\u767b\u5f55"))]})):c.a.createElement("div",{className:"container"},c.a.createElement(ne.a,{className:"signup"},c.a.createElement(ce.a,{xs:{span:20,offset:2},lg:{span:6,offset:9}},c.a.createElement("div",{className:"logo"},c.a.createElement("img",{src:"http://127.0.0.1:9000/static/image/logo-kanban.svg",alt:"Logo"})),c.a.createElement(Fe.a,{ref:d,onFinish:p,name:"baseForm",className:"login-form"},c.a.createElement(Fe.a.Item,{name:"mobile",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]},c.a.createElement(re.a,{prefix:c.a.createElement(O,{type:"mobile"}),size:"large",type:"text",placeholder:"\u624b\u673a\u53f7"})),c.a.createElement(Fe.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},c.a.createElement(re.a,{prefix:c.a.createElement(O,{type:"user"}),placeholder:"username",allowClear:!0})),c.a.createElement(Fe.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]},c.a.createElement(re.a,{prefix:c.a.createElement(O,{type:"lock"}),size:"large",type:"password",placeholder:"\u767b\u5f55\u5bc6\u7801",allowClear:!0})),c.a.createElement(Fe.a.Item,{name:"re_password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]},c.a.createElement(re.a,{prefix:c.a.createElement(O,{type:"lock"}),size:"large",type:"password",placeholder:"\u91cd\u590d\u5bc6\u7801"})),c.a.createElement(Fe.a.Item,null,c.a.createElement(H.a,{type:"primary",htmlType:"submit",className:"login-form-button",style:{width:"100%"}},"\u6ce8\u518c")),c.a.createElement(Fe.a.Item,null,c.a.createElement(ne.a,null,c.a.createElement(ce.a,{span:12,className:"login-form-change"},c.a.createElement(i.b,{to:""},"\u4fee\u6539\u5bc6\u7801")),c.a.createElement(ce.a,{span:12,className:"login-form-forget"},c.a.createElement(i.b,{to:"/user/login"},"\u767b\u5f55"))))))))};var qt=function(e){var t=Object(n.useState)(!1),a=Object(f.a)(t,2),r=a[0],l=a[1];return Object(n.useEffect)((function(){var t,a=e.history.location.pathname;try{t=window.localStorage.reFreshPathname,window.localStorage.reFreshPathname=a}catch(n){t=a}a!==t?window.location.reload():l(!0)}),[e,r]),c.a.createElement("div",null,r?c.a.createElement(G.a,{status:"404",title:"404",subTitle:"Sorry, \u60a8\u8981\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728.",extra:c.a.createElement(i.b,{to:"/"},c.a.createElement(H.a,{type:"primary"},"\u8fd4\u56de\u9996\u9875"))}):null)};var Jt=function(e){return c.a.createElement(s.Provider,null,c.a.createElement(i.a,null,c.a.createElement(o.d,null,c.a.createElement(o.b,{exact:!0,path:"/user/login",component:Kt}),c.a.createElement(o.b,{exact:!0,path:"/user/signup",component:Bt}),c.a.createElement(o.b,{exact:!0,path:"/",component:Gt}),c.a.createElement(o.b,{path:"/docs/article",render:function(e){return c.a.createElement(Gt,Object.assign({defaultOpenKey:"/docs"},e))}}),c.a.createElement(o.b,{path:"/docs",render:function(e){return c.a.createElement(Ft,Object.assign({defaultOpenKey:"/docs"},e))}}),c.a.createElement(o.b,{path:"/user",render:function(e){return c.a.createElement(Ft,Object.assign({defaultOpenKey:"/user"},e))}}),c.a.createElement(o.b,{path:"/test",render:function(e){return c.a.createElement(Ft,Object.assign({defaultOpenKey:"/test"},e))}}),c.a.createElement(o.b,{component:qt}))))};a(847),a(848);l.a.render(c.a.createElement(Jt,null),document.getElementById("root"))}},[[313,1,2]]]);
//# sourceMappingURL=main.0b2a7c60.chunk.js.map