(this.webpackJsonpkanban=this.webpackJsonpkanban||[]).push([[0],{332:function(e,t,a){e.exports=a(888)},886:function(e,t,a){},887:function(e,t,a){},888:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(12),l=a.n(r),o=a(5),i=a(90),s=c.a.createContext({}),u=c.a.createContext({}),d=(c.a.createRef({}),a(118),a(47)),m=a(3),p=a(82),f=a(17),h=a(19),g=a(21),E=a(20),v=a(22),b=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).state={type:a.props.type,spin:a.props.spin,danger:a.props.danger,noMarginRight:a.props.noMarginRight},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e="fa fa-".concat(this.state.type);return this.state.spin&&(e+=" fa-spin"),this.state.danger&&(e+=" danger"),c.a.createElement("span",{style:{marginRight:this.state.noMarginRight?0:5,display:"inline-block"}},c.a.createElement("i",{className:e},this.props.children))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.type!==t.type||e.spin!==t.spin||e.danger!==t.danger||e.noMarginRight!==t.noMarginRight?{type:e.type,spin:e.spin,danger:e.danger,noMarginRight:e.noMarginRight}:null}}]),t}(c.a.Component),y=(a(223),a(296)),O=a(60),j=a(294),k=a.n(j),S=a(295),C=a.n(S),N="",w=2e4,x=k.a.create({baseURL:N,timeout:w});x.defaults.headers.common["Content-Type"]="application/json",x.defaults.withCredentials=!0,x.interceptors.request.use((function(e){return"post"!==e.method&&"put"!==e.method&&"patch"!==e.method||!e.data instanceof String&&(e.data=C.a.stringify(e.data)),e}),(function(e){return Promise.reject(e)})),x.interceptors.response.use((function(e){if("delete"===e.config.method)return Promise.resolve(e);var t=e.data;return Promise.resolve(t)}),(function(e){if(/timeout/.test(e.message)&&console.log("\u7f51\u7edc\u8d85\u65f6\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"),e.response)switch(e.response.status){case 401:var t="/user/login?next="+window.location.href,a=window.location.origin+t;window.location.href=a;break;case 403:case 404:break;case 500:console.log("\u670d\u52a1\u5668\u9519\u8bef\uff01");break;case 503:console.log("\u670d\u52a1\u5668\u54cd\u5e94\u4e0d\u8fc7\u6765\uff01");break;default:console.log("\u9ed8\u8ba4\u9519\u8bef\u63d0\u793a")}return Promise.reject(e.response)}));var D=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return x.post(e,t,a)};var I={Get:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return x.get(e,Object(O.a)({},a,{params:t}))},Post:D,Put:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return x.put(e,t,a)},Patch:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return x.patch(e,t,a)},Delete:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return x.delete(e,Object(O.a)({},a,{params:t}))},testFetch:function(){D("/api/v1/account/login",{},{data:{username:"admin",password:"abc123456"},headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},P=function e(t){var a,r,l,i=t.item,s=t.index,u=t.collapsed,d=t.defaultOpenKey,p=Object(n.useState)(!1),f=Object(m.a)(p,2),h=f[0],g=f[1],E=i.children.map((function(t,a){return c.a.createElement(e,{item:t,index:a,key:a,collapsed:u})})),v=Object(n.useCallback)((function(e){g((function(e){return!e}))}),[]);return Object(n.useEffect)((function(){u||(d===i.key?g(!0):g(!1))}),[u,d,i.key]),i.icon&&(a=c.a.createElement(b,{type:i.icon})),E.length>0&&(r=c.a.createElement("div",{className:"right"},c.a.createElement(b,{type:h?"caret-down":"caret-left"}))),u?E.length>0?c.a.createElement(y.a,{title:i.title,content:c.a.createElement("div",{className:"collapsed-nav-children"},E),placement:"rightTop"},c.a.createElement("div",{className:"item"},c.a.createElement("div",{className:"title"},c.a.createElement(b,{type:i.icon?i.icon:"angle-right"}),i.level<=1?null:i.title))):i.is_link&&i.link?c.a.createElement("div",{className:"item"},c.a.createElement("a",{href:i.link,target:"_blank"===i.target?"_blank":"",rel:"noopener noreferrer"},c.a.createElement("div",{className:"title"},c.a.createElement(b,{type:i.icon?i.icon:"angle-right"}),i.title?i.title:"\u65e0\u6807\u9898"))):c.a.createElement("div",{className:"item"},c.a.createElement(o.c,{to:i.slug,activeClassName:"active",target:"_blank"===i.target?"_blank":""},c.a.createElement("div",{className:"title"},c.a.createElement(b,{type:i.icon?i.icon:"angle-right"}),i.title?i.title:"\u65e0\u6807\u9898"))):(l=E.length>0?c.a.createElement("div",null,c.a.createElement("div",{className:"title",style:{paddingLeft:12*i.level},onClick:v},a,i.title?i.title:"\u65e0\u6807\u9898",r)):i.is_link&&i.link?c.a.createElement("a",{href:i.link,target:i.target,rel:"noopener noreferrer"},c.a.createElement("div",{className:"title",style:{paddingLeft:12*i.level}},a,i.title?i.title:"\u65e0\u6807\u9898",r)):c.a.createElement(o.c,{to:i.slug,activeClassName:"active",target:"_blank"===i.target?"_blank":""},c.a.createElement("div",{className:"title",style:{paddingLeft:12*i.level},onClick:v},a,i.title?i.title:"\u65e0\u6807\u9898",r)),c.a.createElement("div",{className:"item",key:s},l,u?"\u6298\u53e0":"",E.length>0&&c.a.createElement("div",{className:h?"children active":"children"},E)))},_=function(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),s=i[0],u=i[1];Object(n.useEffect)((function(){0===r.length&&I.Get("/api/v1/account/user/nav/list").then((function(e){e instanceof Array?l(e):console.log("\u83b7\u53d6\u5bfc\u822a\u6570\u636e\u51fa\u9519")})).catch((function(e){console.log(e)})),e.collapsed!==s&&u(e.collapsed)}),[s,r.length,e.collapsed]);var d=r.map((function(t,a){return c.a.createElement(P,{item:t,index:a,key:a,collapsed:s,defaultOpenKey:e.defaultOpenKey})}));return c.a.createElement("div",{className:"nav-list"},d)};var M=function(e){var t=e.showLeftSider,a=e.setShowLeftSider,r=e.defaultOpenKey,l=Object(n.useState)(null),i=Object(m.a)(l,2),s=i[0],u=i[1],f=Object(n.useMemo)((function(){var e=localStorage.getItem("leftSiderWidth"),t=parseInt(e);return t&&t>=156&&t<=460?t:200}),[]),h=Object(n.useState)(f),g=Object(m.a)(h,2),E=g[0],v=g[1];Object(n.useEffect)((function(){return function(){localStorage.setItem("leftSiderWidth",E)}}),[E]);var y=Object(n.useCallback)((function(e,t){t.element;var a=t.size;a.width<156?v(156):a.width<=460?v(a.width):v(460)}),[v]),O=Object(n.useCallback)((function(e){e.preventDefault(),a((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[a]),j=Object(n.useMemo)((function(){return t?c.a.createElement(_,{collapsed:s,defaultOpenKey:r}):null}),[t,s,r]),k=Object(n.useCallback)((function(){u((function(e){return!e}))}),[u]);return Object(n.useEffect)((function(){if(null===s){var e=localStorage.getItem("leftSiderNavCollapsed");u(null!==e&&"true"===e)}return localStorage.setItem("leftSiderNavCollapsed",s),function(){localStorage.setItem("leftSiderNavCollapsed",s)}}),[s]),c.a.createElement(p.Resizable,{className:"box",axis:"x",height:0,width:E,onResize:y},c.a.createElement(d.a.Sider,{style:{height:"100vh"},width:s?64:E},c.a.createElement("div",{className:s?"left-sider collapsed":"left-sider"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"logo"},c.a.createElement(o.b,{to:"/"},c.a.createElement("img",{alt:"logo",src:"https://www.codelieche.com/static/images/logo-kanban.svg"})),c.a.createElement("div",{className:"toogle",onClick:O,style:{display:s?"none":""}},c.a.createElement(b,{type:"angle-double-left",noMarginRight:!0})),c.a.createElement("div",{className:"clear"})),c.a.createElement("div",{className:"clear"})),c.a.createElement("div",{className:"content"},j),c.a.createElement("div",{className:"footer",onClick:k},c.a.createElement("div",{className:"collapsed-toogle"},c.a.createElement(b,{type:s?"indent":"outdent"}))))))},A=(a(417),a(178));var R=function(e){var t=e.data;if(t&&t instanceof Array){var a=t.map((function(e,t){var a;return e.icon&&(a=c.a.createElement(b,{type:e.icon,noMarginRight:!0})),e.link?c.a.createElement(A.a.Item,{key:t},c.a.createElement(o.b,{to:e.link},a,e.title)):c.a.createElement(A.a.Item,{key:t},a,e.title)}));return c.a.createElement(A.a,{className:"nav"},a)}return null},F=(a(138),a(87)),U=(a(195),a(35)),L=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)({}),s=Object(m.a)(i,2),u=s[0],d=s[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),h=f[0],g=f[1];Object(n.useEffect)((function(){E()}),[]);var E=Object(n.useCallback)((function(){I.Get("/api/v1/account/login").then((function(e){g(!0),e.logined?(l(!0),d({username:e.username})):(l(!1),d({username:"\u672a\u767b\u5f55"}))})).catch((function(e){console.log(e),g(!0)}))}),[l,d]);if(h){if(r){var v=c.a.createElement(U.a,null,c.a.createElement(U.a.Item,null,c.a.createElement(o.b,{to:"/user/center"},c.a.createElement(b,{type:"user-circle"}," \u7528\u6237\u4e2d\u5fc3"))),c.a.createElement(U.a.Item,null,c.a.createElement(o.b,{to:"/docs/category"},c.a.createElement(b,{type:"file-text-o"}," \u5206\u7c7b\u5217\u8868"))),c.a.createElement(U.a.Item,null,c.a.createElement(o.b,{to:"/user/message"},c.a.createElement(b,{type:"envelope-o"}," \u6d88\u606f\u4e2d\u5fc3"))),c.a.createElement(U.a.Item,null,c.a.createElement(o.b,{to:"/user/logout"},c.a.createElement(b,{type:"sign-out"}," \u9000\u51fa\u767b\u5f55"))));return c.a.createElement(F.a,{overlay:v},c.a.createElement("div",null,c.a.createElement(b,{type:"user-o"}),"Hi ~ ",u.username))}return c.a.createElement(o.b,{to:"/user/login"},c.a.createElement(b,{type:"sign-in"}),"\u767b\u5f55")}return null};var K=function(e){return c.a.createElement("div",{className:"footer"},c.a.createElement("div",{className:"copyright"},"Copyright @ 2011-2020 www.codelieche.com all Rights Reserved",c.a.createElement("br",null),c.a.createElement("div",null,"\u7ca4ICP\u5907xxxxxxxx\u53f7")))},T=(a(249),a(132)),z=(a(32),a(7)),H=(a(33),a(4)),B=a(160),G=a.n(B),V=a(117),q=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),s=i[0],u=i[1],d=Object(n.useState)(c.a.createRef()),p=Object(m.a)(d,2),f=p[0],h=p[1],g=Object(n.useCallback)((function(){return e.innerRef&&"function"!==typeof e.innerRef?e.innerRef.current:f.current}),[f,e.innerRef]),E=Object(n.useCallback)((function(){try{if(s){var t=g();if(!t)return;var a=t.innerHTML,n=t.innerText;e.handleContentUpdated&&"function"===typeof e.handleContentUpdated&&(e.handleContentUpdated({html:a,text:n}),u(!1))}}catch(c){console.log(c)}}),[s,g,e]);Object(n.useEffect)((function(){e.innerRef&&"function"===typeof e.innerRef&&e.innerRef!==f&&h(e.innerRef)}),[f,e.innerRef]),Object(n.useEffect)((function(){return E}),[]);var v=Object(n.useCallback)((function(t){var a=g();if(a){var n=a.innerHTML;if(n===r||s||u(!0),e.onChange&&n!==r){var c=Object.assign({},t,{target:{value:n,text:a.innerText}});e.onChange(c)}l(n)}}),[s,g,r,e]);return Object(n.useMemo)((function(){var t=e.tagName,a=e.content,n=e.contentType,r=(e.handleContentUpdated,e.innerRef,Object(V.a)(e,["tagName","content","contentType","handleContentUpdated","innerRef"]));return n&&"text"!==n?c.a.createElement(t||"div",Object(O.a)({},r,{ref:f,onInput:v,onBlur:e.onBlur||E,onMouseLeave:e.onMouseLeave||E,onKeyUp:e.onKeyUp||v,onKeyDown:e.onKeyDown||v,contentEditable:!e.disabled,suppressContentEditableWarning:!0,dangerouslySetInnerHTML:{__html:a}})):c.a.createElement(t||"div",Object(O.a)({},r,{ref:f,onInput:v,onBlur:e.onBlur||v,onMouseLeave:e.onMouseLeave||E,onKeyUp:e.onKeyUp||v,onKeyDown:e.onKeyDown||v,contentEditable:!e.disabled,suppressContentEditableWarning:!0,style:e.style?e.style:{whiteSpace:"pre-wrap"}}),a)}),[f,v,E,e])},J=a(161),W=a.n(J),Y=function(e,t,a){var n="/api/v1/docs/article/".concat(e);I.Patch(n,{},{data:t}).then((function(e){e.id>0?"function"===typeof a&&a(e):console.log(e)})).catch((function(a){if(console.log(a),t&&t.content){var n="article_".concat(e,"_content"),c={content:t.content,time:W()().format("YYYY-MM-DD hh:mm:ss"),key:n};localStorage.setItem(n,JSON.stringify(c))}a&&a.status&&(403===a.status?H.a.error("\u60a8\u65e0\u6743\u9650",5):404===a.status?H.a.error("404\u9519\u8bef",5):H.a.error("\u51fa\u73b0\u9519\u8bef\uff1a".concat(a.status),5))}))},$=(a(142),a(84)),Q=(a(525),a(328)),X=a(304),Z=a(891),ee={'code[class*="language-"]':{color:"#c5c8c6",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:"Inconsolata, Monaco, Consolas, 'Courier New', Courier, monospace",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{color:"#c5c8c6",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:"Inconsolata, Monaco, Consolas, 'Courier New', Courier, monospace",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:".5em 0",overflow:"auto",borderRadius:"0.3em",background:"#3f3f3f"},':not(pre) > code[class*="language-"]':{background:"#3f3f3f",padding:".1em",borderRadius:".3em"},comment:{color:"#7C7C7C"},prolog:{color:"#7C7C7C"},doctype:{color:"#7C7C7C"},cdata:{color:"#7C7C7C"},punctuation:{color:"#c5c8c6"},".namespace":{Opacity:".7"},property:{color:"#96CBFE"},keyword:{color:"#96CBFE"},tag:{color:"#96CBFE"},"class-name":{color:"#FFFFB6",textDecoration:"underline"},boolean:{color:"#99CC99"},constant:{color:"#99CC99"},symbol:{color:"#f92672"},deleted:{color:"#f92672"},number:{color:"#FF73FD"},selector:{color:"#A8FF60"},"attr-name":{color:"#A8FF60"},string:{color:"#A8FF60"},char:{color:"#A8FF60"},builtin:{color:"#A8FF60"},inserted:{color:"#A8FF60"},variable:{color:"#C6C5FE"},operator:{color:"#EDEDED"},entity:{color:"#FFFFB6",cursor:"help"},url:{color:"#96CBFE"},".language-css .token.string":{color:"#87C38A"},".style .token.string":{color:"#87C38A"},atrule:{color:"#F9EE98"},"attr-value":{color:"#F9EE98"},function:{color:"#DAD085"},regex:{color:"#E9C062"},important:{color:"#fd971f",fontWeight:"bold"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"}},te=function(e){var t=e.value,a=e.language;return c.a.createElement(Z.a,{language:a,style:ee},t)},ae=(a(37),a(13)),ne=(a(40),a(9)),ce=(a(55),a(27)),re=(a(268),a(99)),le=(a(889),a(326));var oe=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(null),i=Object(m.a)(o,2),s=i[0],u=i[1],d=Object(n.useCallback)((function(t){if(t.stopPropagation(),t.clipboardData||t.originalEvent){var a=t.clipboardData||t.originalEvent.clipboardData;if(a.items)for(var n=a.items,c=0;c<n.length;c++)if(n[c].type.indexOf("image")>=0){var r=n[c].getAsFile();r.uid="parse-upload-".concat(Math.round(1e9*Math.random()));var l=URL.createObjectURL(r);e.setFileListData([r]),u(l)}}}),[e]);Object(n.useEffect)((function(){return e.url===s||r||s||u(e.url),document.addEventListener("paste",d),function(){document.removeEventListener("paste",d)}}),[e.url,s,r,d,e.fileListData.length]);var p,f={name:"file",multiple:!1,onRemove:function(t){console.log(t),e.setFileListData((function(e){var a=e,n=a.indexOf(t);n>=0&&s&&!r&&u(null);var c=a.slice();return c.splice(n,1),c}))},beforeUpload:function(t){if(t.type.indexOf("image")<0)return H.a.warn("\u8bf7\u9009\u62e9\u56fe\u7247\u6587\u4ef6"),!1;e.setFileListData([t]);var a=URL.createObjectURL(t);return l(!0),u(a),!1},fileList:e.fileListData};return s&&(p=c.a.createElement("img",{style:{maxWidth:"100%",height:"auto"},src:s,alt:"\u56fe\u7247"})),c.a.createElement(le.a.Dragger,f,c.a.createElement("div",{className:"ant-upload-hint"},p,e.tooltip?e.tooltip:c.a.createElement("div",null,"\u8bf7\u9009\u62e9\u4e00\u5f20\u8981\u4e0a\u4f20\u7684\u56fe\u7247")))},ie=function(e){var t=Object(n.useState)("uploadImage"),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)([]),i=Object(m.a)(o,2),s=i[0],u=i[1],d=Object(n.useState)(null),p=Object(m.a)(d,2),f=p[0],h=p[1],g=Object(n.useCallback)((function(e){l(e)}),[]);Object(n.useEffect)((function(){}),[]);var E=Object(n.useCallback)((function(e){e.stopPropagation(),h(e.target.value)}),[]),v=Object(n.useMemo)((function(){return/\.(png)|(jpg)|(gif)|(jpeg)$/}),[]),b=Object(n.useCallback)((function(){if(!(s.length<1)){for(var t=new FormData,a=0;a<s.length;a++)t.append("file",s[a]);I.Post("/api/v1/docs/image/upload",t,{}).then((function(t){console.log(t),t.qiniu?e.afterUploadHandle?e.afterUploadHandle(t.qiniu):console.log("\u672a\u4f20\u9012\uff1aafterUploadHandle"):t.file?e.afterUploadHandle?e.afterUploadHandle(t.file):console.log("\u672a\u4f20\u9012\uff1aafterUploadHandle"):H.a.warn("\u4e0a\u4f20\u56fe\u7247\u7684\u8fd4\u56de\u7ed3\u679cfile\u548cqiniu\u5b57\u6bb5\u4e3a\u7a7a")})).catch((function(e){console.log(e)}))}}),[s,e]),y=Object(n.useCallback)((function(t){if(t.stopPropagation(),"uploadImage"===r){if(s.length>0)return void b();H.a.warn("\u8bf7\u9009\u62e9\u9700\u8981\u4e0a\u4f20\u7684\u56fe\u7247")}else"useLink"===r&&(f?v.test(f)?e.afterUploadHandle?e.afterUploadHandle(f):console.log("\u672a\u4f20\u9012\uff1aafterUploadHandle"):H.a.warn("\u56fe\u7247\u7684\u5730\u5740\u9700\u8981\u4ee5jpg/jpeg/png/gif\u7ed3\u5c3e"):H.a.warn("\u8bf7\u8f93\u5165\u56fe\u7247\u7684\u7f51\u5740"))}),[r,v,s.length,b,f,e]),O=!0;return"uploadImage"===r?s.length>0&&(O=!1):"useLink"===r&&f&&v.test(f)&&(O=!1),c.a.createElement("div",{className:"upload-image-tabs"},c.a.createElement(re.a,{defaultActiveKey:r,onChange:g},c.a.createElement(re.a.TabPane,{tab:"\u4e0a\u4f20\u56fe\u7247",key:"uploadImage"},c.a.createElement("div",{className:"upload"},c.a.createElement(oe,{url:"",fileListData:s,setFileListData:u}))),c.a.createElement(re.a.TabPane,{tab:"\u4f7f\u7528\u94fe\u63a5",key:"useLink"},c.a.createElement("div",{className:"input-url"},c.a.createElement(ce.a,{placeholder:"\u8f93\u5165\u56fe\u7247\u5730\u5740",allowClear:!0,onChange:E})),"useLink"===r&&f&&v.test(f)&&c.a.createElement("div",{className:"show-image"},c.a.createElement("img",{src:f,alt:"\u56fe\u7247"})))),c.a.createElement("div",{className:"button"},c.a.createElement(z.a,{type:"primary",onClick:y,disabled:O},"\u63d0\u4ea4")))},se=function(e){e.visible;var t=Object(V.a)(e,["visible"]),a=Object(n.useCallback)((function(t){console.log(t),e.handleAfterClose&&e.handleAfterClose()}),[e]);return c.a.createElement($.a,{wrapClassName:"upload-image-modal",visible:e.visible,onOk:a,onCancel:a,destroyOnClose:!0,footer:null},c.a.createElement(ie,t))};function ue(e){var t=e.type,a=e.icon,r=e.text,l=(e.title,e.editor),o=(e.historySize,e.setHistorySize),i=e.setModalVisible,s=Object(n.useCallback)((function(e){if(e.preventDefault(),"image"!==t){var a=l.historySize();if(o(a),["undo","redo"].indexOf(t)>=0)switch(t){case"undo":return void l.undo();case"redo":return void l.redo();default:return!1}var n=l.getSelections().map((function(e,a){switch(t){case"link":return"[".concat(e,"]()");case"image":return"![".concat(e,"]()");case"italic":return"*".concat(e,"*");case"bold":return"**".concat(e,"**");case"strikethrough":return"~~".concat(e,"~~");case"list-ul":return"\n- "+e.replace("\n","\n- ");case"list-ol":return"\n1. "+e.replace("\n","\n1. ");case"code":return"`"+e+"`";case"quote":return"\n> "+e;case"blockquote":return"\n```\n"+e+"\n```\n";case"table":return"\n\n | Title1   | Title2 | Title3 | Title4 |\n| ---- | --- | --- | --- |\n| 1    | - | - | - |\n| 2    | - | - | - |\n";default:return e}}));l.replaceSelections(n)}else i(!0)}),[l,o,i,t]);return c.a.createElement("div",{className:"no-active",onClick:s},a?c.a.createElement(b,{type:a,noMarginRight:!0}):c.a.createElement(b,null,r))}var de=function(e){var t=Object(n.useState)({undo:0,redo:0}),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),s=i[0],u=i[1];Object(n.useEffect)((function(){if(e.editor){var t=e.editor.historySize();l(t)}}),[e.editor]);var d=[{type:"undo",text:"\u64a4\u9500",icon:"undo"},{type:"redo",text:"\u91cd\u505a",icon:"repeat"},{type:"bold",text:"\u7c97\u4f53",icon:"bold"},{type:"italic",text:"\u659c\u4f53",icon:"italic"},{type:"strikethrough",text:"\u5220\u9664\u7ebf",icon:"strikethrough"},{type:"list-ul",text:"\u65e0\u5e8f\u5217\u8868",icon:"list-ul"},{type:"list-ol",text:"\u6709\u5e8f\u5217\u8868",icon:"list-ol"},{type:"link",text:"\u94fe\u63a5",icon:"link"},{type:"quote",text:"\u5f15\u7528",icon:"quote-left"},{type:"blockquote",title:"\u4ee3\u7801\u5757",icon:"code"},{type:"table",title:"\u8868\u683c",icon:"table"},{type:"image",text:"\u56fe\u7247",icon:"image"}].map((function(t,a){return c.a.createElement(ue,{type:t.type,key:a,icon:t.icon,text:t.text,historySize:r,setHistorySize:l,setModalVisible:u,editor:e.editor})})),p=Object(n.useCallback)((function(e){if(e.stopPropagation(),!s&&(e.clipboardData||e.originalEvent)){var t=e.clipboardData||e.originalEvent.clipboardData;if(t.items)for(var a=t.items,n=0;n<a.length;n++)a[n].type.indexOf("image")>=0&&u(!0)}}),[s]);Object(n.useEffect)((function(){return document.addEventListener("paste",p),function(){document.removeEventListener("paste",p)}}),[p]);var f=Object(n.useCallback)((function(t){console.log("\u4e0a\u4f20\u4e86\u56fe\u7247\uff1a",t);var a=e.editor.getSelections().map((function(e,a){return"![".concat(e,"](").concat(t,")")}));e.editor.replaceSelections(a),u(!1)}),[e.editor]);return c.a.createElement("div",{className:"tools"},c.a.createElement(ae.a,{style:{width:"100%"}},c.a.createElement(ne.a,{xs:{span:24},sm:{span:16},className:"left"},d),c.a.createElement(ne.a,{xs:{span:24},sm:{span:8},className:"right"},c.a.createElement("div",{className:"no-active",onClick:function(){return e.setDisplay((function(e){return{markdown:!0,html:!e.html}}))}},c.a.createElement(b,{type:e.display&&e.display.html?"eye-slash":"eye"})),c.a.createElement("div",{className:!e.display.markdown&&e.display.html?"active":"no-active",onClick:function(){return e.setDisplay((function(e){return{markdown:!e.markdown,html:!0}}))}},c.a.createElement(b,{type:"desktop"})),c.a.createElement("div",{className:"no-active",onClick:function(t){console.log(t),t.preventDefault(),window.editor=e.editor}},c.a.createElement(b,{type:"cog"})))),c.a.createElement(se,{visible:s,handleAfterClose:function(){return u(!1)},afterUploadHandle:f}))};a(845);var me=function(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(null),i=Object(m.a)(o,2),s=i[0],u=i[1],d=Object(n.useState)({markdown:!0,html:!0}),p=Object(m.a)(d,2),f=p[0],h=p[1],g=Object(n.useCallback)((function(t,a,n){e.onChange&&"function"===typeof e.onChange&&e.onChange(n)}),[e]),E=Object(n.useCallback)((function(e,t,a){l(a)}),[]);return Object(n.useEffect)((function(){e.content!==r&&l(e.content)}),[e.content]),c.a.createElement("div",{className:"editor"},c.a.createElement("div",null,c.a.createElement(de,{editor:s,display:f,setDisplay:h})),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"markdown",style:{display:f.markdown?"block":"none"}},c.a.createElement("div",{style:{position:"relative",height:"100%",display:f.markdown?"block":"none"}},c.a.createElement(X.Controlled,{editorDidMount:function(e){u(e)},autoCursor:!0,options:{mode:"markdown",theme:"eclipse",lineNumbers:!0},value:r,onBeforeChange:E,onChange:g}))),c.a.createElement("div",{className:"html",style:{display:f.html?"block":"none"}},c.a.createElement(G.a,{source:r||"\u8bf7\u8f93\u5165\u6587\u7ae0\u5185\u5bb9",renderers:{code:te}}))))},pe=function(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),s=i[0],u=i[1],d=Object(n.useState)(null),p=Object(m.a)(d,2),f=p[0],h=p[1];Object(n.useEffect)((function(){if(e.visable){var t="article_".concat(e.articleID,"_content"),a=localStorage.getItem(t);if(a)try{h(JSON.parse(a))}catch(n){console.log(n),h(null)}else h(null)}l(e.markdownContent)}),[e.articleID,e.markdownContent,e.visable]);var g=Object(n.useCallback)((function(){s&&s&&e.content!==r&&e.handleContentUpdated&&e.handleContentUpdated(r)}),[s,r,e]),E=Object(n.useCallback)((function(t){g(),e.afterModalCloseHandle&&"function"===typeof e.afterModalCloseHandle&&e.afterModalCloseHandle()}),[g,e]),v=Object(n.useCallback)((function(){g(),e.afterModalCloseHandle&&"function"===typeof e.afterModalCloseHandle&&e.afterModalCloseHandle()}),[g,e]);Object(n.useEffect)((function(){e.markdownContent===r||r||l(e.markdownContent),s||r===e.content||u(!0)}),[e.markdownContent,s]),Object(n.useEffect)((function(){return function(){s&&console.log("\u6211\u66f4\u65b0\u4e86\uff0c\u6211\u9700\u8981\u505a\u70b9\u64cd\u4f5c")}}),[s]);var b=Object(n.useMemo)((function(){if(f&&f.content&&e.visable){var t=c.a.createElement("div",{onDoubleClick:function(e){e.stopPropagation(),l(f.content),f.key&&localStorage.removeItem(f.key),h(null)}},"".concat(f.time,":\u66f4\u65b0\u672a\u63d0\u4ea4\u6210\u529f\uff0c\u53cc\u51fb\u5207\u6362\u6210\u672a\u63d0\u4ea4\u7684\u5185\u5bb9"));return c.a.createElement(Q.a,{className:"alert",message:t,type:"warning",closable:!0,closeText:"\u5ffd\u7565",onClose:function(e){e.stopPropagation(),f.key&&localStorage.removeItem(f.key)}})}return null}),[f,e.visable]);return c.a.createElement($.a,{visible:e.visable,width:"90%",wrapClassName:"editor-modal",onCancel:v,onOk:E,footer:null,destroyOnClose:!!e.content},c.a.createElement("div",null,b,c.a.createElement(me,{content:r,onChange:function(e){return l(e)}})))},fe=(a(290),a(171)),he=function(e){return c.a.createElement("div",{className:"loading"},c.a.createElement(fe.a,{size:e.size?e.size:"default"}),c.a.createElement("div",{className:"message"},e.message?e.message:"\u6570\u636e\u52a0\u8f7d\u4e2d..."))},ge=(a(152),a(30)),Ee=a(67),ve=(a(850),a(316)),be=(a(852),a(317)),ye=function(e){var t=e.data,a=e.children,r=e.afterFetchPostHandle,l=Object(n.useState)(null),o=Object(m.a)(l,2),i=o[0],s=o[1],u=Object(n.useCallback)((function(e){e.stopPropagation(),s(e.target.value)}),[]),d=Object(n.useCallback)((function(e,t,a){if(t){I.Post("/api/v1/docs/discussion/create",{},{data:{category:"comment",content:t,parent:a}}).then((function(e){e.id>0?(H.a.success("\u6dfb\u52a0\u8bc4\u8bba\u6210\u529f",3),s(null),r&&r()):H.a.warn("\u8bc4\u8bba\u5931\u8d25\uff1a"+JSON.stringify(e),5)})).catch((function(e){console.log(e),H.a.error("\u8bc4\u8bba\u5931\u8d25",5)}))}}),[r]);return c.a.createElement(ve.a,{author:t.user,avatar:c.a.createElement(be.a,{style:{backgroundColor:"#87d068"},icon:c.a.createElement(b,{type:"user",noMarginRight:!0}),alt:t.user}),content:t.content,datetime:W()(t.time_added,"YYYY-MM-DD HH:mm:ss").fromNow()},c.a.createElement("div",{className:"comment"},c.a.createElement(ce.a.Search,{value:i,onChange:u,onSearch:function(e){return d("comment",i,t.id)},placeholder:"\u8bc4\u8bba",enterButton:c.a.createElement(z.a,{type:"primary"},"\u8bc4\u8bba")})),a)},Oe=function(e){var t=e.id,a=Object(n.useState)(0),r=Object(m.a)(a,2),l=r[0],o=r[1],i=Object(n.useState)([]),s=Object(m.a)(i,2),u=s[0],d=s[1],p=Object(n.useState)("comment"),f=Object(m.a)(p,2),h=f[0],g=f[1],E=Object(n.useState)(null),v=Object(m.a)(E,2),b=v[0],y=v[1],O=Object(n.useCallback)((function(e,t){if(!(t<1)&&e){var a="/api/v1/docs/article/".concat(e,"/discussions?page=").concat(t);I.Get(a,{},{}).then((function(e){var a=e.results;d(1===t?a:function(e){return[].concat(Object(Ee.a)(e),Object(Ee.a)(a))}),e.next?o((function(e){return e+1})):o(0)}))}}),[]);Object(n.useEffect)((function(){t&&(d([]),O(t,1))}),[t,O]);var j=Object(n.useCallback)((function(){O(t,1)}),[O,t]),k=Object(n.useMemo)((function(){return u.map((function(e,t){for(var a,n=e.parent,r=[e];n;)r.push(n),n=n.parent;for(var l=0;l<r.length;l++){var o=r[l];a=c.a.createElement(ye,{key:"".concat(e.id,"-").concat(o.id),data:o,afterFetchPostHandle:j},a)}return a}))}),[j,u]),S=Object(n.useCallback)((function(e){g(e.target.value),e.stopPropagation()}),[]),C=Object(n.useCallback)((function(e){e.stopPropagation(),y(e.target.value)}),[]),N=Object(n.useCallback)((function(e,a,n){if(a){I.Post("/api/v1/docs/discussion/create",{},{data:{article:t,category:e,content:a,parent:n}}).then((function(e){e.id>0?(H.a.success("\u6dfb\u52a0\u8bc4\u8bba\u6210\u529f",3),y(null),O(t,1)):H.a.warn("\u8bc4\u8bba\u5931\u8d25\uff1a"+JSON.stringify(e),5)})).catch((function(e){console.log(e),H.a.error("\u8bc4\u8bba\u5931\u8d25",5)}))}}),[O,t]);return c.a.createElement("div",{className:"discussions"},c.a.createElement("div",{className:"add"},c.a.createElement(ce.a.TextArea,{value:b,autoSize:{minRows:2,maxRows:6},onChange:C}),c.a.createElement("div",{className:"buttons"},c.a.createElement(ge.a.Group,{defaultValue:h,buttonStyle:"solid",onChange:S},c.a.createElement(ge.a.Button,{value:"discussion"},"\u8ba8\u8bba"),c.a.createElement(ge.a.Button,{value:"comment"},"\u8bc4\u8bba"),c.a.createElement(ge.a.Button,{value:"ask"},"\u63d0\u95ee"),c.a.createElement(ge.a.Button,{value:"issue"},"\u95ee\u9898"),c.a.createElement(ge.a.Button,{value:"feedback"},"\u53cd\u9988")),c.a.createElement(z.a,{type:"primary",onClick:function(){return N(h,b)},disabled:!b,className:"float-right"},"\u63d0\u4ea4"))),c.a.createElement("div",{className:"list"},k),l>0?c.a.createElement("div",{className:"more",onClick:function(){return O(t,l)}},"\u8fd8\u6709\u4e0b\u4e00\u9875"):null)},je=function(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)({}),s=Object(m.a)(i,2),d=s[0],p=s[1],f=Object(n.useContext)(u),h=f.setNavData,g=f.setRefreshNavTimes,E=f.currentArticleCategoryID,v=f.setCurrentArticleCategoryID,y=Object(n.useState)(!1),O=Object(m.a)(y,2),j=O[0],k=O[1],S=Object(n.useState)(!1),C=Object(m.a)(S,2),N=C[0],w=C[1],x=Object(n.useState)(!1),D=Object(m.a)(x,2),P=D[0],_=D[1],M=Object(n.useState)(!1),A=Object(m.a)(M,2),R=A[0],F=A[1],U=Object(n.useState)(0),L=Object(m.a)(U,2),K=L[0],B=L[1],V=Object(n.useCallback)((function(e){if(e){var t="/api/v1/docs/article/".concat(e);I.Get(t,{},{}).then((function(t){if(F(!0),t.id>0){p(t),l(e),Number.isInteger(t.category)&&E!==t.category&&v(t.category);for(var a=[{title:t.title,icon:t.icon}],n=t.parent;n;){var c={title:n.title?n.title:"\u65e0\u6807\u9898",link:"/docs/article/".concat(n.id),icon:n.icon,id:n.id};a.unshift(c),n=n.parent}a.unshift({title:"\u9996\u9875",icon:"home",link:"/"}),"function"===typeof h?h(a):console.log("\u4e0d\u80fd\u8bbe\u7f6enavData"),document.title="\u770b\u677f--".concat(t.title)}else H.a.warn("\u83b7\u53d6\u6587\u7ae0\u6570\u636e\u51fa\u9519")})).catch((function(e){F(!0),console.log(e),e&&e.status&&(403===e.status||404===e.status)&&(p({}),B(e.status))}))}}),[E,v,h]);Object(n.useEffect)((function(){(e.match.params.id!==r||d.id&&e.match.params.id!==d.id.toString())&&V(e.match.params.id)}),[e.match.params.id,V]);var J=Object(n.useMemo)((function(){return Array.isArray(d.children)?d.children.map((function(e,t){return c.a.createElement("li",{key:t},c.a.createElement(o.b,{to:"/docs/article/".concat(e.id)},c.a.createElement(b,{type:"file-text-o"}),e.title?e.title:c.a.createElement("span",{className:"no-title"},"\u65e0\u6807\u9898")))})):[]}),[d]),W=Object(n.useCallback)((function(){g((function(e){return e+1}))}),[g]),$=Object(n.useCallback)((function(){_(!0)}),[]),Q=Object(n.useCallback)((function(){_(!1),setTimeout((function(){V(r)}),300)}),[r,V]);if(!R)return c.a.createElement(he,{size:"large"});if(!d.id&&K>0){if(403===K)return c.a.createElement(T.a,{status:"403",title:"403",subTitle:"Sorry\uff0c\u60a8\u6682\u65f6\u65e0\u6743\u9650\u8bbf\u95ee\u672c\u9875\u9762:".concat(e.history.location.pathname),extra:c.a.createElement(z.a,{type:"primary"},c.a.createElement(o.b,{to:"/"},"\u8fd4\u56de\u9996\u9875"))});if(404===K)return c.a.createElement(T.a,{status:"404",title:"404",subTitle:"Sorry\uff0c\u60a8\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728:".concat(e.history.location.pathname),extra:c.a.createElement(z.a,{type:"primary"},c.a.createElement(o.b,{to:"/"},"\u8fd4\u56de\u9996\u9875"))})}return c.a.createElement("article",null,c.a.createElement("header",{className:"middle"},c.a.createElement("div",{className:"title"},c.a.createElement("div",{className:"toogle"},c.a.createElement("span",{className:"button",onClick:function(){k((function(e){return!e}))}},c.a.createElement(b,{type:"info-circle"}),j?"\u9690\u85cf\u63cf\u8ff0":"\u663e\u793a\u63cf\u8ff0"),c.a.createElement("span",{className:"button",onClick:function(){w((function(e){return!e}))}},c.a.createElement(b,{type:"commenting"}),N?"\u9690\u85cf\u8ba8\u8bba":"\u663e\u793a\u8ba8\u8bba")),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"icon"},c.a.createElement(b,{type:"file-text-o"})),c.a.createElement(q,{key:"{data.id}-title",content:d.title?d.title:"\u65e0\u6807\u9898",contentType:"text",tagName:"h1",handleContentUpdated:function(e){return Y(r,{title:e.text},W)}}))),j&&c.a.createElement("div",{className:"description"},c.a.createElement(q,{key:"{data.id}-description",content:d.description?d.description:"\u8bf7\u586b\u5199\u6587\u7ae0\u63cf\u8ff0",contentType:"text",tagName:"div",handleContentUpdated:function(e){return Y(r,{description:e.text})}}))),c.a.createElement("div",{className:"content"},c.a.createElement("section",null,c.a.createElement(G.a,{renderers:{code:te},source:d.content?d.content:"> \u8bf7\u7f16\u8f91\u6587\u7ae0\u5185\u5bb9"}),c.a.createElement("div",{className:"editor-button"},c.a.createElement(z.a,{type:"primary",size:"small",disabled:P,icon:c.a.createElement(b,{type:"edit"}),onClick:$},"\u7f16\u8f91"))),N&&c.a.createElement("section",null,c.a.createElement("div",{className:"title"},c.a.createElement("h2",null,"\u8bc4\u8bba")),c.a.createElement(Oe,{id:r}))),J.length>0&&c.a.createElement("section",{className:"children"},c.a.createElement("h2",null,"\u6587\u7ae0\u5217\u8868"),c.a.createElement("ul",null,J)),c.a.createElement("footer",null),c.a.createElement(pe,{articleID:r,visable:P,markdownContent:d.content,afterModalCloseHandle:Q,handleContentUpdated:function(e){return Y(r,{content:e})}}))},ke=(a(109),a(46)),Se=(a(153),a(83)),Ce=(a(215),a(97)),Ne=(a(293),a(175));function we(e,t){var a=new URLSearchParams(t),n={};return e.forEach((function(e){n[e]=a.get(e)})),n}var xe=function e(t){var a=this;Object(f.a)(this,e),this.get=function(e){return a.params[e]},this.set=function(e,t){a.params[e]=t},this.parse=function(e){return"string"!==typeof e?{}:("?"===e[0]&&(e=e.slice(1)),decodeURI(e).split("&").map((function(e){var t=e.split("="),a=t[0],n=t[1]||!0;return"string"===typeof n&&!1===isNaN(Number(n))&&(n=Number(n)),{key:a,value:n}})).reduce((function(e,t){var a=t.key,n=t.value;return"undefined"===typeof e[a]?e[a]=n:(e[a]=Array.isArray(e[a])?e[a]:[e[a]],e[a].push(n)),e}),{}))},this.url=t,this.params=this.parse(t)};window.URLSearchParams;var De=xe;function Ie(e,t,a,n){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(void 0===c||null===c)I.Get(e).then((function(r){var l=!1;if(r instanceof Array)c=r,l=!0;else{var o=r.results;o instanceof Array&&(c=o,l=!0)}l&&Ie(e,t,a,n,c)})).catch((function(e){return console.log(e)}));else{var r=c.map((function(e){return{text:e[t],value:e[a]}}));n(r)}}var Pe=function(e){H.a.error("\u53d6\u6d88\u5220\u9664",3)},_e=["#108ee9","blue","geekblue","green","gold"];var Me=function(e){var t=this,a=Object(n.useMemo)((function(){return["page","search","ordering","parent","level","is_deleted"]}),[]),r=Object(n.useContext)(u).setNavData,l=Object(n.useState)({}),i=Object(m.a)(l,2),s=i[0],d=i[1],p=Object(n.useState)([]),f=Object(m.a)(p,2),h=f[0],g=f[1],E=Object(n.useState)({current:1,total:0}),v=Object(m.a)(E,2),y=v[0],O=v[1],j=Object(n.useState)(!1),k=Object(m.a)(j,2),S=k[0],C=k[1],N=Object(n.useState)([]),w=Object(m.a)(N,2),x=w[0],D=w[1],P=Object(n.useState)({}),_=Object(m.a)(P,2),M=_[0],A=_[1],R=Object(n.useCallback)((function(t){if(S){if(h.length>0)return}else C(!0);t=isNaN(t)||!t?1:parseInt(t,10);var n="/api/v1/docs/category/list?page=".concat(t),c=e.location.search,r=we(a,c);a.forEach((function(e){var t=r[e];void 0!==t&&null!==t&&"page"!==e&&(n="".concat(n,"&").concat(e,"=").concat(t))})),I.Get(n).then((function(e){var a=e.results;a instanceof Array?(g(a),C(!1),O({current:t,total:e.count})):(C(!1),H.a.error(JSON.stringify(e),5))})).catch((function(e){console.log(e),C(!1)}))}),[h.length,S,a,e.location.search]);Object(n.useEffect)((function(){var t=e.location.search;if(t!==M.locationSearch){var n=we(a,t);d(n),A((function(e){return e.locationSearch=t,e})),R(n.page)}}),[a,e.location,s,M,R]),Object(n.useEffect)((function(){var e,t;void 0===M.userCanAddCategory&&(e="userCanAddCategory",t=A,I.Post("/api/v1/account/permission/check",{},{data:{permission:"docs.add_category"}}).then((function(a){t((function(t){return t[e]=a.result,t}))})).catch((function(e){return console.log(e)})))}),[M.userCanAddCategory]),Object(n.useEffect)((function(){M.parentFilterOptionsLock||(Ie("/api/v1/docs/category/all?level=1","name","id",D,null),A((function(e){return e.parentFilterOptionsLock=!0,e})))}),[M.parentFilterOptionsLock]),Object(n.useEffect)((function(){r([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863",link:"/docs/category"},{title:"\u5217\u8868"}])}),[r]);var F=Object(n.useCallback)((function(e){var t="/api/v1/docs/category/".concat(e.id);I.Delete(t).then((function(t){if(204!==t.status)return 200===t.status||H.a.success("\u5220\u9664\u5206\u7c7b(ID:".concat(e.id,"-").concat(e.name,"-").concat(e.code,")\u5931\u8d25\uff01"),3),t.json();H.a.success("\u5220\u9664\u5206\u7c7b(ID:".concat(e.id,"-").concat(e.name,"-").concat(e.code,")\u6210\u529f"),3),R(y.current)})).then((function(e){e&&(e.message?H.a.warn(e.message,8):H.a.error(JSON.stringify(e),3))})).catch((function(e){console.log(e)}))}),[R,y]),U=Object(n.useCallback)((function(t){var n;n=t?"/docs/category/list?page=1&search=".concat(t):"/docs/category/list?page=1",a.forEach((function(e){if("search"!==e&&"page"!==e){var t=s[e];void 0!==t&&null!==t&&(n="".concat(n,"&").concat(e,"=").concat(t))}})),e.history.push(n)}),[a,e.history,s]),L=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){return e.id-t.id},render:function(e,t){return c.a.createElement(o.b,{to:"/docs/category/".concat(t.id)},e)}},{title:"\u5206\u7c7b\u540d",dataIndex:"name",key:"name"},{title:"\u4ee3\u7801",dataIndex:"code",key:"code"},{title:"\u7236\u7ea7\u5206\u7c7b",dataIndex:"parent",key:"parent",filters:x||[],filterMultiple:!1,render:function(e,t){return c.a.createElement(Ne.a,{color:t.level<=_e.length?_e[t.level-1]:""},t.level>1?e:"\u4e00\u7ea7\u5206\u7c7b")}},{title:"\u6240\u6709\u8005",dataIndex:"owner",key:"owner",width:100,sorter:function(){}},{title:"\u63cf\u8ff0",dataIndex:"description",key:"description",ellipsis:!0},{title:"\u72b6\u6001",dataIndex:"is_deleted",key:"is_deleted",render:function(e){return e?c.a.createElement("span",{className:"status"},c.a.createElement(b,{type:"close"})):c.a.createElement("div",{className:"status"},c.a.createElement(b,{type:"check"}))},filters:[{text:"\u6709\u6548",value:"false"},{text:"\u7981\u7528",value:"true"}],filterMultiple:!1,onFilter:function(e,t){return t.is_deleted.toString()===e}},{title:"\u64cd\u4f5c",key:"action",width:300,render:function(e,t){return M.userCanAddCategory?c.a.createElement("span",null,c.a.createElement(o.b,{to:"/docs/category/".concat(e.id)},c.a.createElement(z.a,{type:"link",size:"small"},c.a.createElement(b,{type:"link"}," \u8be6\u60c5"))),c.a.createElement(Ce.a,{type:"vertical"}),c.a.createElement(o.b,{to:"/docs/category/".concat(e.id,"/editor")},c.a.createElement(z.a,{type:"link",size:"small"},c.a.createElement(b,{type:"edit"}," \u7f16\u8f91"))),c.a.createElement(Ce.a,{type:"vertical"}),c.a.createElement(Se.a,{title:"\u662f\u5426\u5220\u9664\u5206\u7c7b(ID:".concat(e.id,"-").concat(e.name,"-").concat(e.code,")"),onCancel:Pe,onConfirm:function(){return F(e)}},c.a.createElement("span",{type:"link"},c.a.createElement(z.a,{type:"link",size:"small",danger:!0,disabled:e.is_deleted},c.a.createElement(b,{type:"trash-o"}," \u5220\u9664"))))):c.a.createElement("span",null,c.a.createElement(o.b,{to:"/docs/category/".concat(e.id)},c.a.createElement(z.a,{type:"link",size:"small"},c.a.createElement(b,{type:"link"}," \u8be6\u60c5"))))}}]}),[F,M.userCanAddCategory,x]),K=Object(n.useMemo)((function(){return{expandedRowRender:function(e){return e.children.length>0?c.a.createElement(ke.a,{showHeader:!1,bordered:!1,dataSource:e.children,rowKey:"id",size:"small",columns:L,pagination:!1,expandable:K}):null},rowExpandable:function(e){return e.children.length>0}}}),[L]),T=Object(n.useCallback)((function(a,n,c){var r=a.current,l=["is_deleted","parent"],o={};l.forEach((function(e){var t=n[e];o[e]=t?t instanceof Array?t[0]:t:null}));var i="/docs/category/list?page=".concat(r);s.search&&(i="".concat(i,"&search=").concat(t.state.search)),l.forEach((function(e){var t=o[e];t&&(i="".concat(i,"&").concat(e,"=").concat(t))})),c&&c.columnKey&&(i="ascend"===c.order?"".concat(i,"&ordering=").concat(c.columnKey):"".concat(i,"&ordering=-").concat(c.columnKey)),e.history.push(i)}),[e.history,s.search]),B=Object(n.useMemo)((function(){return M.userCanAddCategory?c.a.createElement(o.b,{to:"/docs/category/add"},c.a.createElement(z.a,{style:{width:100},type:"primary",icon:c.a.createElement(b,{type:"plus"})},"Add")):null}),[M.userCanAddCategory]),G=Object(n.useMemo)((function(){return c.a.createElement(z.a,{style:{width:100},onClick:function(){var t;t=1!==s.level&&"1"!==s.level?"/docs/category/list?level=1":"/docs/category/list",e.history.push(t)},type:"primary",icon:c.a.createElement(b,{type:"filter"})},1!==s.level&&"1"!==s.level?"\u4e00\u7ea7\u5206\u7c7b":"\u5168\u90e8\u5206\u7c7b")}),[e.history,s.level]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6587\u6863\u5206\u7c7b")),c.a.createElement(ae.a,{className:"tools"},c.a.createElement(ne.a,{span:12},c.a.createElement(ce.a.Search,{placeholder:"search category",style:{width:200},onSearch:U})),c.a.createElement(ne.a,{span:12,style:{textAlign:"right"}},c.a.createElement(z.a,{type:"default",style:{width:100},icon:c.a.createElement(b,{type:"refresh"}),onClick:function(){return R(y.current)}},"\u5237\u65b0"),G,B)),c.a.createElement("div",{className:"main-list"},c.a.createElement(ke.a,{columns:L,dataSource:h,rowKey:"id",pagination:y,onChange:T,expandable:K}))))},Ae=(a(873),a(327)),Re=(a(154),a(28)),Fe={labelCol:{xs:{span:24},sm:{span:5},md:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15},md:{span:14}}},Ue={wrapperCol:{offset:8,span:8}};var Le=function(e){var t=e.checkValues,a=e.checkValuesState,r=e.dataSourceUrl,l=e.columns,o=e.rowKey,i=void 0===o?"id":o,s=e.isMultiple,u=void 0===s||s,d=e.disabledKeys,p=void 0===d?[]:d,f=e.showSubs,h=void 0!==f&&f,g=e.subsKey,E=void 0===g?"subs":g,v=Object(n.useState)(null),b=Object(m.a)(v,2),y=b[0],O=b[1];Object(n.useEffect)((function(){r!==y&&(O(r),r&&P(r,1))}),[y,r]);var j=Object(n.useState)([]),k=Object(m.a)(j,2),S=k[0],C=k[1],N=Object(n.useState)({current:1,total:0}),w=Object(m.a)(N,2),x=w[0],D=w[1],P=function(e,t){var a=e;a=a.indexOf("?")>0?"".concat(a,"&page=").concat(t):"".concat(a,"?page=").concat(t),I.Get(a).then((function(e){if(e instanceof Array)C(e);else{var a=e.results;a instanceof Array&&(C(a),D({current:t,total:e.count}))}})).catch((function(e){console.log(e)}))},_={hideDefaultSelections:!0,selectedRowKeys:t||[],onChange:function(e){a(e)},type:u?"checkbox":"radio",getCheckboxProps:function(e){return{disabled:function(){if(p&&p instanceof Array)for(var t=0;t<p.length;t++)if(e[i]===p[t])return!0;return!1}(),name:e[i]?e[i].toString():"---"}}},M={expandedRowRender:function(e){return e[E].length>0?c.a.createElement(ke.a,{showHeader:!1,bordered:!1,dataSource:e[E],rowKey:i,size:"small",rowSelection:_,columns:l,pagination:!1,expandable:h?M:void 0}):null},rowExpandable:function(e){return e[E].length>0}};return c.a.createElement("div",null,c.a.createElement(ke.a,{title:function(){return t.length>0?"\u5f53\u524d\u9009\u4e2d\u7684\u503c\u6709\uff1a".concat(JSON.stringify(t)):null},columns:l,dataSource:S,pagination:x,onChange:function(e,t,a,n){var c=e.current;P(r,c)},rowKey:i,rowSelection:_,bordered:!0,expandable:h?M:void 0}))},Ke=(a(292),a(89));var Te=function(e){var t=Object(n.useState)(0),a=Object(m.a)(t,2),r=a[0],l=a[1];return Object(n.useEffect)((function(){e.checkValues!==r&&l(e.checkValues)}),[e.checkValues,r]),c.a.createElement("div",{style:{display:"flex"}},c.a.createElement(Ke.a,{style:{flex:1},allowClear:!0,showSearch:!0,model:e.isMultiple?"multiple":"",value:r||[],onChange:function(t){var a;t||(t=[]),l(t),e.checkValuesState&&e.checkValuesState(t),a={data:t,value:t},e.onChange&&e.onChange(Object(O.a)({value:r},e.value,{},a))}},e.checkValues instanceof Array&&e.checkValues.map((function(e,t){return c.a.createElement(Ke.a.Option,{key:t,value:e},e)}))),c.a.createElement(z.a,{type:"primary",style:{width:80},onClick:e.onButtonClick},"\u9009\u62e9"))};var ze=function(e){var t=c.a.createRef(),a=Object(n.useState)({order:1,is_deleted:!1}),r=Object(m.a)(a,2),l=r[0],o=r[1],i=Object(n.useState)([]),s=Object(m.a)(i,2),u=s[0],d=s[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),h=f[0],g=f[1],E=Object(n.useState)([]),v=Object(m.a)(E,2),b=v[0],y=v[1];Object(n.useEffect)((function(){if(l!==e.data&&e.data&&(o(e.data),e.data.id>0&&"editor"===e.type)){var a=e.data;e.data.parent?a.parent=e.data.parent:a.parent="",t.current.setFieldsValue(a),y([e.data.parent])}}),[e.data,e.type,l,t,e]),Object(n.useEffect)((function(){b instanceof Array&&t.current.setFieldsValue({parent:b})}),[b,t]);var O=Object(n.useCallback)((function(){g(!1),t.current.setFieldsValue({parent:b})}),[b,t]),j=Object(n.useCallback)((function(t){t.image=u,t.parent?t.parent instanceof Array&&(t.parent.length>0?t.parent=t.parent[0]:t.parent=""):t.parent="",e.handleSubmit?e.handleSubmit(t):H.a.error("\u6ca1\u4f20\u9012\u8868\u5355\u63d0\u4ea4\u5904\u7406\u51fd\u6570",5)}),[u,e]),k=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){return e.id-t.id}},{title:"\u5206\u7c7b\u540d",dataIndex:"name",key:"name"},{title:"\u4ee3\u7801",dataIndex:"code",key:"code"},{title:"\u7236\u7ea7\u5206\u7c7b",dataIndex:"parent",key:"parent"},{title:"\u63cf\u8ff0",dataIndex:"description",key:"description"}]}),[]);return c.a.createElement(Re.a,{ref:t,onFinish:j,initialValues:l},c.a.createElement(ae.a,null,c.a.createElement(ne.a,{xs:24,sm:24,md:24},c.a.createElement(Re.a.Item,Object.assign({},Fe,{label:"\u5206\u7c7b\u540d",name:"name",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5206\u7c7b\u540d"}]}),c.a.createElement(ce.a,{placeholder:"name"})),c.a.createElement(Re.a.Item,Object.assign({},Fe,{label:"Code",name:"code",rules:[{required:"editor"!==e.type,message:"\u8bf7\u586b\u5199\u5206\u7c7b\u7684code"}]}),c.a.createElement(ce.a,{placeholder:"code",disabled:"editor"===e.type})),c.a.createElement(Re.a.Item,Object.assign({},Fe,{label:"\u7236\u7ea7\u5206\u7c7b",name:"parent",rules:[{required:!1,message:"\u8bf7\u586b\u5199\u7236\u7ea7\u5206\u7c7b"}]}),c.a.createElement(Te,{checkValues:b,checkValuesState:y,onButtonClick:function(){return g(!0)},isMultiple:!1})),c.a.createElement(Re.a.Item,Object.assign({},Fe,{label:"\u6392\u5e8f",name:"order",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5206\u7c7b\u7684\u6392\u5e8f"}]}),c.a.createElement(Ae.a,{min:1,max:100})),c.a.createElement(Re.a.Item,Object.assign({},Fe,{label:"\u63cf\u8ff0",name:"description",rules:[{required:!0,message:"\u8bf7\u63cf\u8ff0\u4e00\u4e0b\u5f53\u524d\u5206\u7c7b"}]}),c.a.createElement(ce.a.TextArea,{rows:4,autoSize:{minRows:4,maxRows:20},placeholder:"description"})),c.a.createElement(Re.a.Item,Object.assign({style:{display:"editor"===e.type?"show":"none"}},Fe,{label:"\u6dfb\u52a0\u65f6\u95f4",rules:[{required:!0,message:"\u8bf7\u63cf\u8ff0\u4e00\u4e0b\u5f53\u524d\u5206\u7c7b"}]}),c.a.createElement(ce.a,{value:l.time_added?l.time_added:null,disabled:!0})),c.a.createElement(Re.a.Item,Object.assign({},Fe,{label:"\u56fe\u7247",name:"image",rules:[{required:!1,message:"\u8bf7\u586b\u5199\u56fe\u7247"}]}),c.a.createElement(oe,{url:l.image,fileListData:u,setFileListData:d})),c.a.createElement(Re.a.Item,Object.assign({},Fe,{label:"\u72b6\u6001",name:"is_deleted",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u72b6\u6001"}]}),c.a.createElement(ge.a.Group,{buttonStyle:"solid"},c.a.createElement(ge.a.Button,{value:!1},"\u6709\u6548"),c.a.createElement(ge.a.Button,{value:!0},"\u7981\u7528"))),c.a.createElement(Re.a.Item,Object.assign({style:{textAlign:"center"}},Ue),c.a.createElement(z.a,{type:"primary",htmlType:"submit"},"editor"===e.type?"\u7f16\u8f91":"\u6dfb\u52a0")))),c.a.createElement($.a,{title:"\u8bf7\u9009\u62e9\u7236\u7ea7\u5206\u7c7b",visible:h,width:"60%",onOk:O,onCancel:function(){g(!1)}},c.a.createElement(Le,{checkValues:b,checkValuesState:y,dataSourceUrl:"/api/v1/docs/category/list?level=1",columns:k,rowKey:"code",isMultiple:!1,disabledKeys:[l.code],showSubs:!0,subsKey:"children"})))};var He=function(e){var t=Object(n.useContext)(u).setNavData;return Object(n.useEffect)((function(){t([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863\u5206\u7c7b",link:"/docs/category"},{title:"\u6dfb\u52a0"}])}),[t]),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6dfb\u52a0\u5206\u7c7b")),c.a.createElement(ze,{data:{},type:"add",handleSubmit:function(t){var a=new FormData;for(var n in t){var c=t[n];if("image"===n){if(c instanceof Array)for(var r=0;r<c.length;r++)a.append("image",c[r])}else a.append(n,c)}I.Post("/api/v1/docs/category/create",a,{}).then((function(t){t.id>0?(H.a.success("\u6dfb\u52a0\u5206\u7c7b(id:".concat(t.id,")\u6210\u529f"),5),e.history.push("/docs/category/".concat(t.id))):(H.a.warn("\u6dfb\u52a0\u5206\u7c7b\u5931\u8d25",5),H.a.error(JSON.stringify(t),8))})).catch((function(e){H.a.error("\u6dfb\u52a0\u5206\u7c7b\u51fa\u9519",5),console.log(e)}))}})))},Be=(a(877),a(220)),Ge=Be.a.Item,Ve=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e,t,a=this.props.data;if(1===a.action_flag)e="\u6dfb\u52a0",t="\u6dfb\u52a0\u5bf9\u8c61";else if(2===a.action_flag){e="\u4fee\u6539";var n=a.message;t=n instanceof Array?n.map((function(e,t){var a=e.value_old instanceof Array?e.value_old.join(","):e.value_old,n=e.value_new instanceof Array?e.value_new.join(","):e.value_new?e.value_new.toString():"null";return c.a.createElement("div",{className:"changed-message",key:t},c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"field"},"\u5b57\u6bb5\uff1a",e.field),c.a.createElement("div",{className:"value-old"},a),c.a.createElement("div",{className:"value-new"},n)))})):"\u4fee\u6539\u5bf9\u8c61"}else{if(3!==a.action_flag)return null;e="\u5220\u9664",t="\u5220\u9664\u5bf9\u8c61"}return c.a.createElement("div",{className:"modlelog-item"},c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u7528\u6237:"),c.a.createElement("span",{className:"value"},a.user)),c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u64cd\u4f5c:"),c.a.createElement("span",{className:"value"},e)),c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u4fe1\u606f:"),c.a.createElement("span",{className:"value"},t)),c.a.createElement("div",{className:"row info"},c.a.createElement("span",{className:"config"},"\u65f6\u95f4:"),c.a.createElement("span",{className:"value time"},a.time_added)))}}]),t}(c.a.Component),qe=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).fetchData=function(){if(a.state.nextPage){if(a.state.loading)return;a.setState({loading:!0});var e="/api/v1/modellog/".concat(a.state.app,"/").concat(a.state.model,"/").concat(a.state.id,"/list?page=").concat(a.state.nextPage);I.Get(e).then((function(e){var t,n,c=e.results,r=a.state.nextPage;(t=e.next?a.state.nextPage+1:null,c instanceof Array)?(n=1===r?c:a.state.datasource.concat(c),a.setState({nextPage:t,datasource:n,loading:!1})):a.setState({nextPage:t,loading:!1})})).catch((function(e){console.log(e),a.setState({loading:!1})}))}else console.log("\u5df2\u7ecf\u6ca1\u6709\u66f4\u591a\u65e5\u5fd7\u4fe1\u606f")},a.state={title:a.props.title?a.props.title:"\u64cd\u4f5c\u8bb0\u5f55",showNoContent:!!a.props.showNoContent,id:a.props.id,datasource:[],app:a.props.app,model:a.props.model,nextPage:1,loading:!1},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e,t,a){e.id===this.state.id&&t.app===this.state.app&&e.model===this.state.model||this.fetchData()}},{key:"render",value:function(){var e,t,a=this;return this.state.datasource&&(e=this.state.datasource.map((function(e,t){return 3===e.action_flag?c.a.createElement(Ge,{key:t,color:"red"},c.a.createElement(Ve,{data:e})):c.a.createElement(Ge,{key:t},c.a.createElement(Ve,{data:e}))}))),this.state.nextPage&&(t=c.a.createElement("div",{className:"more",onClick:function(){return a.fetchData()}},"\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a")),this.state.datasource.length>0?c.a.createElement("div",null,c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,this.state.title)),c.a.createElement("div",{className:"modellogs"},c.a.createElement(Be.a,null,e),t)):this.state.showNoContent?c.a.createElement("div",null,c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,this.state.title)),c.a.createElement("div",{className:"no-content border"},"\u65e0",this.state.title)):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.id!==t.id?{id:e.id,datasource:[],app:e.app,model:e.model,nextPage:1,loading:!1}:null}}]),t}(c.a.Component),Je=function(e){var t=e.onResize,a=e.width,r=Object(V.a)(e,["onResize","width"]),l=Object(n.useCallback)((function(e){e.stopPropagation()}),[]);return a?c.a.createElement(p.Resizable,{width:a,height:0,handle:c.a.createElement("span",{className:"react-resizable-handle react-resizable-handle-se",onClick:l}),onResize:t,draggableOpts:{enableUserSelectHack:!1}},c.a.createElement("th",r)):c.a.createElement("th",r)},We=function(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)(null),i=Object(m.a)(o,2),s=i[0],u=i[1],d=Object(n.useState)(1),p=Object(m.a)(d,2),f=p[0],h=p[1],g=Object(n.useState)({}),E=Object(m.a)(g,2),v=E[0],y=E[1],j=Object(n.useState)(0),k=Object(m.a)(j,2),S=k[0],C=k[1],N=Object(n.useState)([]),w=Object(m.a)(N,2),x=w[0],D=w[1],P=Object(n.useState)({}),_=Object(m.a)(P,2),M=_[0],A=_[1],R=Object(n.useState)([]),F=Object(m.a)(R,2),U=F[0],L=F[1];Object(n.useEffect)((function(){0===U.length&&e.columns&&L(e.columns)}),[U.length,e.columns]);var K=Object(n.useMemo)((function(){return e.paramsFields?e.paramsFields:[]}),[e.paramsFields]),T=Object(n.useCallback)((function(t){if(e.apiUrlPrefix){var a;t=isNaN(t)||!t?1:parseInt(t,10),a=e.apiUrlPrefix.indexOf>0?"".concat(e.apiUrlPrefix,"&page=").concat(t):"".concat(e.apiUrlPrefix,"?page=").concat(t);var n=e.location.search,c=we(K,n);K.forEach((function(e){var t=c[e];void 0!==t&&null!==t&&"page"!==e&&(a="".concat(a,"&").concat(e,"=").concat(t))})),I.Get(a,{},{}).then((function(e){var a=e.results;Array.isArray(a)?(D(a),C(e.count),h(t)):(H.a.warn("\u83b7\u53d6\u5206\u7c7b\u6587\u7ae0\u5217\u8868\u51fa\u9519"),H.a.warn(JSON.stringify(e)))})).catch((function(e){console.log(e)}))}}),[e.apiUrlPrefix,e.location.search]);Object(n.useEffect)((function(){e.apiUrlPrefix!==r&&e.apiUrlPrefix&&(l(e.apiUrlPrefix),T(v.page))}),[T,e.apiUrlPrefix]),Object(n.useEffect)((function(){e.pageUrlPrefix&&e.pageUrlPrefix!==s&&u(e.pageUrlPrefix)}),[s,e.pageUrlPrefix]),Object(n.useEffect)((function(){var t=e.location.search;if(t!==M.locationSearch){var a=we(K,t);y(a),A((function(e){return e.locationSearch=t,e})),r&&T(a.page)}}),[K,e.location,v,M,T,r]);var B=Object(n.useCallback)((function(t){var a;a=e.pageUrlPrefix.indexOf("?")>0?"".concat(e.pageUrlPrefix,"&page=1"):"".concat(e.pageUrlPrefix,"?page=1"),t&&(a="".concat(a,"&search=").concat(t)),K.forEach((function(e){if("search"!==e&&"page"!==e){var t=v[e];void 0!==t&&null!==t&&(a="".concat(a,"&").concat(e,"=").concat(t))}})),e.history.push(a)}),[e.pageUrlPrefix,K,e.history,v]),G=Object(n.useCallback)((function(t,a,n){if(s){var c,r=t.current,l=e.filterColumns?e.filterColumns:[],o={};l.forEach((function(e){var t=a[e];o[e]=t?t instanceof Array?t[0]:t:null})),c=s.indexOf("?")>0?"".concat(s,"&page=").concat(r):"".concat(s,"?page=").concat(r),v.search&&(c="".concat(c,"&search=").concat((void 0).state.search)),l.forEach((function(e){var t=o[e];t&&(c="".concat(c,"&").concat(e,"=").concat(t))})),n&&n.columnKey&&(c="ascend"===n.order?"".concat(c,"&ordering=").concat(n.columnKey):"".concat(c,"&ordering=-").concat(n.columnKey)),e.history.push(c)}}),[s,e.filterColumns,e.history,v.search]),V=Object(n.useCallback)((function(e){return function(t,a){var n=a.size;L((function(t){var a=Object(Ee.a)(t);return a[e]=Object(O.a)({},a[e],{width:n.width}),a}))}}),[]),q=Object(n.useMemo)((function(){return U.map((function(e,t){return Object(O.a)({},e,{onHeaderCell:function(e){return{width:e.width,onResize:V(t)}}})}))}),[U,V]),J=Object(n.useMemo)((function(){return{header:{cell:Je}}}),[]);return c.a.createElement("div",{className:"base-table"},c.a.createElement(ae.a,{className:"tools"},c.a.createElement(ne.a,{sm:{span:12},xs:{span:24}},c.a.createElement(ce.a.Search,{placeholder:v.search?v.search:"search",style:{width:200},onSearch:B,enterButton:!0})),c.a.createElement(ne.a,{sm:{span:12},xs:{span:24},style:{textAlign:"right"}},c.a.createElement(z.a,{type:"default",style:{width:100},icon:c.a.createElement(b,{type:"refresh"}),onClick:function(){return T(f)}},"\u5237\u65b0"))),c.a.createElement(ke.a,{rowKey:"id",components:J,bordered:!0,columns:q,dataSource:x,pagination:{total:S,current:f},onChange:G}))};var Ye=function(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)({}),s=Object(m.a)(i,2),d=s[0],p=s[1],f=Object(n.useState)(!1),h=Object(m.a)(f,2),g=h[0],E=h[1],v=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){var t=e.match.params.id;t!==r&&(l(t),function(e){var t="/api/v1/docs/category/".concat(e);I.Get(t).then((function(e){p(e),E(!0),document.title="".concat(e.name,"-\u5206\u7c7b-\u770b\u677f")})).catch((function(e){E(!0),console.log(e)}))}(e.match.params.id))}),[e,r]),Object(n.useEffect)((function(){v([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863\u5206\u7c7b",link:"/docs/category"},{title:"\u8be6\u60c5"}])}),[v]);var y=Object(n.useMemo)((function(){if(d.users_permisson&&d.users_permisson.length>0){var e=d.users_permisson.map((function(e,t){return c.a.createElement(Ne.a,{key:e.id,color:e.is_active?"blue":""},e.user,c.a.createElement(Ce.a,{type:"vertical"}),e.permission)}));return c.a.createElement("div",{style:{margin:"3px 0"}},e)}return c.a.createElement("span",null,"\u65e0\u7528\u6237")}),[d.users_permisson]),O=Object(n.useMemo)((function(){return["page","search","ordering","parent","level","is_deleted"]}),[e.match.params.id]),j=Object(n.useMemo)((function(){return["is_deleted","parent"]}),[]),k=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){},render:function(e,t){return c.a.createElement(o.b,{to:"/docs/article/".concat(e)},e)},ellipsis:!0,width:50},{title:"\u6807\u9898",dataIndex:"title",key:"title",width:250,ellipsis:!0},{title:"\u7236\u7ea7\u9875\u9762",dataIndex:"parent",key:"parent",width:180,ellipsis:!0,render:function(e,t){return e?c.a.createElement(o.b,{to:"/docs/article/".concat(e.id)},c.a.createElement(b,{type:"link"}),e.title):c.a.createElement("div",null,"---")}},{title:"\u6dfb\u52a0\u8005",dataIndex:"user",key:"user",width:100,ellipsis:!0,sorter:function(){}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"time_added",key:"time_added",width:180,ellipsis:!0,sorter:function(e,t){}},{title:"\u64cd\u4f5c",key:"action",ellipsis:!0,render:function(e,t){return c.a.createElement("div",null,c.a.createElement(o.b,{to:"/docs/article/".concat(t.id)},c.a.createElement(b,{type:"link"}),"\u67e5\u770b\u8be6\u60c5"))}}]}),[]);return g?c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ae.a,{gutter:16},c.a.createElement(ne.a,{xs:{span:24},sm:{span:16},lg:{span:18}},c.a.createElement(ae.a,{className:"title"},c.a.createElement("h4",null,"\u6587\u6863\u5206\u7c7b\u8be6\u60c5")),c.a.createElement("div",{className:"info-property"},c.a.createElement("dl",null,c.a.createElement("dt",null,"\u540d\u79f0"),c.a.createElement("dd",null,d.name)),c.a.createElement("dl",null,c.a.createElement("dt",null,"Code"),c.a.createElement("dd",null,d.code)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u7236\u7ea7\u5206\u7c7b"),c.a.createElement("dd",null,d.parent?d.parent:"---")),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u72b6\u6001"),c.a.createElement("dd",{className:"status"},c.a.createElement(b,{type:d.is_deleted?"close":"check"}))),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u6240\u6709\u8005"),c.a.createElement("dd",null,d.owner)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u7528\u6237"),c.a.createElement("dd",null,y)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u63cf\u8ff0"),c.a.createElement("dd",null,d.description)),d.image&&c.a.createElement("dl",null,c.a.createElement("dt",null),c.a.createElement("dd",null,c.a.createElement("img",{alt:"\u56fe\u7247",src:d.image}))),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u6dfb\u52a0\u65f6\u95f4"),c.a.createElement("dd",null,d.time_added))),c.a.createElement("div",null,c.a.createElement(ae.a,{className:"title"},c.a.createElement("h4",null,"\u6587\u7ae0\u5217\u8868")),c.a.createElement(We,{columns:k,filterColumns:j,paramsFields:O,location:e.location,history:e.history,apiUrlPrefix:r?"/api/v1/docs/category/".concat(r,"/articles"):null,pageUrlPrefix:"/docs/category/".concat(r)}))),c.a.createElement(ne.a,{xs:{span:24},sm:{span:8},lg:{span:6}},d.id>0&&c.a.createElement(qe,{app:"docs",model:"category",id:d.id}))))):c.a.createElement(he,{size:"large"})};var $e=function(e){var t=Object(n.useState)(null),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)({}),i=Object(m.a)(o,2),s=i[0],d=i[1],p=Object(n.useContext)(u).setNavData;Object(n.useEffect)((function(){e.match.params.id!==r&&(l(e.match.params.id),f(e.match.params.id))}),[e.match.params.id,r]);var f=function(e){var t="/api/v1/docs/category/".concat(e);I.Get(t).then((function(e){e.id>0&&d(e)})).catch((function(e){console.log(e),H.a.warn("\u83b7\u53d6\u8be6\u60c5\u6570\u636e\u5931\u8d25",5)}))};return Object(n.useEffect)((function(){p([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u6587\u6863\u5206\u7c7b",link:"/docs/category"},{title:"\u7f16\u8f91"}])}),[p]),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u7f16\u8f91\u5206\u7c7b")),c.a.createElement(ze,{data:s,type:"editor",handleSubmit:function(t){var a="/api/v1/docs/category/".concat(r),n=new FormData;for(var c in t){var l=t[c];if("image"===c){if(l instanceof Array)for(var o=0;o<l.length;o++)n.append("image",l[o])}else n.append(c,l)}I.Patch(a,n,{}).then((function(t){t.id>0?(H.a.success("\u4fee\u6539\u5206\u7c7b(id:".concat(t.id,")\u6210\u529f"),5),e.history.push("/docs/category/".concat(t.id))):(H.a.warn("\u4fee\u6539\u5206\u7c7b(id:".concat(t.id,")\u5931\u8d25"),5),H.a.error(JSON.stringify(t),8))})).catch((function(e){console.log(e),H.a.error("\u4fee\u6539\u5206\u7c7b(id:".concat(s.id,")\u51fa\u9519"),5)}))}})))},Qe=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),r=a[0],l=a[1];Object(n.useEffect)((function(){e.match.params.id!==r&&l(e.match.params.id)}),[r,e.match.params.id,l]);var i=Object(n.useMemo)((function(){return["page","search","ordering","parent","level","is_deleted"]}),[e.match.params.id]),s=Object(n.useMemo)((function(){return["is_deleted","parent"]}),[]),u=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){},render:function(e,t){return c.a.createElement(o.b,{to:"/docs/article/".concat(e)},e)},ellipsis:!0,width:50},{title:"\u6807\u9898",dataIndex:"title",key:"title",width:250,ellipsis:!0},{title:"\u7236\u7ea7\u9875\u9762",dataIndex:"parent",key:"parent",width:180,ellipsis:!0,render:function(e,t){return e?c.a.createElement(o.b,{to:"/docs/article/".concat(e.id)},c.a.createElement(b,{type:"link"}),e.title):c.a.createElement("div",null,"---")}},{title:"\u6dfb\u52a0\u8005",dataIndex:"user",key:"user",width:100,ellipsis:!0,sorter:function(){}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"time_added",key:"time_added",width:180,ellipsis:!0,sorter:function(e,t){}},{title:"\u64cd\u4f5c",key:"action",ellipsis:!0,render:function(e,t){return c.a.createElement("div",null,c.a.createElement(o.b,{to:"/docs/article/".concat(t.id)},c.a.createElement(b,{type:"link"}),"\u67e5\u770b\u8be6\u60c5"))}}]}),[]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ae.a,{className:"title"},c.a.createElement("h4",null,"\u6587\u7ae0\u5217\u8868")),c.a.createElement(We,{columns:u,filterColumns:s,paramsFields:i,categoryID:r,location:e.location,history:e.history,apiUrlPrefix:r?"/api/v1/docs/category/".concat(r,"/articles"):null,pageUrlPrefix:"/docs/category/".concat(r,"/articles")})))},Xe=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).state={},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return c.a.createElement("div",null,"Article\u5217\u8868\u9875")}}]),t}(c.a.Component),Ze=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).state={},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return c.a.createElement("div",null,"\u6587\u7ae0Comment\u5217\u8868\u9875")}}]),t}(c.a.Component),et=function(e){var t=Object(n.useMemo)((function(){return["page","search","ordering","parent","is_deleted"]}),[]),a=Object(n.useMemo)((function(){return["is_deleted"]}),[]),r=Object(n.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){},width:50},{title:"\u7c7b\u578b",dataIndex:"category",key:"category",width:100,ellipsis:!0},{title:"\u5185\u5bb9",dataIndex:"content",key:"content",width:260,ellipsis:!0},{title:"\u7528\u6237",dataIndex:"user",key:"user",width:100},{title:"\u65f6\u95f4",dataIndex:"time_added",key:"time_added",width:180,ellipsis:!0},{title:"\u72b6\u6001",dataIndex:"is_deleted",key:"is_deleted",width:100,render:function(e,t){return e?c.a.createElement("span",{className:"status"},c.a.createElement(b,{type:"close"})):c.a.createElement("span",{className:"status"},c.a.createElement(b,{type:"check"}))},filterMultiple:!1,filters:[{text:"\u6709\u6548",value:"false"},{text:"\u5df2\u5220\u9664",value:"true"}]},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return c.a.createElement("div",null,c.a.createElement("span",null,"-"))}}]}),[]);return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ae.a,{className:"title"},c.a.createElement("h4",null,"\u8ba8\u8bba\u5217\u8868")),c.a.createElement(We,{columns:r,filterColumns:a,paramsFields:t,location:e.location,history:e.history,apiUrlPrefix:"/api/v1/docs/discussion/list",pageUrlPrefix:"/docs/discussion/list"})))};var tt=function(e){return c.a.createElement(i.d,null,c.a.createElement(i.b,{exat:!0,path:"/docs/category/list",component:Me}),c.a.createElement(i.b,{exat:!0,path:"/docs/category/add",component:He}),c.a.createElement(i.b,{exat:!0,path:"/docs/category/:id/editor",component:$e}),c.a.createElement(i.b,{exat:!0,path:"/docs/category/:id/articles",component:Qe}),c.a.createElement(i.b,{exat:!0,path:"/docs/category/:id",component:Ye}),c.a.createElement(i.b,{exat:!0,path:"/docs/category",render:function(){return c.a.createElement(i.a,{to:"/docs/category/list",push:!1})}}),c.a.createElement(i.b,{exat:!0,path:"/docs/article/list",component:Xe}),c.a.createElement(i.b,{exat:!0,path:"/docs/article",render:function(){return c.a.createElement(i.a,{to:"/docs/article/list",push:!1})}}),c.a.createElement(i.b,{exat:!0,path:"/docs/comment/list",component:Ze}),c.a.createElement(i.b,{exat:!0,path:"/docs/comment",render:function(){return c.a.createElement(i.a,{to:"/docs/comment/list",push:!1})}}),c.a.createElement(i.b,{exat:!0,path:"/docs/discussion/list",component:et}),c.a.createElement(i.b,{exat:!0,path:"/docs/discussion",render:function(){return c.a.createElement(i.a,{to:"/docs/discussion/list",push:!1})}}))},at=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(c)))).logout=function(){I.Get("/api/v1/account/logout").then((function(e){"success"===e.status&&H.a.success("\u9000\u51fa\u767b\u5f55\u6210\u529f")})).catch((function(e){console.log(e)}))},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.logout()}},{key:"render",value:function(){return c.a.createElement(i.a,{to:"/user/login",push:!1})}}]),t}(c.a.Component),nt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).formRef=c.a.createRef(),a.updateFiedsValue=function(){a.formRef.current.setFieldsValue(a.state.data)},a.handleSubmit=function(e){a.props.handleSubmit(e)};var n=a.props.data?a.props.data:{};return a.state={data:n},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){e.data!==this.state.data&&this.updateFiedsValue()}},{key:"render",value:function(){var e={labelCol:{xs:{span:8},sm:{span:8},md:{span:8}},wrapperCol:{xs:{span:12},sm:{span:12},md:{span:12}}};return c.a.createElement(Re.a,{name:"userEditForm",onFinish:this.handleSubmit,initialValues:this.state.data,ref:this.formRef},c.a.createElement(ae.a,null,c.a.createElement(ne.a,{xs:24,sm:24},c.a.createElement(Re.a.Item,Object.assign({},e,{label:"\u7528\u6237\u540d",name:"username"}),c.a.createElement(ce.a,{placeholder:"\u7528\u6237\u540d",disabled:!0})),c.a.createElement(Re.a.Item,Object.assign({},e,{name:"is_active",label:"\u72b6\u6001",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u5f00\u542f\u7528\u6237!"}]}),c.a.createElement(ge.a.Group,{size:"small"},c.a.createElement(ge.a.Button,{value:!0},"\u5f00\u542f"),c.a.createElement(ge.a.Button,{value:!1},"\u7981\u7528"))),c.a.createElement(Re.a.Item,Object.assign({},e,{name:"can_view",label:"\u8bbf\u95ee\u6743\u9650",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u7ed9\u7528\u6237\u8bbf\u95ee\u6743\u9650!"}]}),c.a.createElement(ge.a.Group,{size:"small"},c.a.createElement(ge.a.Button,{value:!0},"\u80fd"),c.a.createElement(ge.a.Button,{value:!1},"\u5426"))),c.a.createElement(Re.a.Item,Object.assign({},e,{label:"\u8d85\u7ea7\u7528\u6237",name:"is_superuser",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u662f\u8d85\u7ea7\u7528\u6237!"}]}),c.a.createElement(ge.a.Group,{size:"small"},c.a.createElement(ge.a.Button,{value:!0},"\u662f"),c.a.createElement(ge.a.Button,{value:!1},"\u5426"))),c.a.createElement(Re.a.Item,Object.assign({},e,{label:"\u624b\u673a\u53f7",name:"mobile",rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7!",max:20}]}),c.a.createElement(ce.a,{placeholder:"mobile"})),c.a.createElement(Re.a.Item,Object.assign({},e,{label:"\u9489\u9489ID",name:"dingding",rules:[]}),c.a.createElement(ce.a,{placeholder:"dingding"})),c.a.createElement(Re.a.Item,Object.assign({},e,{label:"\u5fae\u4fe1ID",name:"wechart"}),c.a.createElement(ce.a,{placeholder:"wechart"}))),c.a.createElement(ne.a,{xs:24,sm:24,md:12})),c.a.createElement(Re.a.Item,{wrapperCol:{xs:{span:8,offset:8},sm:{span:8,offset:10}}},c.a.createElement(z.a,{type:"primary",htmlType:"submit"},"\u4fee\u6539")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data!==t.data?{data:e.data}:null}}]),t}(n.Component),ct=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).handleCancel=function(e){H.a.info("\u53d6\u6d88\u7f16\u8f91",3),a.setState({visible:!1,showLoading:!1}),a.props.afterHandler&&a.props.afterHandler(!1)},a.handleEditorSubmit=function(e){var t="/api/v1/account/user/".concat(a.state.data.id);I.Put(t,{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:e}).then((function(e){e.id===a.state.data.id?(H.a.success("\u4fee\u6539\u7528\u6237\u4fe1\u606f\u6210\u529f",5),a.setState({visible:!1,showLoading:!1}),a.props.afterHandler&&a.props.afterHandler()):(H.a.error(JSON.stringify(e),5),a.setState({showLoading:!1}))})).catch((function(e){a.setState({showLoading:!1}),H.a.error("\u7f16\u8f91\u51fa\u73b0\u9519\u8bef\uff01",5)}))},a.state={data:a.props.data?a.props.data:{},visible:a.props.visible,showLoading:!1},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return c.a.createElement($.a,{title:"\u7f16\u8f91\u7528\u6237",visible:this.state.visible,onCancel:this.handleCancel,footer:null},c.a.createElement(nt,{data:this.state.data,handleSubmit:this.handleEditorSubmit}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data!==t.data||e.visible!==t.visible?{data:e.data,visible:e.visible,showLoading:!1}:null}}]),t}(n.Component),rt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).fetchData=function(e){if(a.state.loaded)a.setState({loaded:!1});else if(a.state.dataSource.length>0)return;isNaN(e)&&(e=1);var t="/api/v1/account/user/list?page="+e;a.state.search&&(t="".concat(t,"&search=").concat(a.state.search)),a.state.ordering&&(t="".concat(t,"&ordering=").concat(a.state.ordering));["is_active","can_view","is_superuser"].forEach((function(e){var n=a.state[e];n&&(t="".concat(t,"&").concat(e,"=").concat(n))})),I.Get(t).then((function(t){var n=t.results;n instanceof Array?a.setState({dataSource:n,loaded:!0,dataCount:t.count,currentPage:e}):(a.setState({loaded:!0}),H.a.error(JSON.stringify(t),5))})).catch((function(e){console.log(e),a.setState({loaded:!0})}))},a.onSearchHandler=function(e){a.setState({search:e,currentPage:1},(function(){var t="/user/list?page=1";e&&(t="".concat(t,"&search=").concat(e));["is_active","can_view","is_superuser"].forEach((function(e){var n=a.state[e];n&&(t="".concat(t,"&").concat(e,"=").concat(n))})),a.state.ordering&&(t=t.indexOf("?")>0?"".concat(t,"&ordering=").concat(a.state.ordering):"".concat(t,"?ordering=").concat(a.state.ordering)),a.props.history.push(t)}))},a.editorOnClick=function(e){a.setState({visible:!0,currentUser:e})},a.deleteOnCancel=function(e){H.a.error("\u53d6\u6d88\u5220\u9664",3)},a.deleteOnConfirm=function(e){var t="/api/v1/account/user/".concat(e.id);I.Delete(t).then((function(t){if(204!==t.status)return 200===t.status||H.a.error("\u5220\u9664".concat(e.username,"\u5931\u8d25"),3),t.json();H.a.success("\u5220\u9664"+e.username+"\u6210\u529f\uff01",3),a.fetchData()})).then((function(e){e&&(e.message?H.a.warn(e.message,8):H.a.error(JSON.stringify(e),3))})).catch((function(e){console.log(e)}))},a.resetCurretUserState=function(e){a.setState({visible:!1,currentUser:{}},(function(){!1!==e&&a.fetchData()}))},a.changeShowDelete=function(){a.setState((function(e){return{showDelete:!e.showDelete}}))},a.handleTableChange=function(e,t,n){var c=e.current,r=["is_active","can_view","is_superuser"],l={is_active:null,can_view:null,is_superuser:null};r.forEach((function(e){var a=t[e];l[e]=a?a instanceof Array?a[0]:a:null}));var o="/user/list?page=".concat(c);a.state.search&&(o="".concat(o,"&search=").concat(a.state.search)),r.forEach((function(e){var t=l[e];t&&(o="".concat(o,"&").concat(e,"=").concat(t))})),n&&n.columnKey&&(o="ascend"===n.order?"".concat(o,"&ordering=").concat(n.columnKey):"".concat(o,"&ordering=-").concat(n.columnKey)),a.props.history.push(o)};var n=new De(a.props.location.search),c=n.get("page");return c=isNaN(c)?1:parseInt(c,10),a.state={currentPage:c,loaded:!1,dataSource:[],visible:!1,currentUser:{},dataCount:0,showDelete:!1,search:n.get("search"),ordering:n.get("ordering"),locationSearch:a.props.location.search,is_active:n.get("is_active"),can_view:n.get("can_view"),is_superuser:n.get("is_superuser")},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.fetchData(this.state.currentPage)}},{key:"componentDidUpdate",value:function(e,t,a){e.location.search!==this.state.locationSearch&&this.fetchData(this.state.currentPage)}},{key:"render",value:function(){var e=this,t=[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){return e.id-t.id}},{title:"\u7528\u6237\u540d",dataIndex:"username",key:"username"},{title:"\u72b6\u6001",dataIndex:"is_active",key:"is_active",render:function(e){return e?c.a.createElement("div",{className:"status"},c.a.createElement(b,{type:"check"})):c.a.createElement("span",{className:"status"},c.a.createElement(b,{type:"close"}))},filters:[{text:"\u542f\u7528",value:"true"},{text:"\u7981\u7528",value:"false"}],filterMultiple:!1,onFilter:function(e,t){return t.is_active.toString()===e}},{title:"\u8bbf\u95ee\u672c\u7ad9",dataIndex:"can_view",key:"can_view",render:function(e){return e?c.a.createElement("div",{className:"status"},c.a.createElement(b,{type:"check"})):c.a.createElement("span",{className:"status"},c.a.createElement(b,{type:"close"}))},filters:[{text:"\u80fd",value:"true"},{text:"\u5426",value:"false"}],filterMultiple:!1,onFilter:function(e,t){return t.is_active.toString()===e}},{title:"\u8d85\u7ea7\u7528\u6237",dataIndex:"is_superuser",key:"is_superuser",render:function(e){return e?c.a.createElement("div",{className:"status"},c.a.createElement(b,{type:"check"})):c.a.createElement("span",{className:"status"},c.a.createElement(b,{type:"close"}))},filters:[{text:"\u8d85\u7ea7\u7528\u6237",value:"true"},{text:"\u666e\u901a\u7528\u6237",value:"false"}],filterMultiple:!1,onFilter:function(e,t){return t.is_superuser.toString()===e}},{title:"\u624b\u673a\u53f7",dataIndex:"mobile",key:"mobile",render:function(e){return e?c.a.createElement("div",{className:"center"},e):c.a.createElement("div",{className:"center"},"---")}},{title:"\u52a0\u5165\u65f6\u95f4",dataIndex:"date_joined",key:"date_joined",sorter:function(e,t){return e.id-t.id}},{title:"Action",key:"action",render:function(t,a){if(e.state.showDelete){var n,r=c.a.createElement("span",null,c.a.createElement("p",null,"\u5220\u9664\u7528\u6237\u4e14\u7981\u6b62\u767b\u9646\uff01"),c.a.createElement("p",null,"\u60a8\u786e\u8ba4\u5220\u9664:".concat(t.username,"?")));return n=t.is_active?c.a.createElement(Se.a,{title:r,onCancel:e.deleteOnCancel,onConfirm:function(){return e.deleteOnConfirm(t)}},c.a.createElement("span",{type:"link"},c.a.createElement(z.a,{type:"link",size:"small",danger:!0},c.a.createElement(b,{type:"trash-o"}," \u5220\u9664")))):"\u5df2\u7981\u7528",c.a.createElement("span",null,c.a.createElement("span",{type:"link",onClick:function(){return e.editorOnClick(t)}},c.a.createElement(z.a,{type:"link",size:"small"},c.a.createElement(b,{type:"edit"}," \u7f16\u8f91"))),c.a.createElement("span",{className:"ant-divider"}),n)}return t.is_active?c.a.createElement("span",null,c.a.createElement("span",{type:"link",onClick:function(){return e.editorOnClick(t)}},c.a.createElement(z.a,{type:"link",size:"small"},c.a.createElement(b,{type:"edit"}," \u7f16\u8f91")))):c.a.createElement("span",null,c.a.createElement("span",{type:"link",onClick:function(){return e.editorOnClick(t)}},c.a.createElement(z.a,{type:"link",size:"small"},c.a.createElement(b,{type:"edit"}," \u7f16\u8f91"))),c.a.createElement(Ce.a,{type:"vertical"}),"\u5df2\u7981\u7528")}}];return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u7528\u6237\u5217\u8868")),c.a.createElement(ae.a,{className:"tools"},c.a.createElement(ne.a,{span:12},c.a.createElement(ce.a.Search,{placeholder:"search user",style:{width:200},onSearch:this.onSearchHandler})),c.a.createElement(ne.a,{span:12,style:{textAlign:"right"}},c.a.createElement(z.a,{type:"dashed",style:{width:100},icon:c.a.createElement(b,{type:"trash-o"}),danger:!0,onClick:this.changeShowDelete},this.state.showDelete?"\u9690\u85cf\u5220\u9664":"\u663e\u793a\u5220\u9664"),c.a.createElement(z.a,{style:{width:100},type:"default",icon:c.a.createElement(b,{type:"refresh"}),loading:!this.state.loaded,onClick:this.fetchData},"\u5237\u65b0"))),c.a.createElement("div",{className:"main-list"},c.a.createElement(ke.a,{columns:t,dataSource:this.state.dataSource,rowKey:"id",bordered:!0,pagination:{current:this.state.currentPage,total:this.state.dataCount},onChange:this.handleTableChange})),c.a.createElement(ct,{visible:this.state.visible,afterHandler:this.resetCurretUserState,data:this.state.currentUser})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.location.search!==t.locationSearch){var a=new De(e.location.search),n=a.get("page");return n=isNaN(n)?1:parseInt(n,10),{locationSearch:e.location.search,currentPage:n,search:a.get("search"),ordering:a.get("ordering"),is_active:a.get("is_active"),can_view:a.get("can_view"),is_superuser:a.get("is_superuser")}}return null}}]),t}(c.a.Component),lt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).fetchData=function(e){if(a.state.loaded)a.setState({loaded:!1});else if(a.state.dataSource.length>0)return;isNaN(e)&&(e=1);var t="/api/v1/account/group/list?page="+e;a.state.search&&(t="".concat(t,"&search=").concat(a.state.search)),a.state.ordering&&(t="".concat(t,"&ordering=").concat(a.state.ordering)),I.Get(t).then((function(t){var n=t.results;n instanceof Array?a.setState({dataSource:n,loaded:!0,dataCount:t.count,currentPage:e}):(a.setState({loaded:!0}),H.a.error(JSON.stringify(t),5))})).catch((function(e){console.log(e),a.setState({loaded:!0})}))},a.deleteOnConfirm=function(e){var t="/api/v1/account/group/"+e.id;I.Delete(t).then((function(t){if(204===t.status)H.a.success("\u5220\u9664:"+e.name+"\u6210\u529f",3),a.fetchData(a.state.currentPage);else try{return t.json()}catch(n){H.a.error("\u5220\u9664:"+e.name+"\u5931\u8d25",3)}})).catch((function(e){console.log(e)}))},a.deleteOnCancel=function(e){H.a.error("\u53d6\u6d88\u5220\u9664",3)},a.onSearchHandler=function(e){console.log(e),a.setState({search:e,currentPage:1},(function(){var t="/user/group/list?page=1";e&&(t="".concat(t,"&search=").concat(e)),a.state.ordering&&(t=t.indexOf("?")>0?"".concat(t,"&ordering=").concat(a.state.ordering):"".concat(t,"?ordering=").concat(a.state.ordering)),a.props.history.push(t)}))},a.handleTableChange=function(e,t,n){var c=e.current,r="/user/group/list?page=".concat(c);a.state.search&&(r="".concat(r,"&search=").concat(a.state.search)),n&&n.columnKey&&(r="ascend"===n.order?"".concat(r,"&ordering=").concat(n.columnKey):"".concat(r,"&ordering=-").concat(n.columnKey)),a.props.history.push(r)};var n=new De(a.props.location.search),c=n.get("page");return c=isNaN(c)?1:parseInt(c,10),a.state={loaded:!1,dataSource:[],search:n.get("search"),ordering:n.get("ordering"),locationSearch:a.props.location.search,currentPage:c},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){e.location.search!==this.state.locationSearch&&this.fetchData(this.state.currentPage)}},{key:"componentDidMount",value:function(){this.fetchData(this.state.currentPage)}},{key:"render",value:function(){var e=this,t=[{title:"ID",dataIndex:"id",key:"id",render:function(e,t){return c.a.createElement(o.b,{to:{pathname:"/user/group/"+t.id,state:{data:t}}},e)},sorter:function(e,t){return e.id-t.id}},{title:"\u5206\u7ec4\u540d",dataIndex:"name",key:"name"},{title:"\u7528\u6237",dataIndex:"user_set",key:"user_set",render:function(e){return e.join(", ")}},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){return c.a.createElement("span",null,c.a.createElement(o.b,{to:{pathname:"/user/group/"+t.id,state:{data:t}}},c.a.createElement(b,{type:"link"}," \u8be6\u60c5")),c.a.createElement("span",{className:"ant-divider"}),c.a.createElement(o.b,{to:{pathname:"/user/group/"+t.id+"/editor",state:{data:t}}},c.a.createElement(b,{type:"edit"}," \u7f16\u8f91")),c.a.createElement("span",{className:"ant-divider"}),c.a.createElement(Se.a,{title:"\u60a8\u786e\u8ba4\u5220\u9664:"+t.name+"?",onCancel:e.deleteOnCancel,onConfirm:function(){return e.deleteOnConfirm(t)}},c.a.createElement("span",null,c.a.createElement(b,{type:"trash-o",danger:!0}," \u5220\u9664"))))}}];return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u5206\u7ec4\u5217\u8868")),c.a.createElement(ae.a,{className:"tools"},c.a.createElement(ne.a,{span:12},c.a.createElement(ce.a.Search,{placeholder:"search group",style:{width:200},onSearch:this.onSearchHandler})),c.a.createElement(ne.a,{span:12,style:{textAlign:"right"}},c.a.createElement(z.a,{type:"default",icon:c.a.createElement(b,{type:"refresh",spin:!this.state.loaded}),onClick:this.fetchData},"\u5237\u65b0"),c.a.createElement(o.b,{to:"/user/group/add"},c.a.createElement(z.a,{type:"primary",icon:c.a.createElement(b,{type:"plus"})},"Add")))),c.a.createElement(ke.a,{columns:t,dataCount:this.state.dataCount,dataSource:this.state.dataSource,rowKey:"id",bordered:!0,pagination:{current:this.state.currentPage,total:this.state.dataCount},onChange:this.handleTableChange})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.location.search!==t.locationSearch){var a=new De(e.location.search),n=a.get("page");return n=isNaN(n)?1:parseInt(n,10),{locationSearch:e.location.search,currentPage:n,search:a.get("search"),ordering:a.get("ordering")}}return null}}]),t}(c.a.Component),ot=(a(879),a(219)),it=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).formRef=c.a.createRef(),a.handleSubmit=function(e){e.user_set=a.state.targetKeys,e.permissions=a.state.targetPermissionKeys,a.props.handleSubmit(e)},a.handleTransferSelectChange=function(e,t){a.setState({selectedKeys:[].concat(Object(Ee.a)(e),Object(Ee.a)(t))})},a.handlePermissionTransferSelectChange=function(e,t){a.setState({selectedPermissionKeys:[].concat(Object(Ee.a)(e),Object(Ee.a)(t))})},a.handleTransferChange=function(e,t,n){a.setState({targetKeys:e})},a.handlePermissionTransferChange=function(e,t,n){a.setState({targetPermissionKeys:e})};var n=a.props.data?a.props.data:{};return a.state={sourceData:[],data:n,transferDataSource:[],selectedKeys:[],targetKeys:n.user_set?n.user_set:[],transferPermisionDataSource:[],selectedPermissionKeys:[],targetPermissionKeys:n.permissions?n.permissions:[]},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.fetchAllUserData(),this.fetchAllPermissionData()}},{key:"componentDidUpdate",value:function(e,t,a){e.data!==this.state.data&&this.formRef.current.setFieldsValue(this.state.data)}},{key:"fetchAllUserData",value:function(){var e=this;I.Get("/api/v1/account/user/all").then((function(t){if(t instanceof Array){e.userall=t;var a=t.map((function(e){return{key:e.id,title:e.username}}));e.setState({transferDataSource:a})}})).catch((function(e){console.log(e)}))}},{key:"fetchAllPermissionData",value:function(){var e=this;I.Get("/api/v1/account/permission/all").then((function(t){if(t instanceof Array){e.permissions=t;var a=t.map((function(e){return{key:e.id,title:"".concat(e.codename,"\u3010").concat(e.app_model,"\u3011")}}));e.setState({transferPermissionDataSource:a})}})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e="editor"===this.props.type?"\u4fee\u6539":"\u6dfb\u52a0",t={labelCol:{xs:{span:24},sm:{span:0},md:{span:0}},wrapperCol:{xs:{span:24,offset:0},sm:{span:18,offset:3},md:{span:16,offset:4}}};return c.a.createElement(Re.a,{ref:this.formRef,onFinish:this.handleSubmit,initialValues:this.state.data},c.a.createElement(ae.a,null,c.a.createElement(ne.a,{xs:24,sm:24,md:24},c.a.createElement(Re.a.Item,Object.assign({},{labelCol:{xs:{span:24},sm:{span:5},md:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15},md:{span:14}}},{label:"\u5206\u7ec4\u540d",name:"name",rules:[{required:!0,message:"Please input group name!"}]}),c.a.createElement(ce.a,{placeholder:"name"})),c.a.createElement(Re.a.Item,Object.assign({},t,{name:"user_set",label:""}),c.a.createElement("div",null,c.a.createElement(ot.a,{listStyle:{maxWidth:300,width:"43%",minHeight:250,overflow:"auto"},dataSource:this.state.transferDataSource,targetKeys:this.state.targetKeys,selectedKeys:this.state.selectedKeys,onChange:this.handleTransferChange,onSelectChange:this.handleTransferSelectChange,titles:["\u6240\u6709\u7528\u6237","\u7ec4\u6210\u5458"],showSearch:!0,render:function(e){return e.title}}))),c.a.createElement(Re.a.Item,Object.assign({},t,{name:"permissions"}),c.a.createElement("div",null,c.a.createElement(ot.a,{listStyle:{maxWidth:300,width:"43%",minHeight:250,overflow:"auto"},dataSource:this.state.transferPermissionDataSource,targetKeys:this.state.targetPermissionKeys,selectedKeys:this.state.selectedPermissionKeys,onChange:this.handlePermissionTransferChange,onSelectChange:this.handlePermissionTransferSelectChange,titles:["\u6240\u6709\u6743\u9650","\u7ec4\u6743\u9650"],showSearch:!0,render:function(e){return e.title}}))),c.a.createElement(Re.a.Item,{wrapperCol:{offset:8,span:16}},c.a.createElement(z.a,{type:"primary",htmlType:"submit"},e)))),c.a.createElement(ae.a,{className:"center"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data!==t.data?{data:e.data,targetKeys:e.data&&e.data.user_set?e.data.user_set:[],targetPermissionKeys:e.data&&e.data.permissions?e.data.permissions:[]}:null}}]),t}(c.a.Component),st=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(c)))).handleAddSubmit=function(e){I.Post("/api/v1/account/group/create",{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:e}).then((function(e){e.id>0?a.props.history.push("/user/group/"+e.id):H.a.error(JSON.stringify(e),8)})).catch((function(e){console.log(e)}))},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6dfb\u52a0\u7528\u6237\u7ec4")),c.a.createElement("div",{className:"wrap"},c.a.createElement(it,{handleSubmit:this.handleAddSubmit}))))}}]),t}(c.a.Component),ut=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).fetchData=function(){var e="/api/v1/account/group/"+a.state.id+"/editor";I.Get(e).then((function(e){a.setState({data:e,loaded:!0})})).catch((function(e){console.log(e)}))},a.handleEditorSubmit=function(e){var t="/api/v1/account/group/"+a.state.id;I.Put(t,{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:e}).then((function(e){e.id>0?a.props.history.push("/user/group/"+e.id):H.a.error(JSON.stringify(e),8)})).catch((function(e){console.log(e)}))};var n=a.props.match.params.id;return a.state={id:n,data:{},loaded:!1},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u7f16\u8f91\u7528\u6237\u7ec4")),c.a.createElement("div",{className:"wrap"},c.a.createElement(it,{handleSubmit:this.handleEditorSubmit,data:this.state.data,type:"editor"}))))}}]),t}(c.a.Component),dt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).fetchDetailData=function(){var e="/api/v1/account/group/"+a.state.id;I.Get(e).then((function(e){a.setState({detail:e})})).catch((function(e){console.log(e)}))},a.state={id:a.props.match.params.id,detail:{}},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.props.location.state?this.setState({detail:this.props.location.state.data}):this.fetchDetailData()}},{key:"render",value:function(){return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement(ae.a,{gutter:16},c.a.createElement(ne.a,{xs:{span:24},sm:{span:16}},c.a.createElement(ae.a,{className:"title"},c.a.createElement("h4",null,"\u7528\u6237\u7ec4\u8be6\u60c5")),c.a.createElement("div",{className:"info-property"},c.a.createElement("dl",null,c.a.createElement("dt",null,"\u540d\u79f0"),c.a.createElement("dd",null,this.state.detail.name)),c.a.createElement("dl",null,c.a.createElement("dt",null,"\u6240\u6709\u7528\u6237"),c.a.createElement("dd",null,this.state.detail.user_set?this.state.detail.user_set.join(", "):null)))),c.a.createElement(ne.a,{xs:24,sm:8},c.a.createElement(qe,{app:"auth",model:"group",id:this.state.id})))))}}]),t}(c.a.Component),mt=(a(216),a(91)),pt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).fetchData=function(e){if(a.state.loaded)a.setState({loaded:!1});else if(a.state.dataSource.length>0)return;var t;isNaN(e)&&(e=1),e&&(t=a.state.search?"/api/v1/account/message/list?type=".concat(a.state.type,"&page=").concat(e,"&search=").concat(a.state.search):"/api/v1/account/message/list?type=".concat(a.state.type,"&page=").concat(e)),I.Get(t).then((function(t){var n=t.results;n instanceof Array?a.setState({dataSource:n,loaded:!0,dataCount:t.count,currentPage:e},(function(){"unread"===this.state.type&&this.props.updateUnReadCount(t.count)})):(a.setState({loaded:!0}),H.a.error(JSON.stringify(t),5))})).catch((function(e){console.log(e),a.setState({loaded:!0})}))},a.deleteOnConfirm=function(e){var t="/api/v1/account/message/"+e.id;I.Delete(t).then((function(t){204===t.status?(H.a.success("\u5220\u9664\u6d88\u606f(ID:"+e.id+")\u6210\u529f",3),a.fetchData(a.state.currentPage)):H.a.error("\u5220\u9664\u6d88\u606f(ID:"+e.id+")\u5931\u8d25",3)})).catch((function(e){console.log(e)}))},a.deleteOnCancel=function(e){H.a.error("\u53d6\u6d88\u5220\u9664",3)},a.onSearchHandler=function(e){var t="/user/message/".concat(a.state.type,"?page=1");e&&(t="".concat(t,"&search=").concat(e));["unread","ordering"].forEach((function(e){var n=a.state[e];n&&(t="".concat(t,"&").concat(e,"=").concat(n))})),a.props.history.push(t)},a.handleTableChange=function(e,t,n){var c=e.current,r="/user/message/".concat(a.state.type,"?page=").concat(c);a.state.search&&(r="".concat(r,"&search=").concat(a.state.search)),n&&n.columnKey&&(r="ascend"===n.order?"".concat(r,"&ordering=").concat(n.columnKey):"".concat(r,"&ordering=-").concat(n.columnKey)),a.props.history.push(r)};var n=a.props.match.params.type,c=new De(a.props.location.search),r=c.get("page");return r=isNaN(r)?1:parseInt(r,10),a.state={loaded:!1,dataSource:[],type:n,dataCount:0,currentPage:r,search:c.get("search"),ordering:c.get("ordering"),locationSearch:a.props.location.search,match:a.props.match},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.fetchData(this.state.currentPage)}},{key:"componentDidUpdate",value:function(e,t,a){e.match.params.type===this.state.type&&e.location.search===this.state.locationSearch||this.fetchData(this.state.currentPage)}},{key:"render",value:function(){var e=this,t=[{title:"\u6807\u9898",dataIndex:"title",key:"title",render:function(e,t){return c.a.createElement(o.b,{to:{pathname:"/user/message/"+t.id,state:{data:t}},style:{textAlign:"left"}},t.unread?c.a.createElement(mt.a,{status:"default",color:"cyan"}):c.a.createElement(mt.a,{status:"default",style:{visibility:"hidden"}}),e)}},{title:"\u65f6\u95f4",dataIndex:"time_added",key:"time_added",sorter:function(e,t){return Date.parse(new Date(e.time_added))-Date.parse(new Date(t.time_added))}},{title:"\u6d88\u606f\u5206\u7c7b",dataIndex:"scope",key:"scope"},{title:"\u5df2\u8bfb",dataIndex:"unread",key:"unread",render:function(e){return e?c.a.createElement("span",{className:"status"},c.a.createElement(b,{type:"close"})):c.a.createElement("div",{className:"status"},c.a.createElement(b,{type:"check"}))}},{title:"Action",key:"action",render:function(t,a){return c.a.createElement("span",null,c.a.createElement(o.b,{to:{pathname:"/user/message/"+t.id,state:{data:t}}},c.a.createElement(b,{type:"link"}," \u8be6\u60c5")),c.a.createElement("span",{className:"ant-divider"}),c.a.createElement(Se.a,{title:"\u60a8\u786e\u8ba4\u5220\u9664:"+t.id+"?",onCancel:e.deleteOnCancel,onConfirm:function(){return e.deleteOnConfirm(t)}},c.a.createElement("span",null,c.a.createElement(b,{type:"trash-o",danger:!0}," \u5220\u9664"))))}}];return c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u6d88\u606f\u5217\u8868")),c.a.createElement(ae.a,{className:"tools"},c.a.createElement(ne.a,{span:12},c.a.createElement(ce.a.Search,{placeholder:"search message",style:{width:200},onSearch:this.onSearchHandler})),c.a.createElement(ne.a,{span:12,style:{textAlign:"right"}},c.a.createElement(z.a,{type:"default",icon:c.a.createElement(b,{type:"refresh"}),loading:!this.state.loaded,onClick:this.fetchData},"\u5237\u65b0"))),c.a.createElement("div",{className:"main-list"},c.a.createElement(ke.a,{columns:t,dataSource:this.state.dataSource,rowKey:"id",bordered:!0,pagination:{current:this.state.currentPage,total:this.state.dataCount},onChange:this.handleTableChange}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.match!==t.match||e.location.search!==t.locationSearch){var a=e.match.params.type,n=new De(e.location.search),c=n.get("page");return{type:a,currentPage:c=isNaN(c)?1:parseInt(c,10),search:n.get("search"),ordering:n.get("ordering"),locationSearch:e.location.search}}return null}}]),t}(c.a.Component),ft=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).fetchDetailData=function(){var e="/api/v1/account/message/"+a.state.id;I.Get(e).then((function(e){a.setState({detail:e})})).catch((function(e){console.log(e)}))},a.state={id:a.props.match.params.id,detail:{}},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.fetchDetailData()}},{key:"render",value:function(){var e;return this.state.detail.link&&(e=c.a.createElement(o.b,{to:this.state.detail.link},this.state.detail.link)),c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"message"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"title"},c.a.createElement("h2",null,this.state.detail.title)),c.a.createElement("div",{className:"meta"},c.a.createElement("span",null,"\u6d88\u606f\u7c7b\u578b: ",this.state.detail.scope),c.a.createElement("span",null,"\u53d1\u9001\u8005: ",this.state.detail.sender),c.a.createElement("span",null,"\u65f6\u95f4: ",this.state.detail.time_added))),c.a.createElement("div",{className:"body"},this.state.detail.content,c.a.createElement("br",null),e))))}}]),t}(c.a.Component),ht=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).updateUnReadCount=function(e){"-1"===e?a.setState((function(e){return{unreadCount:e.unreadCount-1}})):a.state.unreadCount!==e&&a.setState({unreadCount:e})},a.state={unreadCount:0},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement(ae.a,{style:{display:"flex",minHeight:"100%",overflow:"auto"}},c.a.createElement(ne.a,{span:4,className:"right-nav"},c.a.createElement("div",{className:"nav-title"},c.a.createElement("h3",null,"\u6d88\u606f\u4e2d\u5fc3")),c.a.createElement("ul",{className:"right-nav-ul"},c.a.createElement("li",null,c.a.createElement(o.c,{activeClassName:"active",to:"/user/message/all"},"\u5168\u90e8\u6d88\u606f")),c.a.createElement("li",null,c.a.createElement(o.c,{activeClassName:"active",to:"/user/message/unread"},c.a.createElement(mt.a,{count:this.state.unreadCount,offset:[15,-5]},c.a.createElement("span",null,"\u672a\u8bfb\u6d88\u606f")))),c.a.createElement("li",null,c.a.createElement(o.c,{activeClassName:"active",to:"/user/message/read"},"\u5df2\u8bfb\u6d88\u606f")))),c.a.createElement(ne.a,{style:{listStyle:"inline-block",flex:1}},c.a.createElement(i.d,null,c.a.createElement(i.b,{exat:!0,path:"/user/message/:type(all|unread|read)",render:function(t){return c.a.createElement(pt,Object.assign({},t,{updateUnReadCount:e.updateUnReadCount}))}}),c.a.createElement(i.b,{exat:!0,path:"/user/message/:id(\\d+)",component:ft}),c.a.createElement(i.b,{exat:!0,path:"/user/message",render:function(){return c.a.createElement(i.a,{to:"/user/message/all",push:!1})}}))))}}]),t}(c.a.Component),gt=(a(882),a(329)),Et=function(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),r=a[0],l=a[1],i=Object(n.useState)(!1),s=Object(m.a)(i,2),u=s[0],d=s[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),h=f[0],g=f[1],E=Object(n.useCallback)((function(){if(!u){d(!0);I.Get("/api/v1/docs/category/list").then((function(e){var t=e.results;t instanceof Array&&(l(t),g(!0))})).catch((function(e){console.log(e),d(!1)}))}}),[]);Object(n.useEffect)((function(){0!==r.length||h||E()}),[r.length,E,h]);var v=Object(n.useMemo)((function(){return r.map((function(e,t){return c.a.createElement(ne.a,{xs:{span:24},sm:{span:12},md:{span:12},lg:{span:8},className:"info-item",key:t},c.a.createElement(gt.a,{title:e.name,bordered:!0},c.a.createElement("div",{className:"info"},c.a.createElement("div",{className:"row"},c.a.createElement("span",{className:"config"},"\u540d\u79f0:"),c.a.createElement("span",{className:"value"},c.a.createElement(o.b,{to:"/docs/category/".concat(e.id)},e.name))),c.a.createElement("div",{className:"row"},c.a.createElement("span",{className:"config"},"\u4ee3\u7801:"),c.a.createElement("span",{className:"value"},e.code))),c.a.createElement("div",{className:"buttons"},c.a.createElement("div",{className:"button"},c.a.createElement(o.b,{to:"/docs/category/".concat(e.id)},"\u67e5\u770b\u8be6\u60c5")),c.a.createElement("div",{className:"button"},c.a.createElement(o.b,{to:"/docs/category/".concat(e.id,"/articles")},"\u67e5\u770b\u6587\u7ae0")))))}))}),[r]);return h?0===r.length?c.a.createElement("div",{className:"no-content border"},"\u60a8\u8fd8\u6ca1\u6709\u4efb\u4f55\u5de5\u4f5c\u533a\u4fe1\u606f"):c.a.createElement("div",{className:"usercenter"},c.a.createElement(ae.a,{gutter:8},v)):c.a.createElement("div",{className:"no-content border"},"\u6570\u636e\u52a0\u8f7d\u4e2d....")},vt=(a(884),a(330)),bt=function(e){var t=Object(n.useState)({}),a=Object(m.a)(t,2),r=a[0],l=a[1];Object(n.useEffect)((function(){e.data===r||r.id||l(e.data)}),[r,e.data]);var o,i=Object(n.useCallback)((function(e){e&&I.Get("/api/v1/account/message/"+e).then((function(e){})).catch((function(e){console.log(e)}))}),[]),s=Object(n.useCallback)((function(){var e,t=r;return t.link&&(e=c.a.createElement("a",{href:t.link},"\u67e5\u770b\u8be6\u60c5")),c.a.createElement("div",{className:"message"},c.a.createElement("div",{className:"meta"},c.a.createElement("span",{className:"meta-item"},"\u6d88\u606f\u7c7b\u578b:",t.scope),c.a.createElement("span",{className:"meta-item"},"\u53d1\u9001\u65f6\u95f4:",t.time_added)),c.a.createElement("div",{className:"content"},t.content,e))}),[r]),u=Object(n.useCallback)((function(){r.unread&&(i(r.id),l((function(e){return e.unread=!1,e})));var e={message:r.title,description:s(),duration:4,top:45};vt.a.open(e)}),[r.id,r.title,r.unread,i,s]);return o=r.unread?c.a.createElement(mt.a,{status:"default",color:"cyan"}):c.a.createElement(mt.a,{status:"default",color:"#dfdfdf"}),c.a.createElement("div",{className:"item",onClick:u},o,r.title)},yt=function(e){var t,a,r=Object(n.useState)(!1),l=Object(m.a)(r,2),i=l[0],s=l[1],d=Object(n.useState)([]),p=Object(m.a)(d,2),f=p[0],h=p[1],g=Object(n.useContext)(u).history,E=Object(n.useCallback)((function(){I.Get("/api/v1/account/message/list").then((function(e){var t=e.results;if(t instanceof Array){var a=!!e.next;s(a),h(t)}}))}),[]);Object(n.useEffect)((function(){0===f.length&&E()}),[E,f.length]),t=f.map((function(e,t){return c.a.createElement(bt,{data:e,key:t,history:g})}));var v=Object(n.useMemo)((function(){return i?c.a.createElement("div",{className:"more"},c.a.createElement(o.b,{className:"",to:"/user/message/all"},"\u67e5\u770b\u66f4\u591a")):null}),[i]);return a=t.length>0?c.a.createElement("div",{className:"inner"},c.a.createElement("ul",{className:"list"},t),v):c.a.createElement("div",{className:"no-content"},"\u6682\u65e0\u6d88\u606f"),c.a.createElement("div",{className:"panel"},c.a.createElement("div",{className:"header"},"\u6d88\u606f\u5217\u8868"),a)},Ot=function(e){var t=Object(n.useContext)(u).setNavData;return Object(n.useEffect)((function(){t([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237\u4e2d\u5fc3"}])}),[t]),c.a.createElement(ae.a,{className:"content"},c.a.createElement(ne.a,{xs:{span:24},sm:{span:24},md:{span:16},lg:{span:18},className:"main"},c.a.createElement("div",{className:"title"},c.a.createElement("h4",null,"\u5de5\u4f5c\u533a\u5217\u8868")),c.a.createElement("div",null,c.a.createElement(Et,e))),c.a.createElement(ne.a,{xs:{span:24},sm:{span:24},md:{span:16},lg:{span:6},className:"sidebar"},c.a.createElement(yt,null)))};var jt=function(e){var t=Object(n.useContext)(u).setNavData;return Object(n.useEffect)((function(){t([{title:"\u9996\u9875",icon:"home",link:"/"},{title:"\u7528\u6237",link:"/user"}])}),[t]),c.a.createElement(i.d,null,c.a.createElement(i.b,{exat:!0,path:"/user/list",component:rt}),c.a.createElement(i.b,{exat:!0,path:"/user/logout",component:at}),c.a.createElement(i.b,{exat:!0,path:"/user/group/list",component:lt}),c.a.createElement(i.b,{exat:!0,path:"/user/group/add",component:st}),c.a.createElement(i.b,{exat:!0,path:"/user/group/:id/editor",component:ut}),c.a.createElement(i.b,{exat:!0,path:"/user/group/:id",component:dt}),c.a.createElement(i.b,{exat:!0,path:"/user/group",render:function(){return c.a.createElement(i.a,{to:"/user/group/list",push:!1})}}),c.a.createElement(i.b,{exat:!0,path:"/user/message",component:ht}),c.a.createElement(i.b,{exat:!0,path:"/user",component:Ot}),c.a.createElement(i.b,{exat:!0,path:"/user",render:function(){return c.a.createElement(i.a,{to:"/user/list",push:!1})}}))},kt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).onIconSpinClick=function(){a.state.spin?a.setState({spin:!1}):a.setState({spin:!0})},a.state={iconType:"refresh fa-5x",spin:!1},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{style:{margin:"100px",marginTop:"15%",border:"1px solid #999",padding:10,textAlign:"center",borderRadius:5}},c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"logo",style:{width:250,backgroundColor:"#4A90E2",padding:10}},c.a.createElement("img",{src:"https://www.codelieche.com/static/images/logo.svg",className:"App-logo",alt:"logo"})),c.a.createElement("span",{style:{padding:20,backgroundColor:"#f9f9f9",display:"block"}},"Hello React.js",c.a.createElement("br",null),c.a.createElement(z.a,{onClick:I.testFetch},"\u6309\u94ae"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("i",{className:"fa fa-camera-retro fa-5x"}),c.a.createElement("br",null),c.a.createElement(z.a,{onClick:this.onIconSpinClick},"Loding"),c.a.createElement(b,{type:this.state.iconType,spin:this.state.spin}))))}}]),t}(c.a.Component);var St=function(e){var t=c.a.useState(140),a=Object(m.a)(t,2),n=a[0],r=a[1];return c.a.createElement(p.Resizable,{className:"box",axis:"x",height:0,width:n,onResize:function(e,t){t.element;var a=t.size;console.log(a),r(a.width)}},c.a.createElement("div",{style:{width:n+"px",borderRight:"1px solid #eee"}},c.a.createElement("span",{className:"text"},"Raw use of <Resizable> element. 200x200, no constraints.")))};c.a.Component;var Ct=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)([]),o=Object(m.a)(l,2),i=o[0],s=o[1];return c.a.createElement("div",null,"This Is Test Page Function",c.a.createElement("br",null),c.a.createElement("p",null,"Resize"),c.a.createElement(St,null),c.a.createElement("p",null,"\u4e0a\u4f20\u56fe\u7247"),c.a.createElement("div",{style:{padding:10,margin:10,minHeight:150,border:"1px solid #f5f5f5"}},c.a.createElement(oe,{url:"",fileListData:i,setFileListData:s,tooltip:c.a.createElement("div",{style:{color:"#999",fontSize:12}},"\u8bf7\u9009\u62e9\u8981\u4e0a\u4f20\u7684\u56fe\u7247")})),c.a.createElement(ie,null),c.a.createElement("hr",null),c.a.createElement(z.a,{onClick:function(){r((function(e){return!e}))}},"\u4e0a\u4f20\u56fe\u7247"),c.a.createElement(se,{visible:a,handleAfterClose:function(){return r(!1)},afterUploadHandle:function(e){console.log("\u4e0a\u4f20\u4e86\u56fe\u7247\uff1a",e),r(!1)}}))},Nt=function(e){return c.a.createElement(me,{content:"> good"})},wt=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return c.a.createElement(i.d,null,c.a.createElement(i.b,{exat:!0,path:"/test/test",component:Ct}),c.a.createElement(i.b,{exat:!0,path:"/test/page",component:kt}),c.a.createElement(i.b,{exat:!0,path:"/test/editor",component:Nt}))}}]),t}(c.a.Component);var xt=function(e){var t=Object(n.useState)("align-justify"),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useContext)(u).navData,s=Object(n.useCallback)((function(t){t.preventDefault(),e.setShowLeftSider((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[e]);return c.a.createElement("div",{className:"right-content"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"toogle",onClick:s,onMouseEnter:function(e){l("angle-double-right")},onMouseLeave:function(e){l("align-justify")},style:{display:e.showLeftSider?"none":"inline-block"}},c.a.createElement(b,{type:r})),c.a.createElement(R,{data:o}),c.a.createElement("div",{className:"user"},c.a.createElement(L,null))),c.a.createElement("div",{className:"container"},c.a.createElement(i.d,null,c.a.createElement(i.b,Object.assign({path:"/docs/article/:id",component:je},e)),c.a.createElement(i.b,{path:"/docs/",component:tt,location:e.location}),c.a.createElement(i.b,{path:"/user",component:jt,location:e.location}),c.a.createElement(i.b,{path:"/test",component:wt,location:e.location}))),c.a.createElement(K,null))};var Dt=function(e){var t,a=Object(n.useState)(!1),r=Object(m.a)(a,2),l=r[0],o=r[1],i=Object(n.useState)(0),s=Object(m.a)(i,2),p=s[0],f=s[1],h=Object(n.useState)([{title:"\u9996\u9875",icon:"home",link:"/"}]),g=Object(m.a)(h,2),E=g[0],v=g[1];return Object(n.useEffect)((function(){var t=localStorage.getItem("showLeftSider");null!==t?(t!==l.toString()&&o("true"===t),"/"===e.location.pathname&&(document.title="\u770b\u677f-\u9996\u9875",E.length>1&&v([{title:"\u9996\u9875",icon:"home",link:"/"}]))):o(!0)}),[E.length,e.location.pathname,l]),l&&(t=c.a.createElement(M,{showLeftSider:l,setShowLeftSider:o,refreshNavTimes:p,defaultOpenKey:e.defaultOpenKey})),c.a.createElement(u.Provider,{value:{navData:E,setNavData:v,history:e.history,refreshNavTimes:p,setRefreshNavTimes:f}},c.a.createElement(d.a,{className:"left-right-layout"},t,c.a.createElement(d.a,null,c.a.createElement(d.a.Content,null,c.a.createElement(xt,Object.assign({},e,{showLeftSider:l,setShowLeftSider:o}))))))},It=function e(t){var a=t.item,r=t.index,l=t.activeNavIDs,i=Object(n.useState)(!1),s=Object(m.a)(i,2),d=s[0],p=s[1],f=Object(n.useState)(!1),h=Object(m.a)(f,2),g=h[0],E=h[1],v=Object(n.useContext)(u),y=v.history,O=v.setRefreshNavTimes,j=a.children.map((function(t,a){return c.a.createElement(e,{item:t,index:a,key:a,activeNavIDs:l})})),k=Object(n.useCallback)((function(e){p((function(e){return!e}))}),[]);Object(n.useEffect)((function(){var e=l.indexOf(a.id)>=0;e!==g&&E(e)}),[l,g,a.id]);var S=Object(n.useCallback)((function(e){e.stopPropagation(),e.preventDefault();var t={parent:a.id,category:a.category};I.Post("/api/v1/docs/article/create",{},{data:t}).then((function(e){if(e.id>0){O((function(e){return e+1}));var t="/docs/article/".concat(e.id);y.push(t)}else console.log("\u521b\u5efa\u6587\u7ae0\u5931\u8d25")})).catch((function(e){console.log(e)}))}),[y,a,O]);return c.a.createElement("div",{key:r,className:"nav"},c.a.createElement("div",{className:"item"},c.a.createElement(o.c,{to:"/docs/article/".concat(a.id),activeClassName:"active"},c.a.createElement("div",{className:"title",style:{paddingLeft:12*a.level},onClick:k},j.length>0&&c.a.createElement(b,{type:d||g?"caret-down":"caret-right"}),a.title?a.title:c.a.createElement("span",{className:"no-title"},"\u65e0\u6807\u9898"),c.a.createElement("div",{className:"add",onClick:S},c.a.createElement(b,{type:"plus-square-o"})))),j.length>0&&c.a.createElement("div",{className:d||g?"children active":"children"},j)))},Pt=function(e){var t=e.category,a=Object(n.useState)(null),r=Object(m.a)(a,2),l=r[0],o=r[1],i=Object(n.useContext)(u),s=i.navData,d=i.refreshNavTimes,p=Object(n.useState)([]),f=Object(m.a)(p,2),h=f[0],g=f[1],E=Object(n.useState)(0),v=Object(m.a)(E,2),b=v[0],y=v[1],O=Object(n.useCallback)((function(e,t){if(o(e),t&&y((function(e){return e++})),e){var a="/api/v1/docs/article/all?category=".concat(e);I.Get(a,{},{}).then((function(e){Array.isArray(e)?g(e):H.a.warn("\u83b7\u53d6\u6587\u7ae0\u5217\u8868\u6570\u636e\u51fa\u9519:"+JSON.stringify(e))})).catch((function(e){console.log(e)}))}}),[]),j=Object(n.useMemo)((function(){var e=[];return s.forEach((function(t){t.id&&t.id>0&&e.push(t.id)})),e}),[s]);Object(n.useEffect)((function(){t!==l?O(t):b<=d&&O(t,!0)}),[l,t,O,b,d]);var k;return k=h.map((function(e,t){return c.a.createElement(It,{item:e,index:t,key:t,activeNavIDs:j})})),c.a.createElement("div",{className:"articles"},k)};var _t=function(e){var t=e.showLeftSider,a=e.setShowLeftSider,r=Object(n.useState)([]),l=Object(m.a)(r,2),i=l[0],s=l[1],f=Object(n.useState)({}),h=Object(m.a)(f,2),g=h[0],E=h[1],v=Object(n.useContext)(u),y=v.setRefreshNavTimes,O=v.history,j=v.currentArticleCategoryID,k=v.setCurrentArticleCategoryID,S=Object(n.useMemo)((function(){var e=localStorage.getItem("leftSiderWidth"),t=parseInt(e);return t&&t>=156&&t<=460?t:200}),[]),C=Object(n.useState)(S),N=Object(m.a)(C,2),w=N[0],x=N[1],D=Object(n.useCallback)((function(){I.Get("/api/v1/docs/category/all").then((function(e){Array.isArray(e)?s(e):H.a.warn("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u6570\u636e\u51fa\u9519",3)})).catch((function(e){console.log(e)}))}),[s]);Object(n.useEffect)((function(){return 0===i.length&&D(),function(){localStorage.setItem("leftSiderWidth",w)}}),[i.length,D,w]),Object(n.useEffect)((function(){if(j&&j>0){if(!g.id||g.id!==j)for(var e=0;e<i.length;e++)if(i[e].id===j){k(i[e].id),E(i[e]);break}}else i.length>0&&E(i[0])}),[i,j,g.id,k]);var P=Object(n.useCallback)((function(e,t){t.element;var a=t.size;a.width<156?x(156):a.width<=460?x(a.width):x(460)}),[x]),_=Object(n.useMemo)((function(){var e=i.map((function(e,t){return c.a.createElement(U.a.Item,{key:t,onClick:function(t){document.title="\u770b\u677f-\u5206\u7c7b-".concat(e.name),k(e.id)}},e.name)}));return c.a.createElement(U.a,{className:"categories-list"},e)}),[i,k]),M=Object(n.useCallback)((function(e){e.preventDefault(),a((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[a]),A=Object(n.useMemo)((function(){return t?c.a.createElement(Pt,{category:g.id}):null}),[g.id,t]),R=Object(n.useCallback)((function(e){if(console.log(e),e.stopPropagation(),g.id<0)H.a.warn("\u8fd8\u672a\u9009\u62e9\u5206\u7c7b\uff0c\u4e0d\u53ef\u521b\u5efa\u6587\u7ae0",3);else{I.Post("/api/v1/docs/article/create",{},{data:{category:g.id}}).then((function(e){e.id>0?(H.a.success("\u6dfb\u52a0\u6587\u7ae0\u6210\u529f"),y((function(e){return e+1})),O.push("/docs/article/".concat(e.id))):H.a.warn(JSON.stringify(e))})).catch((function(e){console.log(e)}))}}),[g.id,O,y]);return c.a.createElement(p.Resizable,{className:"box",axis:"x",height:0,width:w,onResize:P},c.a.createElement(d.a.Sider,{style:{height:"100vh"},width:w},c.a.createElement("div",{className:"left-sider"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"logo"},c.a.createElement(o.b,{to:"/"},c.a.createElement("img",{alt:"logo",src:"https://www.codelieche.com/static/images/logo-kanban.svg"})),c.a.createElement("div",{className:"toogle",onClick:M},c.a.createElement(b,{type:"angle-double-left",noMarginRight:!0})),c.a.createElement("div",{className:"clear"})),c.a.createElement("div",{className:"clear"}),c.a.createElement("div",{className:"namespace"},c.a.createElement(F.a,{overlay:_,trigger:["click"]},c.a.createElement("div",null,c.a.createElement("span",{style:{color:"red"}},c.a.createElement(b,{type:"flag"})),c.a.createElement("div",{className:"current"},g.name),c.a.createElement(b,{type:"arrows-v"}))))),c.a.createElement("div",{className:"content"},t&&A),c.a.createElement("div",{className:"footer",onClick:R},c.a.createElement("div",{className:"add"},c.a.createElement(b,{type:"plus"}),"\u65b0\u7684\u6587\u7ae0")))))};var Mt=function(e){var t=Object(n.useState)("align-justify"),a=Object(m.a)(t,2),r=a[0],l=a[1],o=Object(n.useContext)(u).navData,s=Object(n.useCallback)((function(t){t.preventDefault(),e.setShowLeftSider((function(e){return localStorage.setItem("showLeftSider",!e),!e}))}),[e]);return c.a.createElement("div",{className:"right-content"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"toogle",onClick:s,onMouseEnter:function(e){l("angle-double-right")},onMouseLeave:function(e){l("align-justify")},style:{display:e.showLeftSider?"none":"inline-block"}},c.a.createElement(b,{type:r})),c.a.createElement(R,{data:o}),c.a.createElement("div",{className:"user"},c.a.createElement(L,null))),c.a.createElement("div",{className:"container"},c.a.createElement(i.d,null,c.a.createElement(i.b,Object.assign({path:"/",exact:!0,component:Ot},e)),c.a.createElement(i.b,Object.assign({path:"/docs/article/:id",component:je},e)))),c.a.createElement(K,null))};var At=function(e){var t,a=Object(n.useState)(!1),r=Object(m.a)(a,2),l=r[0],o=r[1],i=Object(n.useState)(null),s=Object(m.a)(i,2),p=s[0],f=s[1],h=Object(n.useState)(0),g=Object(m.a)(h,2),E=g[0],v=g[1],b=Object(n.useState)([{title:"\u9996\u9875",icon:"home",link:"/"}]),y=Object(m.a)(b,2),O=y[0],j=y[1];return Object(n.useEffect)((function(){var t=localStorage.getItem("showLeftSider");null!==t?(t!==l.toString()&&o("true"===t),"/"===e.location.pathname&&(document.title="\u770b\u677f-\u9996\u9875",O.length>1&&j([{title:"\u9996\u9875",icon:"home",link:"/"}]))):o(!0)}),[O.length,e.location.pathname,l]),l&&(t=c.a.createElement(_t,{showLeftSider:l,setShowLeftSider:o,refreshNavTimes:E})),c.a.createElement(u.Provider,{value:{navData:O,setNavData:j,history:e.history,refreshNavTimes:E,setRefreshNavTimes:v,currentArticleCategoryID:p,setCurrentArticleCategoryID:f}},c.a.createElement(d.a,{className:"left-right-layout"},t,c.a.createElement(d.a,null,c.a.createElement(d.a.Content,null,c.a.createElement(Mt,Object.assign({},e,{showLeftSider:l,setShowLeftSider:o}))))))},Rt=Re.a.Item,Ft=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(E.a)(t).call(this,e))).formRef=c.a.createRef(),a.handleSubmit=function(e){I.Post("/api/v1/account/login",{},{headers:{"Content-Type":"application/json",Accept:"application/json"},data:e}).then((function(e){if("success"===e.status||!0===e.status){var t=new De(a.props.location.search).get("next","/");if((!t||"string"===typeof t&&t.indexOf("/user/login")>=0)&&(t="/"),"string"===typeof t&&t.startsWith("http"))window.location.href=t;else{var n=window.location.origin;"string"===typeof t&&(n=window.location.origin+t),window.location.href=n}}else H.a.error("\u767b\u9646\u5931\u8d25:"+e.message,5)})).catch((function(e){console.log(e)}))},a.state={},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){try{localStorage.reFreshPathname=null}catch(e){}}},{key:"render",value:function(){return c.a.createElement(d.a,{className:"container"},c.a.createElement(ae.a,{className:"login"},c.a.createElement(ne.a,{xs:{span:20,offset:2},lg:{span:6,offset:9}},c.a.createElement("div",{className:"logo"},c.a.createElement("img",{src:"https://www.codelieche.com/static/images/logo-kanban.svg",alt:"Logo"})),c.a.createElement(Re.a,{ref:this.formRef,onFinish:this.handleSubmit,name:"baseForm",className:"login-form"},c.a.createElement(Rt,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},c.a.createElement(ce.a,{prefix:c.a.createElement(b,{type:"user"}),placeholder:"username"})),c.a.createElement(Rt,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]},c.a.createElement(ce.a,{prefix:c.a.createElement(b,{type:"lock"}),size:"large",type:"password",placeholder:"password"})),c.a.createElement(Rt,null,c.a.createElement(z.a,{type:"primary",htmlType:"submit",className:"login-form-button",style:{width:"100%"}},"\u767b\u5f55")),c.a.createElement(Rt,null,c.a.createElement(ae.a,null,c.a.createElement(ne.a,{span:12,className:"login-form-change"},c.a.createElement(o.b,{to:""},"\u4fee\u6539\u5bc6\u7801")),c.a.createElement(ne.a,{span:12,className:"login-form-forget"},c.a.createElement(o.b,{to:""},"\u5fd8\u8bb0\u5bc6\u7801"))))))))}}]),t}(n.Component);var Ut=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),r=a[0],l=a[1];return Object(n.useEffect)((function(){var t,a=e.history.location.pathname;try{t=window.localStorage.reFreshPathname,window.localStorage.reFreshPathname=a}catch(n){t=a}a!==t?window.location.reload():l(!0)}),[e,r]),c.a.createElement("div",null,r?c.a.createElement(T.a,{status:"404",title:"404",subTitle:"Sorry, \u60a8\u8981\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728.",extra:c.a.createElement(o.b,{to:"/"},c.a.createElement(z.a,{type:"primary"},"\u8fd4\u56de\u9996\u9875"))}):null)};var Lt=function(e){return c.a.createElement(s.Provider,null,c.a.createElement(o.a,null,c.a.createElement(i.d,null,c.a.createElement(i.b,{exact:!0,path:"/user/login",component:Ft}),c.a.createElement(i.b,{exact:!0,path:"/",component:At}),c.a.createElement(i.b,{path:"/docs/article",render:function(e){return c.a.createElement(At,Object.assign({defaultOpenKey:"/docs"},e))}}),c.a.createElement(i.b,{path:"/docs",render:function(e){return c.a.createElement(Dt,Object.assign({defaultOpenKey:"/docs"},e))}}),c.a.createElement(i.b,{path:"/user",render:function(e){return c.a.createElement(Dt,Object.assign({defaultOpenKey:"/user"},e))}}),c.a.createElement(i.b,{path:"/test",render:function(e){return c.a.createElement(Dt,Object.assign({defaultOpenKey:"/test"},e))}}),c.a.createElement(i.b,{component:Ut}))))};a(886),a(887);l.a.render(c.a.createElement(Lt,null),document.getElementById("root"))}},[[332,1,2]]]);
//# sourceMappingURL=main.1dbc529e.chunk.js.map